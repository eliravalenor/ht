        /* 🔥【关键修复】基础页面样式 - 确保手机显示正确 */
        html {
            height: 100%;
            overflow: hidden;
        }
        body {
            height: 100%;
            overflow: hidden;
            margin: 0;
            padding: 4px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            font-weight: normal;
            background-color: #dcdcdc;
            display: flex;
            justify-content: center;
            align-items: center;
            box-sizing: border-box;
        }

        /* --- 手机功能生成失败重试按钮样式 --- */

        /* 🔥【简化】手机功能生成失败时的重新生成按钮 */
        .phone-regenerate-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 80px 20px 60px 20px;
            text-align: center;
            min-height: 200px;
            grid-column: 1 / -1; /* 在网格布局中占满整行 */
        }

        .phone-regenerate-button {
            background: #6BA3D6;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 14px 28px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(107, 163, 214, 0.3);
        }

        .phone-regenerate-button:hover {
            background: #5B93C6;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(107, 163, 214, 0.4);
        }

        .phone-regenerate-text {
            color: #999;
            font-size: 15px;
            margin-bottom: 24px;
        }

        /* --- 短信管理功能样式 --- */

        /* 🔥【修复】短信管理按钮样式 - 和创建对话按钮一样 */
        .sms-manage-btn {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-right: 1px; 
        }

        .sms-manage-btn:hover {
            transform: scale(1.1);
        }

        .sms-manage-btn i {
            color: #000;
            font-size: 18px;
        }

        /* 🔥【新增】短信列表多选模式按钮样式 */
        .messages-multiselect-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .messages-multiselect-actions .multiselect-btn {
            padding: 6px 12px;
            border-radius: 16px;
            border: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .messages-multiselect-actions .cancel-btn {
            background: rgba(142, 142, 147, 0.12);
            color: #007AFF;
        }

        .messages-multiselect-actions .cancel-btn:hover {
            background: rgba(142, 142, 147, 0.2);
        }

        .messages-multiselect-actions .delete-btn {
            background: rgba(255, 59, 48, 0.12);
            color: #FF3B30;
        }

        .messages-multiselect-actions .delete-btn:hover {
            background: rgba(255, 59, 48, 0.2);
        }

        /* 🔥【新增】短信对话项选中状态样式 */
        .sms-message-item.selected {
            background: rgba(0, 122, 255, 0.1);
            border-left: 3px solid #007AFF;
            position: relative;
        }

        .sms-message-item.selected::before {
            content: '✓';
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            background: #007AFF;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            z-index: 10;
        }

        .sms-message-item.selected .sms-message-avatar {
            margin-left: 30px;
        }

        /* 🔥【新增】短信管理选项模态框样式 */
        .sms-manage-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .sms-manage-modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            max-width: 300px;
            width: 80%;
            padding: 20px;
        }

        .sms-manage-option {
            display: flex;
            align-items: center;
            padding: 15px 10px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 8px;
        }

        .sms-manage-option:hover {
            background: rgba(0, 122, 255, 0.1);
        }

        .sms-manage-option i {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: #007AFF;
            font-size: 16px;
        }

        .sms-manage-option span {
            font-size: 16px;
            color: #333;
        }

        .sms-manage-option.delete-option i {
            color: #FF3B30;
        }

        .sms-manage-option.delete-option span {
            color: #FF3B30;
        }

        /* 🔥【修复】置顶短信对话样式 - 浅灰色背景 */
        .sms-message-item.pinned {
            background: rgba(0, 0, 0, 0.05);
        }



        /* --- 消息转发功能新增样式 --- */

        /* 1. 转发按钮样式 (位于多选菜单中) - 仿论坛转发按钮样式 */
        #selection-forward-btn {
            font-size: 18px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            text-align: center;
            color: #000000;
            display: flex;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            padding: 0;
            transition: all 0.2s ease;
            position: absolute;
            right: 15px;
            top: 70%;
            transform: translateY(-50%);
            z-index: 10;
        }

        #selection-forward-btn:hover {
            color: #333;
            transform: translateY(-50%) scale(1.1);
        }

        /* 确保多选模式下转发按钮显示 */
        #api-chat-screen.selection-mode #selection-forward-btn {
            display: flex;
        }

        #api-chat-screen:not(.selection-mode) #selection-forward-btn {
            display: none;
        }

        /* 2. 转发选择目标对话的模态框样式 */
        #forward-target-modal .modal-content {
            max-height: 70vh;
            display: flex;
            flex-direction: column;
        }

        #forward-target-modal .modal-body {
            overflow-y: auto;
            padding: 10px 0;
        }

        #forward-target-list .chat-option-item {
            padding: 12px 20px;
        }

        /* 3. 聊天气泡中的转发卡片样式 */
        .forwarded-message-card {
            background-color: #f4f4f4;
            border-radius: 8px;
            padding: 10px;
            max-width: 220px; /* 卡片最大宽度 */
            cursor: pointer;
            transition: background-color 0.2s ease;
            border: 1px solid #e0e0e0;
            margin: 0; /* 移除外边距，不需要气泡包裹 */
        }

        .forwarded-message-card:hover {
            background-color: #e9e9e9;
        }

        .forwarded-card-title {
            font-size: 13px; /* 减小字体 */
            font-weight: 600;
            color: #333;
            padding-bottom: 6px; /* 减小内边距 */
            margin-bottom: 6px;
            border-bottom: 1px solid #e0e0e0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .forwarded-card-preview {
            font-size: 12px; /* 减小字体 */
            color: #666;
            line-height: 1.3; /* 减小行高 */
        }

        .forwarded-card-preview p {
            margin: 0 0 3px; /* 减小间距 */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .forwarded-card-footer {
            font-size: 11px; /* 减小字体 */
            color: #999;
            padding-top: 6px; /* 减小内边距 */
            margin-top: 6px;
            border-top: 1px solid #e0e0e0;
        }

        /* 4. 查看转发记录详情的模态框样式 */
        #forwarded-view-modal .modal-content {
            max-height: 80vh;
            display: flex;
            flex-direction: column;
        }

        #forwarded-view-modal .modal-body {
            overflow-y: auto;
            background-color: #f7f7f7;
            padding: 15px;
        }

        .forwarded-message-item {
            margin-bottom: 12px;
        }

        .forwarded-message-sender {
            font-size: 13px;
            font-weight: 600;
            color: #555;
            margin-bottom: 4px;
        }

        .forwarded-message-content {
            background-color: #fff;
            border-radius: 8px;
            padding: 10px;
            font-size: 14px;
            line-height: 1.5;
            word-wrap: break-word;
        }
        
        /* 主题系统 - 简约风格 (默认) */
        :root {
            /* 🔥【关键修复】手机屏幕尺寸变量 - 控制手机大小 */
            --screen-width: 350px;
            --screen-height: 740px;

        /* 🔥【固定尺寸系统】防止小组件和app图标大小变化
         *
         * 此系统确保虚拟手机主屏幕上的所有元素都使用固定尺寸，
         * 不会因为屏幕大小变化或开启无边框模式而改变大小和布局。
         *
         * 主要修复内容：
         * 1. 主屏幕网格使用固定宽度和间距
         * 2. 所有app图标使用固定尺寸和字体大小
         * 3. 小组件使用固定圆角和字体大小
         * 4. 禁用所有响应式媒体查询中的动态尺寸
         * 5. 全屏模式也使用相同的固定尺寸
         */
        --fixed-home-grid-width: 320px;
        --fixed-home-grid-gap: 12px;
        --fixed-home-section-padding: 6px;
        --fixed-home-section-radius: 20px;

        /* 固定的app图标尺寸 */
        --fixed-mini-app-icon-size: 50px;
        --fixed-mini-app-icon-radius: 15px;
        --fixed-mini-app-font-size: 24px;
        --fixed-mini-app-text-size: 11px;

        --fixed-large-app-icon-size: 60px;
        --fixed-large-app-icon-radius: 18px;
        --fixed-large-app-font-size: 28px;
        --fixed-large-app-text-size: 12px;

        --fixed-dock-app-icon-size: 50px;
        --fixed-dock-app-icon-radius: 15px;
        --fixed-dock-app-font-size: 24px;
        --fixed-dock-app-text-size: 11px;

        /* 固定的小组件尺寸 */
        --fixed-widget-radius: 20px;
        --fixed-anniversary-name-size: 12px;
        --fixed-anniversary-countdown-size: 40px;
        --fixed-anniversary-date-size: 9px;
            --secondary-bg: #ffffff;
            --border-color: #e0e0e0;
            --text-primary: #1f1f1f;
            --text-secondary: #8a8a8a;
            --accent-color: #007bff;
            
            --theme-font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            --theme-font-weight: 400;
            --theme-line-height: 1.5;
            
            --theme-button-bg: rgba(74, 132, 193, 0.9);
            --theme-button-bg-hover: rgba(74, 132, 193, 1);
            --theme-button-color: white;
            --theme-button-border: none;
            --theme-button-radius: 20px;
            --theme-button-shadow: 0 2px 8px rgba(74, 132, 193, 0.3);
            
            --theme-button-secondary-bg: rgba(255, 255, 255, 0.8);
            --theme-button-secondary-bg-hover: rgba(255, 255, 255, 0.95);
            --theme-button-secondary-color: #555;
            --theme-button-secondary-border: rgba(0, 0, 0, 0.1);
            
            --theme-header-bg: rgba(247, 247, 247, 0.8);
            --theme-header-backdrop: blur(10px);
            
            --theme-form-bg: rgba(255, 255, 255, 0.8);
            --theme-input-border: rgba(0, 0, 0, 0.08);
            --theme-input-radius: 15px;
            --theme-input-focus: rgba(0, 123, 255, 0.5);
            --theme-input-focus-shadow: rgba(0, 123, 255, 0.1);
            
            --theme-avatar-bg-1: #f0f2f5;
            --theme-avatar-bg-2: #e8ebf0;
            --theme-avatar-text: #8b9dc3;
            --theme-avatar-border: rgba(255, 255, 255, 0.8);
            
            --theme-text-primary: #333;
            
            /* 默认主题的背景色 */
            --body-bg: #ffffff;
            
            /* 间距系统 */
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 12px;
            --spacing-lg: 20px;
            --spacing-xl: 32px;
            
            /* 尺寸系统 */
            --size-xs: 20px;
            --size-sm: 24px;
            --size-md: 30px;
            --size-lg: 40px;
            --size-xl: 50px;
            --size-xxl: 60px;
            
            /* 字体大小系统 */
            --font-size-xs: 10px;
            --font-size-sm: 12px;
            --font-size-md: 14px;
            --font-size-lg: 16px;
            --font-size-xl: 18px;
            --font-size-xxl: 20px;
            --font-size-xxxl: 24px;
            --font-size-huge: 32px;
            --font-size-giant: 80px;
            
            /* 圆角系统 */
            --radius-xs: 4px;
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 15px;
            --radius-xxl: 18px;
            --radius-xxxl: 20px;
            --radius-huge: 25px;
            --radius-round: 50%;
            
            /* 行高系统 */
            --line-height-tight: 1.3;
            --line-height-normal: 1.4;
            --line-height-relaxed: 1.5;
            --line-height-loose: 1.6;
            
            /* Z-index系统 */
            --z-index-dropdown: 10;
            --z-index-sticky: 20;
            --z-index-fixed: 30;
            --z-index-modal-backdrop: 40;
            --z-index-modal: 50;
            --z-index-popover: 60;
            --z-index-tooltip: 70;
            --z-index-notification: 80;
            
            /* 动画系统 */
            --transition-fast: 0.15s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
            
            /* 阴影系统 */
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 4px 15px rgba(0, 0, 0, 0.12);
            --shadow-xl: 0 8px 25px rgba(0, 0, 0, 0.15);
            --shadow-phone: 0 20px 40px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.1);
            --shadow-special: 0 8px 30px rgba(0,0,0,0.3);
            --shadow-mixed: 0 12px 35px rgba(0, 0, 0, 0.2);
            --shadow-card: 0 8px 32px rgba(0, 0, 0, 0.1);
            --shadow-neon-green: 0 0 10px rgba(0, 255, 136, 0.3);
            --shadow-neon-blue: 0 0 10px rgba(0, 212, 255, 0.4);
            --shadow-neon-green-small: 0 0 5px rgba(0, 255, 136, 0.2);
            --shadow-neon-green-large: 0 0 15px rgba(0, 255, 136, 0.4);
            --shadow-neon-green-8px: 0 0 8px rgba(0, 255, 136, 0.3);
            --shadow-neon-blue-8px: 0 0 8px rgba(0, 212, 255, 0.4);
            --shadow-form-mixed: 0 3px 8px rgba(0, 0, 0, 0.18);
            --shadow-light: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-hover: 0 4px 12px rgba(0, 0, 0, 0.15);
            --shadow-hover-alt: 0 6px 20px rgba(0, 0, 0, 0.15);
            --shadow-button: 0 2px 6px rgba(0, 0, 0, 0.08);
            
            /* 文字阴影 */
            --text-shadow-sm: 0 1px 3px rgba(0,0,0,0.5);
            --text-shadow-md: 0 3px 8px rgba(0,0,0,0.4);
            --text-shadow-light: 0 1px 3px rgba(0,0,0,0.1);
            
            /* 通用背景色 */
            --bg-white-30: rgba(255, 255, 255, 0.3);
            --bg-white-50: rgba(255, 255, 255, 0.5);
            --bg-white-70: rgba(255, 255, 255, 0.7);
            --bg-white-80: rgba(255, 255, 255, 0.8);
            --bg-white-90: rgba(255, 255, 255, 0.9);
            --bg-white-95: rgba(255, 255, 255, 0.95);
            --bg-white-10: rgba(255, 255, 255, 0.1);
            --bg-white-15: rgba(255, 255, 255, 0.15);
            --bg-black-05: rgba(0, 0, 0, 0.05);
            --bg-black-08: rgba(0, 0, 0, 0.08);
            --bg-black-10: rgba(0, 0, 0, 0.1);
            --bg-black-15: rgba(0, 0, 0, 0.15);
            --bg-black-18: rgba(0, 0, 0, 0.18);
            --bg-black-20: rgba(0, 0, 0, 0.2);
            --bg-default-05: rgba(74, 132, 193, 0.05);
            --bg-default-10: rgba(74, 132, 193, 0.1);
            --bg-default-shadow: rgba(74, 132, 193, 0.2);
            
            /* 边框颜色 */
            --border-light: rgba(255, 255, 255, 0.3);
            --border-dark: rgba(0, 0, 0, 0.08);
            --border-white-15: rgba(255, 255, 255, 0.15);
            --border-white-20: rgba(255, 255, 255, 0.2);
            --border-black-05: rgba(0, 0, 0, 0.05);
            
            /* 文字颜色 */
            --text-white-70: rgba(255, 255, 255, 0.7);
            --text-black-50: rgba(0, 0, 0, 0.5);
            
            /* 特殊背景 */
            --bg-header-default: rgba(247, 247, 247, 0.75);
            --bg-form-light: rgba(255, 255, 255, 0.6);
            --bg-black-50: rgba(0, 0, 0, 0.5);
            --bg-blue-05: rgba(0, 123, 255, 0.05);
            --bg-blue-10: rgba(0, 123, 255, 0.1);
            --bg-blue-20: rgba(0, 123, 255, 0.2);
            --bg-red-10: rgba(255, 59, 48, 0.1);
            --bg-red-20: rgba(255, 59, 48, 0.2);
            --bg-red-90: rgba(255, 59, 48, 0.9);
            --bg-white-100: rgba(255, 255, 255, 1);
            
            /* 特殊阴影 */
            --shadow-light-2: 0 2px 5px rgba(0, 0, 0, 0.1);
            --shadow-card-special: 0 4px 20px rgba(0, 0, 0, 0.15);
            --shadow-light-4: 0 2px 8px rgba(0, 0, 0, 0.04);
            --shadow-small: 0 2px 4px rgba(0, 0, 0, 0.2);
            --shadow-focus: 0 0 0 2px rgba(74, 132, 193, 0.2);
            --shadow-bottom: 0 -4px 20px rgba(0,0,0,0.15);
            --shadow-heavy: 0 4px 12px rgba(0, 0, 0, 0.3);
            
            /* 特殊边框 */
            --border-black-10: rgba(0, 0, 0, 0.1);
            --border-black-60: rgba(0, 0, 0, 0.6);
            
            /* 常用颜色变量 */
            --color-black: #000;
            --color-white: #fff;
            --color-green: #4cd964;
            --color-blue: #007AFF;
            --color-blue-light: #f0f8ff;
            --color-gray-light: #f0f0f0;
            --color-gray: #666;
            --color-gray-dark: #333;
            --color-gray-darker: #2c2c2c;
            --color-gray-medium: #999;
            --color-gray-border: #e0e0e0;
            --color-gray-bg: #f5f5f5;
            --color-gray-bg-light: #f8f8f8;
            --color-gray-bg-lighter: #fafafa;
            --color-border: #eee;
            --color-border-medium: #ddd;
            --color-border-gray: #ccc;
            --color-primary-green: #07C160;
            --color-text-light: #888;
            --color-text-lighter: #aaa;
            --color-wallpaper: #a8d4a8;
            --color-neon-green: #00ff88;
            --color-neon-blue: #00d4ff;
            --color-orange: #FF9500;
            --color-yellow: #FFCC00;
            --color-light-blue: #5AC8FA;
            --color-pink: #AF52DE;
            
            /* iOS 系统颜色 */
            --color-ios-green: #34C759;
            --color-ios-purple: #5856D6;
            --color-ios-red: #FF2D55;
            --color-ios-gray: #8E8E93;
            
            /* 渐变色 */
            --gradient-blue: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-gray: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --gradient-pink: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            
            /* 气泡颜色变量 */
            --ai-bubble-color: #f0f0f0;
            --my-bubble-color: #007AFF;
            
            /* 气泡样式系统 */
            --bubble-glass-bg-ai: rgba(240, 240, 240, 0.7);
            --bubble-glass-bg-user: rgba(0, 122, 255, 0.8);
            --bubble-glass-border-ai: rgba(255, 255, 255, 0.4);
            --bubble-glass-border-user: rgba(255, 255, 255, 0.3);
            --bubble-neon-bg-ai: rgba(240, 240, 240, 0.9);
            --bubble-neon-bg-user: rgba(0, 122, 255, 0.9);
            
            /* 悬浮按钮 */
            --floating-btn-bg: rgba(74, 132, 193, 0.35);
            --floating-btn-bg-hover: rgba(74, 132, 193, 0.55);
            --floating-btn-secondary-bg: rgba(255, 255, 255, 0.35);
            --floating-btn-secondary-bg-hover: rgba(255, 255, 255, 0.55);
            
            /* 气泡预览和演示 */
            --bubble-demo-bg: rgba(255, 255, 255, 0.8);
            --setting-card-bg: rgba(248, 249, 250, 0.8);
            --custom-input-bg: rgba(248, 249, 250, 0.8);
            --schedule-item-bg: rgba(255, 255, 255, 0.8);
            
            /* 纸张气泡特殊效果 */
            --paper-inset-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.3);
            --paper-text-shadow: 0 0.5px 1px rgba(255, 255, 255, 0.3);
            --paper-border: 1px solid rgba(0, 0, 0, 0.08);
            
            /* 主题化按钮背景 */
        --theme-button-bg-rgba: rgba(74, 132, 193, 0.9);
        --theme-button-secondary-bg-rgba: rgba(255, 255, 255, 0.8);
        
        /* 输入框和滑块 */
        --input-white-bg: rgba(255, 255, 255, 0.9);
        --slider-thumb-border: 2px solid rgba(255, 255, 255, 0.8);
        
        /* 预览气泡 */
        --preview-glass-ai: rgba(240, 240, 240, 0.7);
        --preview-glass-user: rgba(0, 122, 255, 0.8);
        --preview-glass-border: 1px solid rgba(255, 255, 255, 0.3);

        /* 通用工具类 - 替换硬编码样式 */
        .app-icon-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 18px;
        }
        
        .add-btn {
            position: absolute;
            right: 22px;
            top: 43px;
            width: var(--size-md);
            height: var(--size-md);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: var(--font-size-xxl);
            color: var(--color-gray-dark);
        }

        /* 🔥【新增】聊天页面按钮容器样式 - 解决按钮重叠问题 */
        .chat-header-actions {
            position: absolute;
            right: 22px;
            top: 43px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* 🔥【修复】聊天页面按钮样式 - 移除绝对定位避免重叠 */
        .chat-header-actions .add-btn,
        .chat-header-actions .header-action-btn {
            position: static;
            right: auto;
            top: auto;
            width: var(--size-md);
            height: var(--size-md);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: var(--font-size-xxl);
            color: var(--color-gray-dark);
            background: none;
            border: none;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .chat-header-actions .add-btn:hover,
        .chat-header-actions .header-action-btn:hover {
            background: rgba(0, 0, 0, 0.05);
            transform: scale(1.1);
        }


        
        .hide {
            display: none;
        }
        
        .flex-row {
            display: flex;
            gap: var(--spacing-sm);
        }
        
        .flex-row-center {
            display: flex;
            gap: var(--spacing-sm);
            align-items: center;
        }
        

        
        .worldbook-add-btn {
            position: absolute;
            right: 22px;
            top: 39px;
            width: var(--size-md);
            height: var(--size-md);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: var(--font-size-xxl);
            color: var(--color-gray-dark);
        }
        
        .save-btn-absolute {
            position: absolute;
            right: var(--spacing-lg);
            padding: var(--spacing-xs) var(--spacing-sm);
            background: none;
            border: none;
            font-size: var(--font-size-lg);
            color: var(--color-gray-dark);
            cursor: pointer;
        }
        
        .textarea-large {
            height: 400px;
        }
        
        .padding-none {
            padding: 0;
        }
        
        .padding-none-flex {
            padding: 0;
            display: flex;
            flex-direction: column;
        }
        
        .overflow-auto {
            overflow-y: auto;
        }
        
        .poke-settings-visible {
            display: flex;
        }
        
        .chat-menu-btn {
            position: absolute;
            right: var(--spacing-lg);
            top: 1.5px;
            width: var(--size-md);
            height: var(--size-md);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            color: var(--color-gray-dark);
        }
        
        .settings-icon-custom {
            background-color: var(--color-pink);
        }
        
        .theme-preview-simple {
            background: linear-gradient(135deg, #f7f7f7, #e8e8e8);
        }

        .theme-preview-cute {
            background: linear-gradient(135deg, #ffe6f0, #ffb6c1);
        }

        .theme-preview-dark {
            background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
        }

        /* 🌙【新增】夜间模式基础样式 */
        body[data-theme="dark"] {
            background-color: #1a1a1a;
            color: #e0e0e0;
        }

        body[data-theme="dark"] #phone-screen {
            background-color: #1a1a1a;
        }

        body[data-theme="dark"] .wallpaper {
            background: linear-gradient(135deg, #1a1a1a, #2a2a2a) !important;
        }

        body[data-theme="dark"] .app-screen {
            background-color: #1a1a1a;
            color: #e0e0e0;
        }

        body[data-theme="dark"] .app-header {
            background-color: #2a2a2a;
            border-bottom-color: #444;
        }

        body[data-theme="dark"] .app-title {
            color: #e0e0e0;
        }

        body[data-theme="dark"] .back-button {
            color: #e0e0e0;
        }

        body[data-theme="dark"] .app-content {
            background-color: #1a1a1a;
        }

        /* 设置界面暗色适配 */
        body[data-theme="dark"] .settings-item {
            background-color: #2a2a2a;
            border-color: #444;
            color: #e0e0e0;
        }

        body[data-theme="dark"] .settings-item:hover {
            background-color: #333;
        }

        body[data-theme="dark"] .settings-icon {
            background-color: #444;
            color: #e0e0e0;
        }

        /* 主题选择界面暗色适配 */
        body[data-theme="dark"] .theme-option {
            background-color: #2a2a2a;
            border-color: #444;
        }

        body[data-theme="dark"] .theme-option:hover {
            background-color: #333;
        }

        body[data-theme="dark"] .theme-name {
            color: #e0e0e0;
        }

        body[data-theme="dark"] .theme-description {
            color: #bbb;
        }

        /* 聊天界面暗色适配 */
        body[data-theme="dark"] .message-bubble {
            background-color: #2a2a2a !important;
            color: #e0e0e0 !important;
        }

        body[data-theme="dark"] .message-item.my-message .message-bubble {
            background-color: #0d7377 !important;
            color: white !important;
        }

        body[data-theme="dark"] .chat-input {
            background-color: #2a2a2a;
            border-color: #444;
            color: #e0e0e0;
        }

        body[data-theme="dark"] .chat-input::placeholder {
            color: #888;
        }

        /* 🌙【新增】夜间主题底部应用栏适配 */
        body[data-theme="dark"] .chat-tabs {
            background: linear-gradient(180deg, rgba(42, 42, 42, 0.95) 0%, rgba(26, 26, 26, 0.98) 100%);
            border-top-color: #444;
        }

        body[data-theme="dark"] .worldbook-tabs {
            background-color: #2a2a2a;
            border-top-color: #444;
        }

        body[data-theme="dark"] .anniversary-tabs {
            background-color: #2a2a2a;
            border-top-color: #444;
        }

        body[data-theme="dark"] .chat-tab,
        body[data-theme="dark"] .worldbook-tab,
        body[data-theme="dark"] .anniversary-tab {
            color: #888;
        }

        body[data-theme="dark"] .chat-tab.active,
        body[data-theme="dark"] .worldbook-tab.active,
        body[data-theme="dark"] .anniversary-tab.active {
            color: #e0e0e0;
        }

        /* 🌙【新增】夜间主题API聊天界面顶部状态栏适配 */
        body[data-theme="dark"] #api-chat-screen .app-status-bar {
            background-color: #1a1a1a;
            color: #ffffff;
        }

        /* 🌙【新增】夜间主题API聊天界面底部输入区域适配 */
        body[data-theme="dark"] #api-chat-screen .chat-input-area {
            background-color: #1a1a1a;
            border-top-color: #444;
        }

        /* 🌙【新增】夜间主题API聊天界面状态栏信号图标适配 */
        body[data-theme="dark"] #api-chat-screen .app-status-bar .signal-bar {
            background-color: #ffffff;
        }

        /* 🌙【新增】夜间主题API聊天界面电池图标完整适配 */
        body[data-theme="dark"] #api-chat-screen .app-battery-icon {
            border-color: #ffffff;
        }

        body[data-theme="dark"] #api-chat-screen .app-battery-icon::after {
            background-color: #ffffff;
        }

        body[data-theme="dark"] #api-chat-screen .app-battery-level {
            background-color: #ffffff;
        }

        /* 🌙【新增】夜间主题API聊天界面header标题栏适配 */
        body[data-theme="dark"] #api-chat-screen .header {
            background-color: #1a1a1a;
            border-bottom-color: #444;
        }

        /* 🌙【新增】夜间主题API聊天界面标题文字适配 */
        body[data-theme="dark"] #api-chat-screen .header .app-title,
        body[data-theme="dark"] #api-chat-screen .header .header-title {
            color: #ffffff;
        }

        /* 🌙【新增】夜间主题API聊天界面按钮适配 */
        body[data-theme="dark"] #api-chat-screen .header .back-btn,
        body[data-theme="dark"] #api-chat-screen .header .action-btn {
            color: #ffffff;
        }

        /* 🌙【新增】夜间主题API聊天界面按钮悬停效果 */
        body[data-theme="dark"] #api-chat-screen .header .back-btn:hover,
        body[data-theme="dark"] #api-chat-screen .header .action-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* 🌙【新增】夜间主题聊天设置界面完整适配 */
        body[data-theme="dark"] #api-chat-settings-screen {
            background-color: #1a1a1a;
        }

        body[data-theme="dark"] #api-chat-settings-screen .header {
            background-color: #1a1a1a;
            border-bottom-color: #444;
        }

        body[data-theme="dark"] #api-chat-settings-screen .header .app-title,
        body[data-theme="dark"] #api-chat-settings-screen .header .header-title {
            color: #ffffff;
        }

        body[data-theme="dark"] #api-chat-settings-screen .header .back-btn,
        body[data-theme="dark"] #api-chat-settings-screen .header .action-btn {
            color: #ffffff;
        }

        body[data-theme="dark"] #api-chat-settings-screen .settings-container {
            background-color: #1a1a1a;
        }

        body[data-theme="dark"] #api-chat-settings-screen .settings-section {
            background-color: #2a2a2a;
            border-color: #444;
        }

        body[data-theme="dark"] #api-chat-settings-screen .setting-item {
            background-color: #2a2a2a;
            border-bottom-color: #444;
            color: #ffffff;
        }

        body[data-theme="dark"] #api-chat-settings-screen .setting-item:hover {
            background-color: #333;
        }

        body[data-theme="dark"] #api-chat-settings-screen .setting-left label,
        body[data-theme="dark"] #api-chat-settings-screen .setting-left .setting-title {
            color: #ffffff;
        }

        body[data-theme="dark"] #api-chat-settings-screen .setting-left .setting-description {
            color: #cccccc;
        }

        body[data-theme="dark"] #api-chat-settings-screen .section-header h3 {
            color: #ffffff;
        }

        body[data-theme="dark"] #api-chat-settings-screen .section-header i {
            color: #4a84c1;
        }

        /* 🌙【补充】聊天设置界面更多元素的夜间主题适配 */
        body[data-theme="dark"] #api-chat-settings-screen .app-header {
            background-color: #1a1a1a;
            border-bottom-color: #444;
        }

        body[data-theme="dark"] #api-chat-settings-screen .app-title {
            color: #ffffff;
        }

        body[data-theme="dark"] #api-chat-settings-screen .back-button {
            color: #ffffff;
        }

        /* 🌙【优雅修复】聊天设置界面section-header夜间主题适配 */
        body[data-theme="dark"] #api-chat-settings-screen .settings-section .section-header {
            background-color: #2a2a2a;
        }

        body[data-theme="dark"] #api-chat-settings-screen .settings-section .section-title {
            color: #ffffff;
            background-color: transparent;
        }

        body[data-theme="dark"] #api-chat-settings-screen .settings-section .section-icon {
            color: #4a84c1;
        }

        /* 🌙【修复】角色列表分组标题夜间主题适配 */
        body[data-theme="dark"] .group-header {
            background: linear-gradient(135deg, #2a2a2a 0%, #333333 100%);
            border-bottom: 1px solid rgba(74, 132, 193, 0.2);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }



        body[data-theme="dark"] .group-title {
            color: #ffffff;
        }

        body[data-theme="dark"] .group-count {
            color: #4a84c1;
            background: rgba(74, 132, 193, 0.2);
        }

        body[data-theme="dark"] .group-chevron {
            color: #4a84c1;
            background: rgba(74, 132, 193, 0.2);
        }

        /* 🌙【修复】API聊天界面底部按钮夜间主题适配 */
        body[data-theme="dark"] .chat-action-btn {
            background-color: rgba(255, 255, 255, 0.1);
            color: #cccccc;
        }

        body[data-theme="dark"] .chat-action-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        body[data-theme="dark"] .send-button {
            background-color: #4a84c1;
            color: #ffffff;
        }

        body[data-theme="dark"] .send-button:hover {
            background-color: #5a94d1;
        }

        body[data-theme="dark"] .toggle-tools-btn {
            background-color: rgba(255, 255, 255, 0.1);
            color: #cccccc;
        }

        body[data-theme="dark"] .toggle-tools-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        /* 🌙【修复】"我"页面圆形新建按钮夜间主题适配 */
        body[data-theme="dark"] .add-persona-btn-header {
            background: rgba(255, 255, 255, 0.1);
            color: #4a84c1;
        }

        body[data-theme="dark"] .add-persona-btn-header:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        body[data-theme="dark"] .add-persona-btn-header:active {
            background: rgba(255, 255, 255, 0.15);
        }

        body[data-theme="dark"] .create-library-btn-header {
            background: rgba(255, 255, 255, 0.1);
            color: #4a84c1;
        }

        body[data-theme="dark"] .create-library-btn-header:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        body[data-theme="dark"] .create-library-btn-header:active {
            background: rgba(255, 255, 255, 0.15);
        }

        /* 🌙【修复】动态页面发布按钮夜间主题适配 - 顶部标题栏的加号按钮 */
        body[data-theme="dark"] .add-btn {
            background: transparent;
            color: #ffffff;
        }

        body[data-theme="dark"] .add-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        body[data-theme="dark"] #api-chat-settings-screen .section-title {
            color: #ffffff;
        }

        body[data-theme="dark"] #api-chat-settings-screen .setting-card {
            background-color: #2a2a2a;
            border-color: #444;
        }

        body[data-theme="dark"] #api-chat-settings-screen .setting-label {
            color: #ffffff;
        }

        body[data-theme="dark"] #api-chat-settings-screen .setting-desc {
            color: #cccccc;
        }

        body[data-theme="dark"] #api-chat-settings-screen .setting-value {
            color: #cccccc;
        }

        body[data-theme="dark"] #api-chat-settings-screen .setting-right i {
            color: #666;
        }

        body[data-theme="dark"] #api-chat-settings-screen .group-info-card {
            background-color: #2a2a2a;
            border-color: #444;
        }

        body[data-theme="dark"] #api-chat-settings-screen .group-name {
            color: #ffffff;
        }

        body[data-theme="dark"] #api-chat-settings-screen .group-member-count {
            color: #cccccc;
        }

        body[data-theme="dark"] #api-chat-settings-screen .group-description {
            color: #cccccc;
        }

        /* 🌙【新增】夜间主题短信聊天界面输入栏适配 */
        body[data-theme="dark"] .sms-input-section {
            background: rgba(26, 26, 26, 0.9);
            border-top-color: rgba(68, 68, 68, 0.6);
        }

        body[data-theme="dark"] .sms-message-input {
            background: rgba(42, 42, 42, 0.9);
            border-color: rgba(68, 68, 68, 0.6);
            color: #ffffff;
        }

        body[data-theme="dark"] .sms-message-input::placeholder {
            color: #999999;
        }

        body[data-theme="dark"] .sms-attachment-btn,
        body[data-theme="dark"] .sms-send-btn {
            background: rgba(42, 42, 42, 0.8);
            color: #ffffff;
        }

        body[data-theme="dark"] .sms-attachment-btn:hover,
        body[data-theme="dark"] .sms-send-btn:hover {
            background: rgba(68, 68, 68, 0.8);
        }

        body[data-theme="dark"] .sms-wait-reply-btn {
            background: rgba(42, 42, 42, 0.8);
            color: #ffffff;
        }

        body[data-theme="dark"] .sms-wait-reply-btn:hover {
            background: rgba(68, 68, 68, 0.8);
        }

        /* 🌙【新增】夜间主题短信消息列表适配 */
        body[data-theme="dark"] #messages-screen .app-content {
            background: #1a1a1a;
        }

        body[data-theme="dark"] .messages-list {
            background: #1a1a1a;
        }

        body[data-theme="dark"] .sms-message-item {
            background: #1a1a1a;
        }

        body[data-theme="dark"] .sms-message-item:hover {
            background: #2a2a2a;
        }

        body[data-theme="dark"] .sms-message-item:not(:last-child)::after {
            background-color: #444;
        }

        body[data-theme="dark"] .sms-message-name {
            color: #ffffff;
        }

        body[data-theme="dark"] .sms-message-preview {
            color: #cccccc;
        }

        body[data-theme="dark"] .sms-message-arrow {
            color: #666;
        }

        body[data-theme="dark"] .sms-message-avatar {
            background: #444;
        }

        body[data-theme="dark"] .sms-avatar-placeholder {
            background: #666;
            color: #ffffff;
        }

        body[data-theme="dark"] .messages-empty-state {
            background: #1a1a1a;
            color: #cccccc;
        }

        /* 🌙【新增】夜间主题短信聊天设置界面适配 */
        body[data-theme="dark"] #sms-chat-settings-screen {
            background: #1a1a1a;
        }

        body[data-theme="dark"] #sms-chat-settings-screen .header {
            background: #1a1a1a;
            border-bottom-color: #444;
        }

        body[data-theme="dark"] #sms-chat-settings-screen .header .app-title,
        body[data-theme="dark"] #sms-chat-settings-screen .header .header-title {
            color: #ffffff;
        }

        body[data-theme="dark"] #sms-chat-settings-screen .header .back-btn,
        body[data-theme="dark"] #sms-chat-settings-screen .header .action-btn {
            color: #ffffff;
        }

        body[data-theme="dark"] .sms-settings-content {
            background: #1a1a1a;
        }

        body[data-theme="dark"] .sms-settings-content .setting-group {
            background: #2a2a2a;
            border-bottom-color: #444;
        }

        body[data-theme="dark"] .sms-settings-content .setting-group h4 {
            background: #333;
            color: #4a84c1;
        }

        body[data-theme="dark"] .sms-settings-content .setting-group h4 i {
            color: #4a84c1;
        }

        body[data-theme="dark"] .sms-settings-content .setting-item {
            background: #2a2a2a;
            border-bottom-color: #444;
        }

        body[data-theme="dark"] .sms-settings-content .setting-item:hover {
            background: #333;
        }

        body[data-theme="dark"] .sms-settings-content .setting-item label {
            color: #ffffff;
        }

        body[data-theme="dark"] .sms-settings-content .slider-container input[type="range"] {
            background: #444;
        }

        body[data-theme="dark"] .sms-settings-content .slider-container span {
            color: #4a84c1;
        }


        .check-icon {
            color: var(--color-blue);
        }
        
        /* 字号大小设置样式 */
        .font-size-preview {
            padding: 20px;
            background: var(--bg-white-90);
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid var(--color-border);
        }
        
        .font-size-preview-text {
            font-size: 15px;
            line-height: 1.5;
            color: var(--color-gray-dark);
            text-align: center;
            transition: font-size 0.3s ease;
        }
        
        .font-size-slider-container {
            padding: 20px;
            background: var(--bg-white-90);
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid var(--color-border);
        }
        
        .font-size-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
            color: var(--color-gray);
        }
        
        .font-size-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--color-gray-light);
            outline: none;
            margin-bottom: 15px;
            -webkit-appearance: none;
            appearance: none;
        }
        
        .font-size-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--color-blue);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        
        .font-size-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--color-blue);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        
        .font-size-value {
            text-align: center;
            font-size: 14px;
            color: var(--color-gray-dark);
            font-weight: 500;
        }

        /* 🔥【新增】自定义字体设置样式 */
        .custom-font-container {
            padding: 20px;
            background: var(--bg-white-90);
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid var(--color-border);
        }

        .font-url-hint {
            margin-top: 8px;
            font-size: 12px;
            color: var(--color-gray);
            line-height: 1.4;
        }

        .font-url-hint > div:first-child {
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--color-gray-dark);
        }

        .font-action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .font-button {
            flex: 1;
            min-width: 100px;
            padding: 10px 15px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .font-button-preview {
            background: var(--color-blue);
            color: white;
            border: 1px solid rgba(74, 132, 193, 0.3);
        }

        .font-button-preview:hover {
            background: var(--color-blue-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(74, 132, 193, 0.3);
        }

        .font-button-apply {
            background: var(--color-green);
            color: white;
            border: 1px solid rgba(76, 175, 80, 0.3);
        }

        .font-button-apply:hover {
            background: var(--color-green-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .font-button-reset {
            background: var(--color-orange);
            color: white;
            border: 1px solid rgba(255, 152, 0, 0.3);
        }

        .font-button-reset:hover {
            background: var(--color-orange-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 152, 0, 0.3);
        }

        .font-status {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            font-size: 13px;
            line-height: 1.4;
        }

        .font-status.success {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
            color: #2e7d32;
        }

        .font-status.error {
            background: rgba(244, 67, 54, 0.1);
            border: 1px solid rgba(244, 67, 54, 0.3);
            color: #c62828;
        }

        .font-status.info {
            background: rgba(33, 150, 243, 0.1);
            border: 1px solid rgba(33, 150, 243, 0.3);
            color: #1565c0;
        }
        
        .settings-item-margin {
            margin-top: var(--spacing-lg);
        }
        
        .small-desc {
            color: var(--color-gray);
            font-size: var(--font-size-sm);
            display: block;
            margin-top: var(--spacing-xs);
        }
        
        .api-form-flex {
            display: flex;
            gap: var(--spacing-sm);
            align-items: center;
        }
        
        .api-select-hidden {
            display: none;
            flex: 1;
        }
        
        .fetch-btn {
            display: none;
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--color-blue);
            color: var(--color-white);
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: var(--font-size-sm);
            white-space: nowrap;
        }
        
        .test-connection-btn {
            background-color: var(--color-ios-green);
            margin-top: var(--spacing-sm);
        }
        
        .color-option {
            width: var(--size-md);
            height: var(--size-md);
            border-radius: var(--radius-round);
            cursor: pointer;
            border: 2px solid transparent;
            transition: all var(--transition-fast) ease;
        }
        
        .color-option:hover {
            transform: scale(1.1);
        }
        
        .color-option.selected {
            border-color: var(--color-white);
            box-shadow: 0 0 0 2px var(--color-blue);
        }
        
        .color-red { background-color: var(--color-ios-red); }
        .color-orange { background-color: var(--color-orange); }
        .color-yellow { background-color: var(--color-yellow); }
        .color-green { background-color: var(--color-ios-green); }
        .color-light-blue { background-color: var(--color-light-blue); }
        .color-blue { background-color: var(--color-blue); }
        .color-purple { background-color: var(--color-ios-purple); }
        .color-pink { background-color: var(--color-pink); }
        .color-red-alt { background-color: var(--color-ios-red); }
        
        .wallpaper-option {
            width: var(--size-xxl);
            height: var(--size-xxl);
            border-radius: var(--radius-lg);
            cursor: pointer;
            border: 2px solid transparent;
            transition: all var(--transition-fast) ease;
        }
        
        .wallpaper-option:hover {
            transform: scale(1.05);
        }
        
        .wallpaper-option.selected {
            border-color: var(--color-blue);
        }
        
        .wallpaper-gradient1 {
            background-image: linear-gradient(135deg, #6e8efb, #a777e3);
        }
        
        .wallpaper-gradient2 {
            background-image: linear-gradient(135deg, #FF9A9E, #FAD0C4);
        }
        
        .wallpaper-gradient3 {
            background-image: linear-gradient(135deg, #A1C4FD, #C2E9FB);
        }
        
        .wallpaper-gradient4 {
            background-image: linear-gradient(135deg, #FFECD2, #FCB69F);
        }
        
        .upload-custom-item {
            margin-top: var(--spacing-lg);
        }
        
        .file-input-hidden {
            display: none;
        }
        
        .icon-user-blue {
            color: var(--color-blue);
        }
        
        .icon-users-green {
            color: var(--color-ios-green);
        }
        
        .memory-checkbox {
            margin-right: var(--spacing-sm);
        }
        
        .memory-desc {
            font-size: var(--font-size-md);
            color: var(--color-gray);
            margin-top: var(--spacing-xs);
        }
        
        /* 🔥【新增】剧情总结模态框样式 */
        .storyline-modal .modal-content {
            max-width: 700px;
            max-height: 80vh;
        }

        .storyline-modal .modal-body {
            max-height: 400px;
            overflow-y: auto;
        }

        .storyline-modal textarea {
            width: 100%;
            height: 300px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.6;
            resize: vertical;
            font-family: inherit;
            box-sizing: border-box;
        }

        .storyline-modal textarea:focus {
            outline: none;
            border-color: #007AFF;
            box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.2);
        }

        .form-actions-flex {
            display: flex;
            gap: var(--spacing-sm);
        }
        
        .form-submit-flex {
            flex: 1;
        }
        
        .form-delete-red {
            background: var(--color-ios-red);
            color: var(--color-white);
            padding: var(--spacing-lg);
            border: none;
            border-radius: var(--theme-button-radius, var(--radius-xl));
            font-size: var(--font-size-xl);
            font-weight: 600;
            cursor: pointer;
            display: none;
        }
        
        .danger-color {
            color: var(--color-ios-red);
        }
        
        .danger-section-icon {
            color: var(--color-red-alt);
        }
        
        .danger-section-title {
            color: var(--color-red-alt);
        }
        
        /* 更多工具类 - 继续替换硬编码 */
        .checkbox-with-margin {
            margin-right: var(--spacing-sm);
        }
        
        .margin-top-20 {
            margin-top: var(--spacing-lg);
        }
        
        .margin-top-15 {
            margin-top: var(--spacing-lg);
        }
        
        .margin-top-10 {
            margin-top: var(--spacing-sm);
        }
        
        .margin-top-8 {
            margin-top: var(--spacing-sm);
        }
        
        .margin-top-5 {
            margin-top: var(--spacing-xs);
        }
        
        .flex-space-between {
            display: flex;
            justify-content: space-between;
            margin-top: var(--spacing-xs);
        }
        
        .flex-gap-15 {
            display: flex;
            gap: var(--spacing-lg);
        }
        
        .flex-1 {
            flex: 1;
        }
        
        .flex-gap-15-mb-15 {
            display: flex;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
        }
        
        .flex-gap-15-mb-10 {
            display: flex;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }
        
        .width-100 {
            width: 100%;
        }
        
        .max-height-200-auto {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid var(--color-border-medium);
            border-radius: var(--radius-md);
            padding: var(--spacing-sm);
        }
        
        .max-height-300-auto {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid var(--color-border-medium);
            border-radius: var(--radius-md);
            padding: var(--spacing-sm);
        }
        
        .small-text {
            font-size: var(--font-size-md);
            color: var(--color-gray);
        }
        
        .tiny-text {
            font-size: var(--font-size-sm);
            color: var(--color-gray);
        }
        
        .tiny-text-gray {
            font-size: var(--font-size-sm);
            color: var(--color-gray-medium);
        }
        
        .label-small {
            font-size: var(--font-size-md);
            color: var(--color-gray);
        }
        
        .delete-btn-red {
            background: var(--color-ios-red);
            color: var(--color-white);
            border: none;
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-xs);
            margin-right: var(--spacing-xs);
        }
        
        .cancel-btn-blue {
            background: var(--color-blue);
            color: var(--color-white);
            border: none;
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-xs);
        }
        
        .selection-checkbox {
            width: var(--size-xs);
            height: var(--size-xs);
            border-radius: var(--radius-round);
            border: 2px solid var(--color-blue);
            margin-right: var(--spacing-sm);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .selection-checkbox.selected {
            background-color: var(--color-blue);
        }
        
        .check-icon-white {
            color: var(--color-white);
            font-size: var(--font-size-sm);
        }
        
        .group-member-count {
            font-size: var(--font-size-sm);
            color: var(--color-gray);
        }
        
        .italic-gray {
            color: var(--color-gray);
            font-style: italic;
        }
        
        .text-center-gray {
            text-align: center;
            color: var(--color-gray);
            padding: var(--size-lg);
        }
        
        .worldbook-item {
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--color-border);
            cursor: pointer;
        }
        
        .worldbook-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .worldbook-title {
            font-weight: bold;
            font-size: var(--font-size-lg);
            margin-bottom: var(--spacing-xs);
        }
        
        .avatar-group-green {
            background-color: var(--color-ios-green);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--color-white);
            font-weight: bold;
        }
        
        /* JavaScript动态样式类 */
        .multiselect-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-sm) var(--spacing-lg);
            background-color: var(--color-gray-bg);
            border-bottom: 1px solid var(--color-border);
        }
        
        .contact-item.selected {
            background-color: var(--color-blue-light);
        }
        
        .empty-message {
            text-align: center;
            color: var(--color-gray);
            padding: var(--size-lg) var(--spacing-lg);
        }
        
        .empty-chat-state {
            text-align: center;
            color: var(--color-gray-medium);
            padding: var(--size-xl) var(--spacing-lg);
            font-size: var(--font-size-lg);
        }
        
        .character-info-flex {
            flex: 1;
        }
        

        
        .message-container.no-avatar .message-avatar {
            display: none;
        }
        
        /* 更多JavaScript动态样式类 */
        .empty-worldbook {
            text-align: center;
            color: var(--color-gray);
            padding: var(--size-lg);
        }
        
        .empty-playlist {
            text-align: center;
            color: var(--color-gray);
            padding: var(--spacing-lg);
        }
        
        .empty-personas {
            text-align: center;
            color: var(--color-gray);
            padding: var(--size-lg);
        }
        
        .empty-mount-chats {
            color: var(--color-gray);
            text-align: center;
            padding: var(--spacing-lg);
        }
        
        .song-title {
            font-weight: 500;
        }
        
        .song-artist {
            font-size: var(--font-size-sm);
            color: var(--color-gray);
        }
        
        .song-duration {
            font-size: var(--font-size-sm);
            color: var(--color-gray-medium);
        }
        
        .remove-character-btn {
            background: none;
            border: none;
            color: var(--color-ios-red);
            cursor: pointer;
            margin-left: var(--spacing-sm);
        }
        
        .mount-checkbox {
            margin-right: var(--spacing-sm);
        }
        
        .mount-avatar-small {
            width: var(--size-md);
            height: var(--size-md);
            border-radius: var(--radius-round);
            margin-right: var(--spacing-sm);
        }
        
        .mount-name {
            font-weight: 500;
        }
        
        .mount-type {
            font-size: var(--font-size-sm);
            color: var(--color-gray);
        }
        
        .worldbook-checkbox {
            margin-right: var(--spacing-md);
            margin-top: 2px;
        }
        
        .worldbook-content-flex {
            flex: 1;
        }
        
        .worldbook-title-text {
            font-weight: 600;
            font-size: var(--font-size-lg);
            margin-bottom: var(--spacing-xs);
            color: var(--color-gray-dark);
        }
        
        .worldbook-desc-text {
    font-size: var(--font-size-md);
    color: var(--color-gray);
    line-height: var(--line-height-normal);
    margin-bottom: var(--spacing-sm);
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    line-clamp: 3;
    -webkit-box-orient: vertical;
    max-height: 4.2em;
}
        
        .worldbook-date-text {
            font-size: var(--font-size-xs);
            color: var(--color-gray-medium);
        }
        
        .identity-avatar {
            width: var(--size-lg);
            height: var(--size-lg);
            border-radius: var(--radius-round);
            background: linear-gradient(135deg, var(--theme-avatar-bg-1), var(--theme-avatar-bg-2));
            margin-right: var(--spacing-md);
        }
        
        .identity-content-flex {
            flex: 1;
        }
        
        .identity-name {
            font-weight: 600;
            font-size: var(--font-size-lg);
            margin-bottom: 8px;
            line-height: 1.2;
        }
        
        .identity-desc {
            font-size: var(--font-size-sm);
            color: var(--color-gray);
            line-height: 1.4;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            max-height: 4.2em;
        }
        
        .identity-check-icon {
            color: var(--theme-button-bg, var(--color-blue));
            margin-left: var(--spacing-sm);
            align-self: flex-start;
            margin-top: 3px;
            flex-shrink: 0;
        }
        
        .delete-worldbook-btn {
            background: none;
            border: none;
            color: #6B9BD2;
            cursor: pointer;
            font-size: var(--font-size-lg);
            padding: var(--spacing-xs);
            transition: color 0.2s ease;
        }

        .delete-worldbook-btn:hover {
            color: #5A8BC4;
        }

        .worldbook-actions {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }
        
        .mount-item {
            display: flex;
            align-items: center;
            padding: var(--spacing-sm);
            border-bottom: 1px solid var(--color-gray-light);
            cursor: pointer;
        }
        
        .mount-avatar-group {
            width: var(--size-md);
            height: var(--size-md);
            border-radius: var(--radius-round);
            background-color: var(--color-ios-green);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--color-white);
            font-weight: bold;
            margin-right: var(--spacing-sm);
        }
        
        .empty-emoji-grid {
            text-align: center;
            color: var(--color-gray);
            padding: var(--spacing-lg);
            grid-column: 1 / -1;
        }
        
        .worldbook-mount-item {
            align-items: flex-start;
            padding: var(--spacing-md);
            transition: background-color var(--transition-fast);
        }
        
        .worldbook-mount-item:hover {
            background-color: var(--color-gray-bg-light);
        }
        
        .identity-item {
            display: flex;
            align-items: flex-start;
            padding: var(--spacing-md);
            border: 2px solid transparent;
            border-radius: var(--radius-md);
            cursor: pointer;
            margin-bottom: var(--spacing-sm);
            transition: all var(--transition-fast) ease;
            background-color: var(--color-gray-bg-light);
            min-height: 80px;
        }
        
        .identity-item.selected {
            border-color: var(--theme-button-bg, var(--color-blue));
            background-color: var(--bg-default-10);
        }
        
        .identity-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--color-gray-light);
            margin-right: var(--spacing-md);
            flex-shrink: 0;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-weight: bold;
            font-size: 18px;
        }

        .identity-content-flex {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }

        /* 🎮【游戏】样式 - 修复高度控制 */
        #gomoku-game-screen {
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden; /* 防止整个界面滚动 */
        }

        .gomoku-game-area {
            flex: 0 0 50%; /* 减少到50%的高度，给聊天区域更多空间 */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 5px; /* 减少内边距 */
            position: relative;
            box-sizing: border-box;
            min-height: 0; /* 允许flex子元素缩小 */
            overflow: hidden; /* 防止游戏区域内容溢出 */
        }

        /* 🎮【隐藏】原来的玩家信息 - 现在移到标题栏计时器两侧了 */
        .gomoku-player-left,
        .gomoku-player-right {
            display: none; /* 隐藏原来的玩家头像 */
        }

        .player-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #8b9dc3;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            position: relative;
        }

        /* 🎮【新增】棋子指示器样式 - 和棋盘棋子一样 */
        .piece-indicator {
            position: absolute !important;
            width: 14px !important;
            height: 14px !important;
            border-radius: 50% !important;
            display: block !important;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3) !important;
            z-index: 10 !important;
            transition: all 0.3s ease !important;
            box-sizing: border-box !important;
        }

        /* AI棋子指示器在头像右下角，稍微远一点 */
        .ai-piece {
            bottom: -1px !important;
            right: -7px !important;
        }

        /* 用户棋子指示器在头像左下角，稍微远一点 */
        .user-piece {
            bottom: -1px !important;
            left: -7px !important;
        }

        /* 黑色棋子样式 - 和棋盘一样 */
        .piece-indicator.black {
            background: radial-gradient(circle at 30% 30%, #666, #000) !important;
        }

        /* 白色棋子样式 - 和棋盘一样 */
        .piece-indicator.white {
            background: radial-gradient(circle at 30% 30%, #fff, #ddd) !important;
            border: 1px solid #999 !important;
        }

        .player-details {
            text-align: center;
        }

        .player-name {
            font-size: 12px;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 2px;
        }

        .player-piece {
            font-size: 16px;
        }

        /* 🎮【修改】游戏状态在聊天标题栏中 */
        .game-status {
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        .current-turn {
            font-size: 13px;
            font-weight: 600;
            color: #2d3748;
            line-height: 1;
        }

        .game-timer {
            font-size: 11px;
            color: #718096;
            font-family: 'Courier New', monospace;
            line-height: 1;
        }

        .gomoku-board-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2px 5px 5px 5px; /* 进一步减少内边距，让棋盘更紧凑 */
        }

        .gomoku-board {
            width: 300px;
            height: 300px;
            background: #deb887;
            border: 2px solid #8b7355;
            border-radius: 8px;
            position: relative;
            display: grid;
            grid-template-columns: repeat(14, 1fr);
            grid-template-rows: repeat(14, 1fr);
            gap: 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .gomoku-cell {
            border: 0.5px solid #8b7355;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            transition: background-color 0.2s ease;
        }

        .gomoku-cell:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .gomoku-cell.disabled {
            cursor: not-allowed;
        }

        .gomoku-intersection:hover {
            background-color: rgba(255, 255, 255, 0.4);
        }

        .gomoku-piece {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        .gomoku-piece.black {
            background: radial-gradient(circle at 30% 30%, #666, #000);
        }

        .gomoku-piece.white {
            background: radial-gradient(circle at 30% 30%, #fff, #ddd);
        }

        /* 🔥【新增】导出/导入模态框样式 */
        .export-options-modal,
        .import-options-modal {
            max-width: 450px;
        }

        .export-format-section {
            margin-bottom: 20px;
        }

        .export-format-section h4 {
            margin-bottom: 15px;
            color: #333;
            font-size: 16px;
            font-weight: 600;
        }

        .export-format-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .export-format-option {
            display: flex;
            align-items: center;
            padding: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #fafafa;
        }

        .export-format-option:hover {
            border-color: #5A9FD4;
            background: #f0f8ff;
        }

        .export-format-option.selected {
            border-color: #5A9FD4;
            background: #e3f2fd;
        }

        .format-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: #5A9FD4;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 20px;
        }

        .format-info {
            flex: 1;
        }

        .format-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .format-desc {
            font-size: 13px;
            color: #666;
            line-height: 1.4;
        }

        .format-radio {
            margin-left: 10px;
        }

        .format-radio input[type="radio"] {
            display: none;
        }

        .format-radio label {
            width: 24px;
            height: 24px;
            border: 2px solid #e0e0e0;
            border-radius: 50%;
            display: block;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
            background: white;
        }

        .format-radio input[type="radio"]:checked + label {
            border-color: #5A9FD4;
            background: #5A9FD4;
        }

        .format-radio input[type="radio"]:checked + label::after {
            content: '';
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: white;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .import-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .warning-icon {
            color: #f39c12;
            font-size: 20px;
            margin-top: 2px;
        }

        .warning-text {
            flex: 1;
            font-size: 14px;
            line-height: 1.5;
        }

        .warning-text strong {
            color: #e67e22;
        }

        .warning-text ul {
            margin: 8px 0 0 20px;
            padding: 0;
        }

        .warning-text li {
            margin-bottom: 4px;
            color: #666;
        }

        .import-file-section {
            text-align: center;
        }

        .import-file-btn {
            background: #5A9FD4;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .import-file-btn:hover {
            background: #4A8BC2;
        }

        .import-file-info {
            margin-top: 15px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            text-align: left;
        }

        .file-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .file-preview {
            font-size: 13px;
            color: #666;
            line-height: 1.4;
        }

        .modal-danger {
            background: #dc3545 !important;
        }

        .modal-danger:hover {
            background: #c82333 !important;
        }

        .modal-danger:disabled {
            background: #ccc !important;
            cursor: not-allowed !important;
            border: 1px solid #999;
        }

        /* 🔥【新增】导出/导入模态框关闭按钮美化 */
        .export-options-modal .modal-close-btn,
        .import-options-modal .modal-close-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 1px solid #ddd;
            background: #f8f9fa;
            color: #666;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.2s ease;
        }

        .export-options-modal .modal-close-btn:hover,
        .import-options-modal .modal-close-btn:hover {
            background: #e9ecef;
            color: #333;
        }

        .gomoku-piece.winning {
            animation: winningPulse 1s ease-in-out infinite;
        }

        @keyframes winningPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        /* 聊天区域样式 - 修复高度控制 */
        .gomoku-chat-area {
            flex: 0 0 50%; /* 增加到50%的高度，获得更多聊天空间 */
            display: flex;
            flex-direction: column;
            background: #fff;
            border-top: 1px solid #e2e8f0;
            box-sizing: border-box;
            position: relative; /* 为固定输入框提供定位基准 */
            min-height: 0; /* 允许flex子元素缩小 */
            overflow: hidden; /* 防止聊天区域溢出 */
        }

        .gomoku-chat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: #f7fafc;
            border-bottom: 1px solid #e2e8f0;
            font-size: 12px;
            font-weight: 600;
            color: #4a5568;
            height: 45px; /* 增加高度来容纳游戏状态 */
        }

        /* 🎮【新增】聊天标题栏布局 */
        .chat-header-left {
            flex: 0.8; /* 减少左侧区域比例 */
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* 🎮【简洁】下一局按钮样式 */
        .next-game-main-btn {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            border: none;
            background: transparent;
            color: #666;
            font-size: 11px;
            font-weight: normal;
            cursor: pointer;
            min-width: 60px;
            height: 24px;
        }

        .next-game-main-btn i {
            font-size: 9px;
        }

        .next-game-main-btn span {
            font-size: 10px;
        }

        .chat-header-center {
            flex: 1.4; /* 增加中央区域比例，给头像更多空间 */
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 11px; /* 稍微减少头像和计时器之间的间距 */
        }

        .chat-header-right {
            flex: 0.8; /* 减少右侧区域比例，给中央头像更多空间 */
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 4px; /* 元素间距 */
        }

        .chat-actions {
            display: flex;
            gap: 4px; /* 增加按钮间距，因为只剩两个按钮了 */
        }

        .gomoku-chat-header .chat-action-btn {
            width: 26px; /* 压缩按钮尺寸 */
            height: 26px;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px; /* 减小图标尺寸 */
            color: #666;
        }

        /* 悔棋按钮 */
        .gomoku-chat-header .chat-action-btn.undo-btn {
            color: #666;
        }

        /* 认输按钮 */
        .gomoku-chat-header .chat-action-btn.surrender-btn {
            color: #666;
        }

        /* 🎮【新增】游戏设置按钮样式 */
        .game-settings-button {
            position: absolute;
            right: 20px;
            top: 45px;
            width: 30px;
            height: 30px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #333;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
        }

        /* 🎮【新增】游戏退出模态框样式 - 毛玻璃莫兰迪色系 */
        .game-exit-modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .game-exit-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
        }

        /* 只在手机屏幕范围内应用轻微毛玻璃效果 */
        #phone-screen .game-exit-overlay {
            backdrop-filter: blur(2px);
            -webkit-backdrop-filter: blur(2px);
        }

        /* 确保手机屏幕内的模态框能正确定位 */
        #phone-screen {
            position: relative;
        }

        .game-exit-content {
            position: relative;
            width: 90%;
            max-width: 320px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }

        .game-exit-header {
            padding: 20px 20px 16px;
            text-align: center;
            border-bottom: 1px solid rgba(0, 0, 0, 0.03);
        }

        .game-exit-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #4a4a4a;
        }

        .game-exit-body {
            padding: 16px 20px 20px;
        }

        .game-exit-desc {
            margin: 0 0 20px;
            font-size: 14px;
            color: #666;
            text-align: center;
            line-height: 1.4;
        }

        .game-exit-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .game-exit-btn {
            display: flex;
            align-items: center;
            padding: 14px 16px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
            text-align: left;
            gap: 12px;
        }

        .game-exit-btn i {
            font-size: 18px;
            width: 20px;
            text-align: center;
        }

        .btn-content {
            flex: 1;
        }

        .btn-title {
            font-size: 15px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .btn-desc {
            font-size: 12px;
            opacity: 0.8;
            line-height: 1.3;
        }

        /* 莫兰迪色系按钮 */
        .save-btn {
            background: rgba(168, 196, 168, 0.8);
            color: #4a5a4a;
        }

        .save-btn:hover {
            background: rgba(168, 196, 168, 0.9);
            transform: translateY(-1px);
        }

        .clear-btn {
            background: rgba(208, 168, 168, 0.8);
            color: #5a4a4a;
        }

        .clear-btn:hover {
            background: rgba(208, 168, 168, 0.9);
            transform: translateY(-1px);
        }

        .pause-btn {
            background: rgba(168, 188, 208, 0.8);
            color: #4a4a5a;
        }

        .pause-btn:hover {
            background: rgba(168, 188, 208, 0.9);
            transform: translateY(-1px);
        }



        /* 🎮【新增】难度设置模态框样式 */
        .difficulty-settings-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .difficulty-settings-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            width: 280px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .difficulty-settings-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .difficulty-settings-header h3 {
            margin: 0;
            color: #2d3748;
            font-size: 18px;
            font-weight: 600;
        }

        .difficulty-slider-container {
            margin: 20px 0;
        }

        .difficulty-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 14px;
            color: #4a5568;
        }

        .difficulty-value {
            font-weight: 600;
            color: #2d3748;
        }

        .difficulty-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e2e8f0;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            margin: 10px 0;
        }

        .difficulty-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #8b9dc3;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        .difficulty-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #8b9dc3;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        .difficulty-description {
            font-size: 12px;
            color: #718096;
            text-align: center;
            margin: 15px 0;
            line-height: 1.4;
        }

        .difficulty-settings-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .difficulty-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .difficulty-btn.confirm {
            background: #8b9dc3;
            color: white;
        }

        .difficulty-btn.confirm:hover {
            background: #7a8bb0;
            transform: translateY(-1px);
        }

        .difficulty-btn.cancel {
            background: #e2e8f0;
            color: #4a5568;
        }

        .difficulty-btn.cancel:hover {
            background: #cbd5e0;
        }

        .gomoku-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .gomoku-chat-input {
            display: flex;
            padding: 12px 15px;
            background: #f7fafc;
            border-top: 1px solid #e2e8f0;
            gap: 10px;
            flex-shrink: 0;
            height: 60px;
            box-sizing: border-box;
            align-items: center;
        }

        .gomoku-chat-input input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s ease;
        }

        .gomoku-chat-input input:focus {
            border-color: #8b9dc3;
        }

        .gomoku-chat-input button {
            width: 36px;
            height: 36px;
            border: none;
            background: #8b9dc3;
            color: white;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .gomoku-chat-input button:hover {
            background: #7a8bb0;
            transform: scale(1.05);
        }

        .gomoku-chat-input button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
        }

        .game-chat-message {
            display: flex;
            margin-bottom: 8px;
            align-items: flex-end;
            gap: 8px;
        }

        /* 🔥【新增】游戏聊天头像样式 */
        .game-chat-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #666;
            flex-shrink: 0;
            margin-bottom: 2px;
        }

        .game-chat-message.user .game-chat-avatar {
            background: #4a90e2;
            color: white;
        }

        .game-chat-message.dm .game-chat-avatar {
            background: #f39c12;
            color: white;
        }

        .game-chat-message:not(.user):not(.dm):not(.system) .game-chat-avatar {
            background: #e74c3c;
            color: white;
        }

        .game-chat-message.user {
            justify-content: flex-end;
        }

        .game-chat-message.ai {
            justify-content: flex-start;
        }

        .game-chat-bubble {
            max-width: 70%;
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .game-chat-message.user .game-chat-bubble {
            background: #8b9dc3;
            color: white;
            border-bottom-right-radius: 4px;
        }

        .game-chat-message.ai .game-chat-bubble {
            background: #f1f5f9;
            color: #2d3748;
            border-bottom-left-radius: 4px;
        }

        .game-chat-message.system {
            justify-content: center;
        }

        .game-chat-message.system .game-chat-bubble {
            background: #fed7d7;
            color: #c53030;
            font-size: 12px;
            border-radius: 16px;
        }

        /* 🎮【新增】加载气泡样式 */
        .game-chat-bubble.loading {
            background: #e8e8e8;
            padding: 12px 16px;
        }

        .typing-dots {
            display: inline-block;
        }

        .typing-dots span {
            display: inline-block;
            animation: typing 1.4s infinite;
            font-size: 16px;
            color: #999;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                opacity: 0.3;
                transform: translateY(0);
            }
            30% {
                opacity: 1;
                transform: translateY(-10px);
            }
        }

        /* 🎮【海龟汤游戏】样式 */
        .game-button.turtle-soup {
            background: linear-gradient(135deg, rgba(168, 162, 158, 0.3), rgba(168, 162, 158, 0.1));
            color: #4a5568;
        }

        /* 海龟汤游戏主容器 - 使用flex布局固定比例 */
        #turtle-soup-game-screen {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        /* 游戏区域 (50%) */
        .turtle-soup-game-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            padding: 10px;
            box-sizing: border-box;
            overflow: hidden;
        }

        .turtle-soup-dm-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 6px;
            flex-shrink: 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .turtle-soup-dm-header {
            display: flex;
            align-items: center;
            margin-bottom: 6px;
        }

        .turtle-soup-dm-avatar {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 10px;
            margin-right: 8px;
        }

        .turtle-soup-dm-name {
            font-weight: bold;
            color: #2e7d32;
            font-size: 12px;
        }

        .turtle-soup-dm-role {
            font-size: 10px;
            color: #666;
            margin-left: 4px;
        }

        .turtle-soup-story-section {
            flex: 1;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            padding: 8px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .turtle-soup-story-title {
            font-size: 14px;
            font-weight: bold;
            color: #2e7d32;
            margin-bottom: 8px;
            text-align: center;
        }

        .turtle-soup-story-content {
            flex: 1;
            font-size: 13px;
            line-height: 1.3;
            color: #333;
            text-align: center;
            padding: 8px;
            border: 2px dashed #4caf50;
            border-radius: 8px;
            background: rgba(76, 175, 80, 0.05);
            overflow-y: auto;
        }

        .turtle-soup-game-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 8px;
            padding: 6px 8px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 6px;
        }

        .turtle-soup-question-count {
            font-size: 12px;
            color: #2e7d32;
            font-weight: bold;
        }

        .turtle-soup-game-timer {
            font-size: 12px;
            color: #666;
            font-family: 'Courier New', monospace;
        }

        /* 聊天区域 (50%) */
        .turtle-soup-chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #fff;
            border-top: 1px solid #e2e8f0;
            box-sizing: border-box;
            overflow: hidden;
        }

        .turtle-soup-chat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 15px;
            background: #f8f9fa;
            border-bottom: 1px solid #e2e8f0;
            position: relative;
        }

        /* 🔥【新增】发言结束按钮样式 */
        .finish-speaking-btn {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(76, 175, 80, 0.3);
        }

        .finish-speaking-btn:hover {
            background: #45a049;
        }

        .finish-speaking-btn:active {
            background: #3d8b40;
        }

        .finish-speaking-btn i {
            font-size: 14px;
        }

        .finish-speaking-btn span {
            font-size: 12px;
        }

        .turtle-soup-chat-title {
            font-weight: bold;
            color: #2e7d32;
            font-size: 14px;
        }

        .turtle-soup-chat-actions {
            display: flex;
            gap: 8px;
        }

        .turtle-soup-chat-actions .chat-action-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #4caf50;
            transition: all 0.2s ease;
        }

        .turtle-soup-chat-actions .chat-action-btn:hover {
            background: rgba(76, 175, 80, 0.1);
        }

        .turtle-soup-chat-actions .chat-action-btn.hint-btn {
            color: #ff9800;
        }

        .turtle-soup-chat-actions .chat-action-btn.give-up-btn {
            color: #f44336;
        }

        .turtle-soup-chat-actions .chat-action-btn.new-game-btn {
            color: #4caf50;
        }

        .turtle-soup-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        /* 🔥【新增】海龟汤聊天消息样式 - 参考五子棋，无头像只有气泡 */
        .turtle-soup-chat-messages .game-chat-message {
            display: flex;
            margin-bottom: 8px;
            align-items: flex-end;
        }

        .turtle-soup-chat-messages .game-chat-message.user {
            justify-content: flex-end;
        }

        .turtle-soup-chat-messages .game-chat-message:not(.user):not(.system) {
            justify-content: flex-start;
        }

        .turtle-soup-chat-messages .game-chat-message.system {
            justify-content: center;
        }

        .turtle-soup-chat-messages .game-chat-bubble {
            max-width: 70%;
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .turtle-soup-chat-messages .game-chat-message.user .game-chat-bubble {
            background: #8b9dc3;
            color: white;
            border-bottom-right-radius: 4px;
        }

        .turtle-soup-chat-messages .game-chat-message:not(.user):not(.system) .game-chat-bubble {
            background: #f1f5f9;
            color: #2d3748;
            border-bottom-left-radius: 4px;
        }

        .turtle-soup-chat-messages .game-chat-message.system .game-chat-bubble {
            background: #fed7d7;
            color: #c53030;
            font-size: 12px;
            border-radius: 16px;
        }

        /* 🔥【新增】搜索聊天内容样式 */
        .search-result-item {
            padding: 12px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .search-result-item:hover {
            background-color: #f8f9fa;
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .search-result-content {
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 6px;
            word-wrap: break-word;
        }

        .search-result-meta {
            font-size: 12px;
            color: #666;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .search-result-sender {
            font-weight: 500;
        }

        .search-result-time {
            color: #999;
        }

        .search-highlight {
            background-color: #ffeb3b;
            padding: 1px 2px;
            border-radius: 2px;
        }

        .context-message {
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.4;
        }

        .context-message.user {
            background-color: #e3f2fd;
            margin-left: 20px;
        }

        .context-message.character {
            background-color: #f5f5f5;
            margin-right: 20px;
        }

        .context-message.target {
            background-color: #fff3e0;
            border: 2px solid #ff9800;
            font-weight: 500;
        }

        .context-message-meta {
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
        }

        .turtle-soup-chat-input {
            display: flex;
            padding: 12px 15px;
            background: #f8f9fa;
            border-top: 1px solid #e2e8f0;
            gap: 12px;
            align-items: center;
            flex-shrink: 0;
            height: 60px;
            box-sizing: border-box;
        }

        .turtle-soup-chat-input input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 24px;
            font-size: 14px;
            outline: none;
            background: white;
        }

        .turtle-soup-chat-input input:focus {
            border-color: #4caf50;
        }

        .turtle-soup-chat-input button {
            width: 40px;
            height: 40px;
            border: none;
            background: #4caf50;
            color: white;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.2s ease;
        }

        .turtle-soup-chat-input button:hover {
            background: #45a049;
            transform: scale(1.05);
        }

        .turtle-soup-chat-input button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* 🔥【新增】海龟汤设置模态框样式 */
        .turtle-soup-settings-modal {
            max-width: 500px;
            width: 90%;
            z-index: 10001;
            position: relative;
        }

        .turtle-soup-types {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 10px;
        }

        .turtle-soup-type-option {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .turtle-soup-type-option:hover {
            border-color: #4caf50;
            background: rgba(76, 175, 80, 0.05);
        }

        .turtle-soup-type-option input[type="radio"] {
            margin-right: 12px;
            accent-color: #4caf50;
        }

        .turtle-soup-type-option input[type="radio"]:checked + .type-label {
            color: #4caf50;
        }

        .type-label {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .type-label i {
            font-size: 16px;
            margin-right: 8px;
            color: #4caf50;
        }

        .type-label strong {
            font-size: 14px;
            color: #333;
        }

        .type-label small {
            font-size: 12px;
            color: #666;
            line-height: 1.3;
        }

        .dm-personality-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }

        .dm-personality-option {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .dm-personality-option:hover {
            border-color: #4caf50;
            background: rgba(76, 175, 80, 0.05);
        }

        .dm-personality-option input[type="radio"] {
            margin-right: 10px;
            accent-color: #4caf50;
        }

        .dm-personality-option span {
            font-size: 14px;
            color: #333;
        }

        .setting-section {
            margin-bottom: 24px;
        }

        .setting-section h4 {
            font-size: 16px;
            color: #2e7d32;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .setting-section h4 i {
            color: #4caf50;
        }
        }

        /* 可爱风格主题 */
        body[data-theme="cute"] {
            --theme-font-family: 'Varela Round', 'Quicksand', sans-serif;
            --theme-font-weight: 500;
            --theme-line-height: 1.6;
            --theme-title-font-size: 20px;
            --theme-title-font-weight: 700;
            --theme-setting-title-font: 'Fredoka One', 'Comfortaa', sans-serif;
            
            --theme-button-bg: rgba(255, 182, 193, 0.9);
            --theme-button-bg-hover: rgba(255, 182, 193, 1);
            --theme-button-color: white;
            --theme-button-border: none;
            --theme-button-radius: 25px;
            --theme-button-shadow: 0 3px 10px rgba(255, 105, 180, 0.4);
            --theme-button-font-size: 16px;
            --theme-button-font-weight: 600;
            --theme-button-letter-spacing: 0.5px;
            
            --theme-button-secondary-bg: rgba(255, 240, 245, 0.8);
            --theme-button-secondary-bg-hover: rgba(255, 240, 245, 0.95);
            --theme-button-secondary-color: #d44d5c;
            --theme-button-secondary-border: rgba(255, 182, 193, 0.3);
            
            --theme-header-bg: rgba(255, 230, 240, 0.8);
            --theme-header-backdrop: blur(10px);
            
            --theme-form-bg: rgba(255, 249, 252, 0.8);
            --theme-input-border: rgba(255, 204, 213, 0.4);
            --theme-input-radius: 20px;
            --theme-input-focus: rgba(255, 182, 193, 0.6);
            --theme-input-focus-shadow: rgba(255, 182, 193, 0.1);
            
            --theme-avatar-bg-1: #ffe6f2;
            --theme-avatar-bg-2: #ffd6e8;
            --theme-avatar-text: #d44d5c;
            --theme-avatar-border: rgba(255, 255, 255, 0.9);
            
            --theme-text-primary: #d44d5c;
            --theme-text-shadow: 0 1px 3px rgba(255, 182, 193, 0.2);
            
            /* 可爱主题的背景色 */
            --body-bg: linear-gradient(135deg, #ffeef7, #ffe4f0);
            
            /* 可爱主题的气泡样式重写 */
            --bubble-glass-bg-ai: rgba(255, 240, 245, 0.8);
            --bubble-glass-bg-user: rgba(255, 182, 193, 0.85);
            --bubble-glass-border-ai: rgba(255, 204, 213, 0.4);
            --bubble-glass-border-user: rgba(255, 182, 193, 0.3);
            --bubble-neon-bg-ai: rgba(255, 240, 245, 0.95);
            --bubble-neon-bg-user: rgba(255, 182, 193, 0.9);
            
            /* 可爱主题的悬浮按钮 */
            --floating-btn-bg: rgba(255, 182, 193, 0.35);
            --floating-btn-bg-hover: rgba(255, 182, 193, 0.55);
            
            /* 可爱主题的按钮背景重写 */
            --theme-button-bg-rgba: rgba(255, 182, 193, 0.9);
            --theme-button-secondary-bg-rgba: rgba(255, 240, 245, 0.8);
            
            /* 可爱主题的预览气泡 */
            --preview-glass-ai: rgba(255, 240, 245, 0.8);
            --preview-glass-user: rgba(255, 182, 193, 0.85);
            --preview-glass-border: 1px solid rgba(255, 204, 213, 0.4);
        }
        
        /* 可爱主题的特殊效果 */
        body[data-theme="cute"] .settings-icon {
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(255, 182, 193, 0.3);
        }
        
        body[data-theme="cute"] .form-submit:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 6px 20px rgba(255, 182, 193, 0.4);
        }
        

        
        body[data-theme="cute"] .control-btn {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            box-shadow: 0 3px 10px rgba(255, 182, 193, 0.3);
        }
        
        body[data-theme="cute"] .control-btn:hover {
            transform: scale(1.1) rotate(5deg);
        }
        
        /* 可爱主题的录音按钮样式 */
        body[data-theme="cute"] .tool-btn-mini.recording {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%) !important;
            color: white !important;
            border-color: #ff9a9e !important;
            box-shadow: 0 0 0 2px rgba(255, 154, 158, 0.3) !important;
        }
        
        body[data-theme="cute"] .app-title.chat-mode {
            background: linear-gradient(90deg, #ff6b9d, #ffa8cc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* 聊天消息气泡基础样式 */
        .message-bubble { 
            word-break: break-word; 
            line-height: 1.5; 
            font-size: var(--global-font-size, 15px) !important;
            letter-spacing: var(--global-letter-spacing, 0px) !important;
            /* 默认不设置font-weight和font-family，使用浏览器默认值 */
        }
        
        /* 可爱风格的聊天消息样式 - 🔥【修复】不强制覆盖全局字体 */
        body[data-theme="cute"] .message-bubble {
            /* font-family: 'Quicksand', sans-serif !important; 注释掉，让全局字体生效 */
            font-weight: 500 !important;
        }
        
        /* 确保所有气泡样式都应用全局字体大小和字距 */
        .message-bubble,
        .bubble-style-default .message-bubble,
        .bubble-style-shadow .message-bubble,
        .bubble-style-tail .message-bubble,
        .bubble-style-paper .message-bubble {
            font-size: var(--global-font-size, 15px) !important;
            letter-spacing: var(--global-letter-spacing, 0px) !important;
        }

       

        html { 
            height: 100%; 
            overflow: hidden; 
        }
        
        body {
            height: 100%;
            overflow: hidden;
            margin: 0;
            padding: 0; /* 移除padding，消除顶部空白 */
            font-family: var(--theme-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif);
            font-weight: normal;
            background: var(--body-bg, #dcdcdc);
            display: flex;
            justify-content: center;
            align-items: center; /* 恢复居中对齐 */
            box-sizing: border-box;
            transition: all 0.3s ease;
            /* 🔥【移动端修复】防止虚拟键盘影响布局 */
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }
        
        /* 手机壳样式已完全移除 */

        /* 🔥【新增】全屏显示模式样式 */
        #phone-screen.fullscreen-mode {
            width: 100vw !important;
            height: 100vh !important;
            border-radius: 0 !important;
            border: none !important;
            box-shadow: none !important;
            margin: 0 !important;
            max-width: none !important;
            max-height: none !important;
            transform: none !important; /* 全屏时移除偏移 */
        }

        /* 🔥【修复】Via浏览器全屏模式下底部输入框悬浮问题 - 保守修复 */
        @media screen and (max-width: 768px) {
            /* 只在移动端全屏模式下应用修复 */
            body.fullscreen-mode #phone-screen.fullscreen-mode .chat-input-area,
            body.fullscreen-mode #phone-screen.fullscreen-mode .offline-input-area {
                /* 确保输入框贴底显示 */
                bottom: 0 !important;
                position: fixed !important;
                left: 0 !important;
                right: 0 !important;
                width: 100% !important;
                margin: 0 !important;
                /* 添加硬件加速以改善渲染 */
                transform: translateZ(0);
                -webkit-transform: translateZ(0);
            }
        }

        body.fullscreen-mode {
            background: var(--color-black, #000) !important;
            padding: 0 !important;
            overflow: hidden !important;
            align-items: stretch !important; /* 全屏时拉伸对齐 */
        }

        /* 🔥【固定尺寸】全屏模式下的主屏幕布局优化 - 使用固定尺寸 */
        #phone-screen.fullscreen-mode #home-grid {
            width: var(--fixed-home-grid-width) !important;
            height: var(--fixed-home-grid-width) !important;
            gap: var(--fixed-home-grid-gap) !important;
            top: 55% !important;
        }

        #phone-screen.fullscreen-mode .home-section {
            padding: var(--fixed-home-section-padding) !important;
            border-radius: var(--fixed-home-section-radius) !important;
        }

        #phone-screen.fullscreen-mode .mini-app-icon {
            width: var(--fixed-mini-app-icon-size) !important;
            height: var(--fixed-mini-app-icon-size) !important;
        }

        #phone-screen.fullscreen-mode .mini-app span {
            font-size: var(--fixed-mini-app-text-size) !important;
        }

        #phone-screen.fullscreen-mode .dock-app-icon {
            width: var(--fixed-dock-app-icon-size) !important;
            height: var(--fixed-dock-app-icon-size) !important;
        }

        #phone-screen.fullscreen-mode .dock-app span {
            font-size: var(--fixed-dock-app-text-size) !important;
        }

        /* 🔥【固定尺寸】全屏模式下的状态栏和时钟优化 */
        #phone-screen.fullscreen-mode #status-bar {
            padding: 12px 24px 6px 24px !important;
            font-size: 16px !important; /* 固定字体大小 */
        }

        #phone-screen.fullscreen-mode #clock-container {
            top: 25% !important; /* 调整时钟位置 */
        }

        /* 🔥【修改】全屏模式下的时钟样式适配 */
        #phone-screen.fullscreen-mode #main-time {
            font-size: 64px !important; /* 默认时钟大小 */
        }

        #phone-screen.fullscreen-mode #main-date {
            font-size: 20px !important; /* 默认日期大小 */
        }

        /* 全屏模式下的样式变体 */
        #phone-screen.fullscreen-mode body[data-clock-style="bold"] #main-time {
            font-size: 68px !important;
            font-weight: 700 !important;
        }

        #phone-screen.fullscreen-mode body[data-clock-style="bold"] #main-date {
            font-size: 22px !important;
            font-weight: 600 !important;
        }

        #phone-screen.fullscreen-mode body[data-clock-style="compact"] #main-time {
            font-size: 58px !important;
            font-weight: 300 !important;
        }

        #phone-screen.fullscreen-mode body[data-clock-style="compact"] #main-date {
            font-size: 18px !important;
            font-weight: 400 !important;
        }

        #phone-screen.fullscreen-mode body[data-clock-style="modern"] #main-time {
            font-size: 72px !important;
            font-weight: 100 !important;
        }

        #phone-screen.fullscreen-mode body[data-clock-style="modern"] #main-date {
            font-size: 24px !important;
            font-weight: 300 !important;
        }

        /* 🔥【固定尺寸】全屏模式下的Dock栏优化 */
        #phone-screen.fullscreen-mode #dock-bar {
            padding: 12px 20px !important; /* 固定内边距 */
        }

        /* 🔥【固定尺寸】全屏模式下的小组件优化 */
        #phone-screen.fullscreen-mode .widget {
            border-radius: var(--fixed-widget-radius) !important;
        }

        #phone-screen.fullscreen-mode .photo-placeholder,
        #phone-screen.fullscreen-mode .anniversary-placeholder {
            font-size: 14px !important; /* 固定占位符字体大小 */
        }

        #phone-screen.fullscreen-mode .anniversary-name {
            font-size: var(--fixed-anniversary-name-size) !important;
        }

        #phone-screen.fullscreen-mode .anniversary-countdown {
            font-size: var(--fixed-anniversary-countdown-size) !important;
        }

        #phone-screen.fullscreen-mode .anniversary-date {
            font-size: var(--fixed-anniversary-date-size) !important;
        }
        

        
        #phone-screen {
            width: var(--screen-width);
            height: var(--screen-height);
            background-color: var(--color-black);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            border-radius: 18px;
            box-shadow: var(--shadow-phone);
            /* 🔥【移动端修复】确保虚拟手机始终居中 */
            flex-shrink: 0;
            transform: translateZ(0); /* 启用硬件加速 */
            margin: 0 auto; /* 默认居中 */
            transition: all 0.3s ease; /* 平滑过渡效果 */
            /* 🔥【关键修复】模拟手机壳的padding效果，保持原有位置 */
            transform: translateY(-12px); /* 向上偏移12px，模拟手机壳padding的效果 */
        }
        
        .wallpaper {
            width: 100%;
            height: 100%;
            background: var(--color-wallpaper);
            background-size: cover;
            background-position: center;
            position: relative;
            display: flex;
            flex-direction: column;
        }
        
        #status-bar {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            padding: 12px 24px 6px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            z-index: 10;
            font-size: 14px;
            box-sizing: border-box;
            pointer-events: none;
            background: transparent;
        }

        /* 在通话界面中隐藏主屏幕状态栏 */
        body:has(#phone-call-screen[style*="flex"]) #status-bar,
        body:has(#incoming-call-screen[style*="flex"]) #status-bar,
        body:has(#video-call-screen[style*="flex"]) #status-bar,
        body:has(#incoming-video-call-screen[style*="flex"]) #status-bar {
            display: none !important;
        }

        /* 🔥【新增】在所有应用界面中隐藏主屏幕状态栏 */
        body:has(#worldbook-screen[style*="flex"]) #status-bar,
        body:has(#anniversary-screen[style*="flex"]) #status-bar,
        body:has(#shopping-screen[style*="flex"]) #status-bar,
        body:has(#shopping-cart-screen[style*="flex"]) #status-bar,
        body:has(#messages-screen[style*="flex"]) #status-bar,
        body:has(#sms-chat-screen[style*="flex"]) #status-bar,
        body:has(#sms-chat-settings-screen[style*="flex"]) #status-bar,
        body:has(#chat-screen[style*="flex"]) #status-bar,
        body:has(#publish-moment-screen[style*="flex"]) #status-bar,
        body:has(#forum-screen[style*="flex"]) #status-bar,
        body:has(#create-forum-screen[style*="flex"]) #status-bar,
        body:has(#forum-view-screen[style*="flex"]) #status-bar,
        body:has(#post-view-screen[style*="flex"]) #status-bar,
        body:has(#forum-profile-screen[style*="flex"]) #status-bar,
        body:has(#gomoku-game-screen[style*="flex"]) #status-bar,
        body:has(#diary-screen[style*="flex"]) #status-bar,
        body:has(#diary-settings-screen[style*="flex"]) #status-bar,
        body:has(#memory-viewer-screen[style*="flex"]) #status-bar,
        body:has(#worldbook-form-screen[style*="flex"]) #status-bar,
        body:has(#api-chat-settings-screen[style*="flex"]) #status-bar,
        body:has(#character-form-screen[style*="flex"]) #status-bar,
        body:has(#persona-form-screen[style*="flex"]) #status-bar,
        body:has(#emoji-library-screen[style*="flex"]) #status-bar,
        body:has(#api-chat-screen[style*="flex"]) #status-bar,
        body:has(#browser-screen[style*="flex"]) #status-bar,
        body:has(#settings-screen[style*="flex"]) #status-bar,
        body:has(#data-management-screen[style*="flex"]) #status-bar,
        body:has(#emergency-recovery-screen[style*="flex"]) #status-bar,
        body:has(#about-screen[style*="flex"]) #status-bar,
        body:has(#display-screen[style*="flex"]) #status-bar,
        body:has(#screen-size-screen[style*="flex"]) #status-bar,
        body:has(#appearance-screen[style*="flex"]) #status-bar,
        body:has(#sound-settings-screen[style*="flex"]) #status-bar,
        body:has(#theme-screen[style*="flex"]) #status-bar,
        body:has(#custom-theme-screen[style*="flex"]) #status-bar,
        body:has(#wallpaper-screen[style*="flex"]) #status-bar,
        body:has(#wifi-screen[style*="flex"]) #status-bar,
        body:has(#api-settings-screen[style*="flex"]) #status-bar,
        body:has(#character-phone-screen[style*="flex"]) #status-bar,
        body:has(#character-phone-chat-screen[style*="flex"]) #status-bar,
        body:has(#character-phone-note-screen[style*="flex"]) #status-bar,
        body:has(#character-phone-photo-screen[style*="flex"]) #status-bar {
            display: none !important;
        }

        /* 备用方案：当应用界面显示时隐藏主屏幕状态栏 */
        .wallpaper:has(~ #phone-call-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #incoming-call-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #video-call-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #incoming-video-call-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #messages-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #sms-chat-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #sms-chat-settings-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #api-chat-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #settings-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #worldbook-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #anniversary-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #shopping-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #shopping-cart-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #chat-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #publish-moment-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #forum-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #create-forum-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #forum-view-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #post-view-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #forum-profile-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #gomoku-game-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #diary-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #diary-settings-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #memory-viewer-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #worldbook-form-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #api-chat-settings-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #character-form-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #persona-form-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #emoji-library-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #browser-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #data-management-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #emergency-recovery-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #about-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #display-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #screen-size-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #appearance-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #sound-settings-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #theme-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #custom-theme-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #wallpaper-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #wifi-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #api-settings-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #character-phone-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #character-phone-chat-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #character-phone-note-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #character-phone-photo-screen[style*="flex"]) #status-bar {
            display: none !important;
        }

        /* 🔥【新增】备用方案：当日记界面显示时隐藏主屏幕状态栏 */
        .wallpaper:has(~ #diary-screen[style*="flex"]) #status-bar,
        .wallpaper:has(~ #diary-settings-screen[style*="flex"]) #status-bar {
            display: none !important;
        }

        /* 主屏幕字体颜色设置 */
        body[data-home-font="black"] #status-bar-time,
        body[data-home-font="black"] #main-time,
        body[data-home-font="black"] #main-date,
        body[data-home-font="black"] .mini-app span,
        body[data-home-font="black"] .dock-app span {
            color: black !important;
            text-shadow: none !important;
        }

        body[data-home-font="black"] .battery-icon {
            border-color: black !important;
        }

        body[data-home-font="black"] .battery-icon::after {
            background-color: black !important;
        }

        body[data-home-font="black"] .battery-level {
            background-color: black !important;
        }

        /* 白色字体保持原有阴影效果 */
        body[data-home-font="white"] #status-bar-time,
        body[data-home-font="white"] #main-time,
        body[data-home-font="white"] #main-date,
        body[data-home-font="white"] .mini-app span,
        body[data-home-font="white"] .dock-app span {
            color: white !important;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5) !important;
        }

        body[data-home-font="white"] .battery-icon {
            border-color: white !important;
        }

        body[data-home-font="white"] .battery-icon::after {
            background-color: white !important;
        }

        body[data-home-font="white"] .battery-level {
            background-color: white !important;
        }
        
        #status-bar-time {
            font-weight: 600;
            display: flex;
            align-items: center;
            font-size: 14px !important; /* 确保主屏幕状态栏时间字体大小正确 */
        }
        
        #status-bar-time::after {
            content: var(--status-icon, "🐾");
            margin-left: 4px;
            font-size: 12px;
        }

        /* 状态栏右侧容器 */
        .status-bar-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* 信号强度图标样式 */
        .signal-icon {
            display: flex;
            flex-direction: column;
        }

        .signal-row {
            display: flex;
            gap: 2px;
            align-items: flex-end;
            height: 12px;
        }

        .signal-bar {
            width: 3px;
            border-radius: 1px;
            background-color: var(--signal-color, #000);
        }

        .signal-row .signal-bar:nth-child(1) { height: 3px; }
        .signal-row .signal-bar:nth-child(2) { height: 6px; }
        .signal-row .signal-bar:nth-child(3) { height: 9px; }
        .signal-row .signal-bar:nth-child(4) { height: 12px; }

        /* 主屏幕字体颜色设置 - 信号图标 */
        body[data-home-font="black"] #status-bar .signal-bar {
            background-color: black !important;
        }

        body[data-home-font="white"] #status-bar .signal-bar {
            background-color: white !important;
        }

        /* 应用状态栏右侧容器 */
        .app-status-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* 应用内信号强度图标样式 */
        .app-signal-icon {
            display: flex;
            flex-direction: column;
        }

        /* 应用状态栏信号图标颜色 - 默认黑色 */
        .app-status-bar .signal-bar {
            background-color: #000;
        }

        /* 通话界面状态栏信号图标 - 白色 */
        #phone-call-screen .app-status-bar .signal-bar,
        #incoming-call-screen .app-status-bar .signal-bar,
        #video-call-screen .app-status-bar .signal-bar,
        #incoming-video-call-screen .app-status-bar .signal-bar {
            background-color: white !important;
        }
        
        .battery-container {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 14px;
        }
        
        .battery-icon {
            width: 21px;
            height: 10px;
            border: 1px solid white;
            border-radius: 4px;
            position: relative;
            padding: 1px;
        }
        
        .battery-icon::after {
            content: '';
            position: absolute;
            right: -2px;
            top: 3.5px;
            width: 1.5px;
            height: 4px;
            background-color: white;
            border-radius: 0 1px 1px 0;
        }
        
        .battery-level {
            height: 100%;
            background-color: white;
            border-radius: 2px;
            transition: width 0.5s ease;
        }
        
        .battery-container.charging .battery-level {
            background-color: var(--color-green);
            animation: charge-breath 2s infinite;
        }
        
        .battery-container.charging .battery-text {
            color: var(--color-green);
        }
        
        @keyframes charge-breath {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* 评论输入框动画 */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes slideOut {
            from {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            to {
                opacity: 0;
                transform: translateY(-10px) scale(0.95);
            }
        }
        
        #clock-container {
            text-align: center;
            color: white;
            text-shadow: var(--text-shadow-md);
            margin-bottom: 50px;
            flex-shrink: 0;
            margin-top: 70px;
            padding-top: 15px;
        }
        
        #main-date {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        #main-time {
            font-size: 80px;
            font-weight: 200;
            transition: all 0.3s ease;
        }

        /* 🔥【新增】时间日期样式变体 */

        /* 默认样式 (已有) */
        body[data-clock-style="default"] #main-time {
            font-size: 80px;
            font-weight: 200;
        }

        body[data-clock-style="default"] #main-date {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        /* 粗体样式 - 类似iPhone锁屏 */
        body[data-clock-style="bold"] #main-time {
            font-size: 84px;
            font-weight: 700;
            letter-spacing: -2px;
        }

        body[data-clock-style="bold"] #main-date {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }

        /* 紧凑样式 - 类似Android */
        body[data-clock-style="compact"] #main-time {
            font-size: 72px;
            font-weight: 300;
            line-height: 0.9;
        }

        body[data-clock-style="compact"] #main-date {
            font-size: 16px;
            font-weight: 400;
            margin-bottom: 6px;
            opacity: 0.9;
        }

        body[data-clock-style="compact"] #clock-container {
            margin-bottom: 40px;
        }

        /* 现代样式 - 类似小米MIUI */
        body[data-clock-style="modern"] #main-time {
            font-size: 88px;
            font-weight: 100;
            letter-spacing: -3px;
            line-height: 0.85;
        }

        body[data-clock-style="modern"] #main-date {
            font-size: 22px;
            font-weight: 300;
            margin-bottom: 12px;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        body[data-clock-style="modern"] #clock-container {
            margin-bottom: 60px;
        }

        /* 🔥【新增】时钟样式选择器样式 */
        .clock-style-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 10px;
            background: var(--theme-button-secondary-bg, rgba(255, 255, 255, 0.8));
            border: 1px solid var(--theme-button-secondary-border, rgba(0, 0, 0, 0.1));
            border-radius: var(--theme-input-radius, 15px);
            cursor: pointer;
            transition: all 0.2s ease;
            width: 80px;
            justify-content: space-between;
            flex-shrink: 0;
        }

        .clock-style-selector:hover {
            background: var(--theme-button-secondary-hover-bg, rgba(255, 255, 255, 0.9));
        }

        .clock-style-selector #current-clock-style-text {
            font-size: 13px;
            color: var(--theme-button-secondary-color, #555);
            white-space: nowrap;
            overflow: hidden;
        }

        .clock-style-selector #clock-style-arrow {
            font-size: 10px;
            color: var(--theme-button-secondary-color, #555);
            transition: transform 0.2s ease;
            flex-shrink: 0;
        }

        .clock-style-selector.open #clock-style-arrow {
            transform: rotate(180deg);
        }

        /* 🔥【新增】下拉菜单样式 */
        .clock-style-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            z-index: 1000;
            background: var(--theme-form-bg, rgba(255, 255, 255, 0.95));
            border: 1px solid var(--theme-input-border, rgba(0, 0, 0, 0.1));
            border-radius: var(--theme-input-radius, 15px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
            min-width: 200px;
            margin-top: 4px;
            overflow: hidden;
            animation: dropdownFadeIn 0.2s ease;
        }

        @keyframes dropdownFadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .clock-style-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border-bottom: 1px solid var(--theme-input-border, rgba(0, 0, 0, 0.05));
        }

        .clock-style-option:last-child {
            border-bottom: none;
        }

        .clock-style-option:hover {
            background: var(--theme-button-secondary-hover-bg, rgba(0, 123, 255, 0.05));
        }

        .clock-style-option i {
            font-size: 14px;
            color: #007bff;
            opacity: 0;
            transition: opacity 0.2s ease;
            width: 14px;
            flex-shrink: 0;
        }

        .clock-style-option.selected i {
            opacity: 1;
        }

        .clock-style-option span {
            font-size: 14px;
            font-weight: 500;
            color: var(--theme-text-color, #333);
            flex: 1;
        }

        .clock-style-option small {
            font-size: 12px;
            color: var(--theme-text-secondary, #666);
            display: block;
            margin-top: 2px;
        }

        /* 🔥【新增】移动端优化 */
        @media (max-width: 480px) {
            .clock-style-dropdown {
                right: -10px;
                left: -10px;
                min-width: auto;
            }

            .clock-style-option {
                padding: 14px 16px;
            }

            .clock-style-option span {
                font-size: 15px;
            }

            .clock-style-option small {
                font-size: 13px;
            }
        }

        /* 🔥【新增】主屏幕字体选择器样式 */
        .home-font-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 10px;
            background: var(--theme-button-secondary-bg, rgba(255, 255, 255, 0.8));
            border: 1px solid var(--theme-button-secondary-border, rgba(0, 0, 0, 0.1));
            border-radius: var(--theme-input-radius, 15px);
            cursor: pointer;
            transition: all 0.2s ease;
            width: 80px;
            justify-content: space-between;
            flex-shrink: 0;
        }

        .home-font-selector:hover {
            background: var(--theme-button-secondary-hover-bg, rgba(255, 255, 255, 0.9));
        }

        .home-font-selector #current-home-font-text {
            font-size: 13px;
            color: var(--theme-button-secondary-color, #555);
            white-space: nowrap;
            overflow: hidden;
        }

        .home-font-selector #home-font-arrow {
            font-size: 10px;
            color: var(--theme-button-secondary-color, #555);
            transition: transform 0.2s ease;
            flex-shrink: 0;
        }

        .home-font-selector.open #home-font-arrow {
            transform: rotate(180deg);
        }

        /* 🔥【新增】主屏幕字体下拉菜单样式 */
        .home-font-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            z-index: 1000;
            background: var(--theme-form-bg, rgba(255, 255, 255, 0.95));
            border: 1px solid var(--theme-input-border, rgba(0, 0, 0, 0.1));
            border-radius: var(--theme-input-radius, 15px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
            min-width: 160px;
            margin-top: 4px;
            overflow: hidden;
            animation: dropdownFadeIn 0.2s ease;
        }

        .home-font-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border-bottom: 1px solid var(--theme-input-border, rgba(0, 0, 0, 0.05));
        }

        .home-font-option:last-child {
            border-bottom: none;
        }

        .home-font-option:hover {
            background: var(--theme-button-secondary-hover-bg, rgba(0, 123, 255, 0.05));
        }

        .home-font-option i {
            font-size: 14px;
            color: #007bff;
            opacity: 0;
            transition: opacity 0.2s ease;
            width: 14px;
            flex-shrink: 0;
        }

        .home-font-option.selected i {
            opacity: 1;
        }

        .home-font-option span {
            font-size: 14px;
            font-weight: 500;
            color: var(--theme-text-color, #333);
            flex: 1;
        }

        .home-font-option small {
            font-size: 12px;
            color: var(--theme-text-secondary, #666);
            display: block;
            margin-top: 2px;
        }

        /* 🔥【新增】主屏幕字体移动端优化 */
        @media (max-width: 480px) {
            .home-font-dropdown {
                right: -10px;
                left: -10px;
                min-width: auto;
            }

            .home-font-option {
                padding: 14px 16px;
            }

            .home-font-option span {
                font-size: 15px;
            }

            .home-font-option small {
                font-size: 11px;
            }
        }
        

        
        /* 🔥【固定尺寸】主屏幕四块布局 - 使用固定尺寸防止变化 */
        #home-grid {
            position: absolute;
            top: 58%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: var(--fixed-home-grid-width) !important;
            height: var(--fixed-home-grid-width) !important; /* 固定正方形 */
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: var(--fixed-home-grid-gap) !important;
            margin-top: 0px;
        }

        /* 🔥【固定尺寸】主屏幕区块样式 */
        .home-section {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--fixed-home-section-radius) !important;
            padding: var(--fixed-home-section-padding) !important;
        }

        /* 🔥【固定尺寸】小组件样式 */
        .widget {
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: var(--fixed-widget-radius) !important;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .widget:hover {
            transform: scale(1.02);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        /* 图片小组件 */
        .photo-widget-content {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            border-radius: 16px;
        }

        .photo-placeholder {
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            position: absolute;
            z-index: 2;
        }

        .photo-placeholder i {
            font-size: 32px;
            margin-bottom: 8px;
            display: block;
            color: rgba(255, 255, 255, 0.5);
        }

        .photo-widget-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            border-radius: 16px;
            position: absolute;
            top: 0;
            left: 0;
        }

        /* 纪念日小组件 */
        .anniversary-widget-content {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 15px;
        }

        .anniversary-placeholder {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
        }

        .anniversary-placeholder i {
            font-size: 28px;
            margin-bottom: 8px;
            display: block;
            color: rgba(255, 255, 255, 0.5);
        }

        .anniversary-display {
            width: 100%;
        }

        /* 🔥【固定尺寸】纪念日名称 */
        .anniversary-name {
            font-size: var(--fixed-anniversary-name-size) !important;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 5px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
        }

        /* 🔥【固定尺寸】纪念日倒计时 */
        .anniversary-countdown {
            font-size: var(--fixed-anniversary-countdown-size) !important;
            font-weight: 900;
            color: white;
            margin: 8px 0;
            line-height: 1;
            text-shadow: 0 2px 6px rgba(0, 0, 0, 0.8);
        }

        /* 🔥【固定尺寸】纪念日日期 */
        .anniversary-date {
            font-size: var(--fixed-anniversary-date-size) !important;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 5px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* 右上角四个应用网格 */
        .apps-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 12px;
            width: 100%;
            height: 100%;
            padding: 10px;
        }

        /* 两个应用网格 */
        .apps-grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr;
            gap: 12px;
            width: 100%;
            height: 100%;
            align-items: center;
        }

        /* 🔥【固定尺寸】小应用样式 */
        .mini-app {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: white;
            text-shadow: var(--text-shadow-sm);
            font-size: var(--fixed-mini-app-text-size) !important;
            font-weight: 500;
            text-align: center;
            text-decoration: none;
            transition: transform 0.2s ease;
        }

        .mini-app:hover {
            transform: scale(1.05);
        }

        .mini-app:active {
            transform: scale(0.95);
        }

        /* 🔥【固定尺寸】小应用图标 */
        .mini-app-icon {
            width: var(--fixed-mini-app-icon-size) !important;
            height: var(--fixed-mini-app-icon-size) !important;
            border-radius: var(--fixed-mini-app-icon-radius) !important;
            background-color: transparent;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            margin-bottom: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s ease;
            overflow: hidden;
        }

        /* 🔥【固定尺寸】小应用图标字体 */
        .mini-app-icon i {
            font-size: var(--fixed-mini-app-font-size) !important;
            color: var(--color-gray-dark);
        }

        .mini-app-icon .app-icon-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* 🔥【固定尺寸】左下角大应用 */
        .large-app {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: white;
            text-shadow: var(--text-shadow-sm);
            font-size: var(--fixed-large-app-text-size) !important;
            font-weight: 500;
            text-align: center;
            text-decoration: none;
            width: 100%;
            height: 100%;
            transition: transform 0.2s ease;
        }

        .large-app:hover {
            transform: scale(1.02);
        }

        .large-app:active {
            transform: scale(0.98);
        }

        /* 🔥【固定尺寸】大应用图标 */
        .large-app-icon {
            width: var(--fixed-large-app-icon-size) !important;
            height: var(--fixed-large-app-icon-size) !important;
            border-radius: var(--fixed-large-app-icon-radius) !important;
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 28px;
            margin-bottom: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
            transition: transform 0.2s ease;
            color: white;
        }

        /* 🔥【固定尺寸】大应用图标字体 */
        .large-app-icon i {
            font-size: var(--fixed-large-app-font-size) !important;
            color: white;
        }
        
        .app {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            color: white;
            text-shadow: var(--text-shadow-sm);
            font-size: 14px;
            font-weight: 500;
            text-align: center;
            text-decoration: none;
        }
        
        .app-icon {
            width: 60px;
            height: 60px;
            border-radius: 18px;
            background-color: transparent;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 32px;
            margin-bottom: 8px;
            box-shadow: var(--shadow-lg);
            transition: transform 0.2s ease;
            overflow: hidden;
        }
        
        .app:active .app-icon {
            transform: scale(0.9);
        }
        
        .app-icon i {
            font-size: 30px;
            color: var(--color-gray-dark);
        }
        
        .app .label {
            color: white;
        }

        /* iPhone风格Dock栏样式 */
        #dock-bar {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 300px;
            z-index: 100;
        }

        .dock-container {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 12px 20px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* 🔥【固定尺寸】Dock应用样式 */
        .dock-app {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            color: white;
            text-shadow: var(--text-shadow-sm);
            font-size: var(--fixed-dock-app-text-size) !important;
            font-weight: 500;
            text-align: center;
            text-decoration: none;
            transition: transform 0.2s ease;
        }

        .dock-app:hover {
            transform: translateY(-2px);
        }

        .dock-app:active {
            transform: translateY(0) scale(0.95);
        }

        /* 🔥【固定尺寸】Dock应用图标 */
        .dock-app-icon {
            width: var(--fixed-dock-app-icon-size) !important;
            height: var(--fixed-dock-app-icon-size) !important;
            border-radius: var(--fixed-dock-app-icon-radius) !important;
            background-color: transparent;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            margin-bottom: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
            transition: transform 0.2s ease;
            overflow: hidden;
        }

        /* 🔥【固定尺寸】Dock应用图标字体 */
        .dock-app-icon i {
            font-size: var(--fixed-dock-app-font-size) !important;
            color: var(--color-gray-dark);
        }

        .dock-app-icon .app-icon-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* 应用页面样式 */
        .app-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            display: none;
            flex-direction: column;
            color: black;
        }
        
        /* 顶部容器 - 包含状态栏和应用栏 */
        .app-top-container {
            position: relative;
            z-index: 15;
            flex-shrink: 0;
        }

        /* 应用界面状态栏 */
        .app-status-bar {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            padding: 12px 24px 6px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: black;
            z-index: 1000;
            font-size: 14px;
            box-sizing: border-box;
            pointer-events: none;
            background: transparent;
            border-bottom: none;
        }
        
        .app-screen .app-status-time {
            font-weight: 600;
            display: flex;
            align-items: center;
            font-size: 14px;
        }

        .app-screen .app-status-time::after {
            content: var(--status-icon, "🐾");
            margin-left: 4px;
            font-size: 12px;
        }
        
        .app-battery-container {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 14px;
        }
        
        .app-battery-icon {
            width: 21px;
            height: 10px;
            border: 1px solid black;
            border-radius: 4px;
            position: relative;
            padding: 1px;
        }
        
        .app-battery-icon::after {
            content: '';
            position: absolute;
            right: -2px;
            top: 3.5px;
            width: 1.5px;
            height: 4px;
            background-color: black;
            border-radius: 0 1px 1px 0;
        }
        
        .app-battery-level {
            height: 100%;
            background-color: black;
            border-radius: 2px;
            transition: width 0.5s ease;
            width: 100%;
        }
        
        .app-battery-container.charging .app-battery-level {
            background-color: var(--color-green);
            animation: charge-breath 2s infinite;
        }
        
        .app-battery-container.charging .battery-text {
            color: var(--color-green);
        }

        /* AI心率显示样式 - 通用样式 */
        .ai-heartrate-display {
            font-size: 12px;
            color: #ff3366;
            display: none;
            z-index: 15;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        /* 中间位置的心率显示 */
        #ai-heartrate-display-center {
            position: absolute;
            top: 12px;
            left: 50%;
            transform: translateX(-50%);
        }

        /* 右侧位置的心率显示 */
        #ai-heartrate-display-right {
            margin-right: 1px;
            white-space: nowrap;
        }

        .ai-heartrate-display .heartrate-number {
            color: #000;
            font-weight: bold;
            font-size: 12px;
            transition: color 0.3s ease;
        }

        .ai-heartrate-display .heartrate-unit {
            color: #888;
            font-weight: normal;
            font-size: 12px;
        }

        /* 心率过高时的特殊效果 */
        .ai-heartrate-display.high-heartrate {
            animation: heartbeat-pulse 1s infinite;
        }

        .ai-heartrate-display.high-heartrate .heartrate-number {
            color: #ff3366;
        }

        .ai-heartrate-display.very-high-heartrate {
            animation: heartbeat-intense 0.6s infinite;
        }

        .ai-heartrate-display.very-high-heartrate .heartrate-number {
            color: #ff1144;
            font-weight: 900;
        }

        @keyframes heartbeat-pulse {
            0%, 100% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.05); }
        }

        @keyframes heartbeat-intense {
            0%, 100% { transform: translateX(-50%) scale(1); }
            25% { transform: translateX(-50%) scale(1.08); }
            75% { transform: translateX(-50%) scale(1.03); }
        }
        
        .app-header {
            position: relative;
            z-index: 15;
            flex-shrink: 0;
            padding: 12px 32px;
            padding-top: 45px;
            height: 80px;
            box-sizing: border-box;
            background-color: transparent; /* 改为透明 */
            /* 注释掉原来的背景样式 */
            /* background-color: var(--theme-header-bg); */
            /* backdrop-filter: var(--theme-header-backdrop); */
            /* -webkit-backdrop-filter: var(--theme-header-backdrop); */
            border-bottom: 1px solid var(--color-border); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            font-size: 18px; 
            font-weight: 600; 
            transition: var(--transition-normal);
            overflow: hidden; /* 防止内容溢出 */
        }

        .header {
            position: relative;
            z-index: 15;
            flex-shrink: 0;
            padding: 12px 32px;
            padding-top: 45px;
            height: 80px;
            box-sizing: border-box;
            background-color: var(--theme-header-bg); 
            backdrop-filter: var(--theme-header-backdrop); 
            -webkit-backdrop-filter: var(--theme-header-backdrop); 
            border-bottom: 1px solid var(--color-border); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            font-size: 18px; 
            font-weight: 600; 
            transition: var(--transition-normal);
            overflow: hidden;
        }

        /* 🔥【新增】专门为聊天界面的header容器添加状态显示支持 */
        #api-chat-screen .header {
            overflow: visible;
        }

        .app-title {
            font-weight: var(--theme-title-font-weight, bold);
            font-size: var(--theme-title-font-size, 18px);
            font-family: var(--theme-setting-title-font, var(--theme-font-family));
            text-align: center;
            flex: 1;
            color: var(--color-black);
            text-shadow: none;
            letter-spacing: var(--theme-title-letter-spacing, 0);
        }

        .header .header-actions { display: flex; align-items: center; gap: 10px; position: absolute; right: 20px; top: 70%; transform: translateY(-50%); }



        /* 记忆查看器左侧按钮组样式 */
        #memory-viewer-screen .header-left-actions {
            display: flex;
            align-items: center;
            gap: 4px;
            position: absolute;
            left: 50px; /* 在返回按钮右侧 */
            top: 42px;
        }


        .header .back-btn, .header .action-btn { font-size: 24px; cursor: pointer; width: 30px; text-align: center; color: #000000; display: flex; align-items: center; justify-content: center; background: none; border: none; padding: 0; }
        .header .action-btn#offline-mode-btn {
            font-size: 19px; 
        }
        .header .back-btn { position: absolute; left: 20px; }

        /* 🔥【修复】移动端返回按钮触摸区域修复 - 解决display:contents导致的定位问题 */
        @media (max-width: 768px) {
            .header .back-btn {
                /* 确保按钮有明确的定位上下文 */
                z-index: 10;
                /* 使用transform确保按钮在正确位置 */
                transform: translateX(0);
                /* 扩展最小触摸区域 */
                min-width: 44px;
                min-height: 44px;
                /* 使用box-sizing确保尺寸计算正确 */
                box-sizing: border-box;
            }
        }
        .header .header-title { text-align: center; flex: 1; color: #000000; }
        .header .action-btn img { height: 26px; }
        .header .save-btn { font-size: 16px; color: #000000; font-weight: 600; cursor: pointer; position: absolute; right: 20px; }
        
        .back-button {
            position: absolute !important;
            left: 20px !important;
            padding: 0;
            background: none;
            border: none;
            font-size: 24px;
            color: #000000;
            cursor: pointer;
            width: 30px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            /* 🔥【修复】防止返回按钮位置被其他样式影响，但保持自定义主题兼容性 */
            transform: none !important;
            right: auto !important;
            top: auto !important;
            bottom: auto !important;
            z-index: 20;
        }

        /* 🔥【增强】确保自定义主题的返回按钮样式优先级更高 */
        .custom-theme-applied[data-has-custom-global-back-button="true"] .back-button {
            background-image: var(--custom-global-back-button) !important;
            background-size: cover !important;
            background-position: center !important;
            background-repeat: no-repeat !important;
            color: transparent !important;
            /* 保持位置修复，但允许自定义主题的视觉样式 */
        }

        /* 🎮【修复】海龟汤游戏聊天消息样式 - 修复左右位置 */
        .game-chat-message {
            margin-bottom: 12px;
            display: flex;
            flex-direction: column;
        }

        /* 🔥【修复】用户消息在右边 */
        .game-chat-message.user-message {
            align-items: flex-end;
        }

        /* 🔥【修复】角色消息在左边 */
        .game-chat-message.character-message {
            align-items: flex-start;
        }

        .game-chat-sender {
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
            padding: 0 8px;
        }

        .game-chat-message.user-message .game-chat-sender {
            text-align: right;
        }

        .game-chat-message.character-message .game-chat-sender {
            text-align: left;
        }

        .game-chat-bubble {
            max-width: 80%;
            padding: 8px 12px;
            border-radius: 18px;
            word-wrap: break-word;
            line-height: 1.4;
        }

        /* 🔥【修复】用户消息气泡 - 蓝色，右边 */
        .game-chat-message.user-message .game-chat-bubble {
            background-color: #007bff;
            color: white;
            border-bottom-right-radius: 6px;
        }

        /* 🔥【修复】角色消息气泡 - 灰色，左边 */
        .game-chat-message.character-message .game-chat-bubble {
            background-color: #f1f3f4;
            color: #333;
            border-bottom-left-radius: 6px;
        }

        /* 🎮【新增】海龟汤DM消息区域样式优化 */
        .turtle-soup-dm-message {
            min-height: 60px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            border-left: 4px solid #4CAF50;
            font-size: 14px;
            line-height: 1.5;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        /* 🎮【修复】角色输入指示器样式 - 横向布局 */
        .character-typing-indicator {
            margin-bottom: 12px;
            animation: fadeIn 0.3s ease-in;
        }

        .character-typing-bubble {
            background-color: #f1f3f4;
            border-radius: 18px;
            border-bottom-left-radius: 6px;
            padding: 12px 16px;
            max-width: 80%;
            display: flex;
            align-items: center;
            gap: 4px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .typing-dots {
            display: flex;
            gap: 4px;
            align-items: center;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #999;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) {
            animation-delay: 0s;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingAnimation {
            0%, 60%, 100% {
                opacity: 0.3;
                transform: scale(0.8);
            }
            30% {
                opacity: 1;
                transform: scale(1.2);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 🔥【删除】不需要单独的sender样式，使用通用的game-chat-sender */

        /* 纪念日app添加按钮样式 */
        .add-anniversary-btn {
            position: absolute;
            right: 22px;
            top: 43px;
            width: 30px;
            height: 30px;
            background: none;
            border: none;
            font-size: 18px;
            color: #000000;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .add-anniversary-btn:hover {
            background: rgba(0, 0, 0, 0.05);
            transform: scale(1.1);
        }

        /* 记忆查看器设置按钮样式 - 参考纪念日app */
        .memory-settings-btn {
            position: absolute;
            right: 22px;
            top: 43px;
            width: 30px;
            height: 30px;
            background: none;
            border: none;
            font-size: 18px;
            color: #000000;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .memory-settings-btn:hover {
            background: rgba(0, 0, 0, 0.05);
            transform: scale(1.1);
        }

        /* 记忆查看器头部按钮组 */
        .memory-header-actions {
            position: absolute;
            right: 22px;
            top: 43px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* 添加核心记忆按钮样式 - 参考纪念日app */
        .add-core-memory-btn {
            width: 30px;
            height: 30px;
            background: none;
            border: none;
            font-size: 18px;
            color: #000000;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .add-core-memory-btn:hover {
            background: rgba(0, 0, 0, 0.05);
            transform: scale(1.1);
        }

        /* 调整记忆设置按钮，移除绝对定位 */
        .memory-header-actions .memory-settings-btn {
            position: static;
            right: auto;
            top: auto;
        }

        /* 🔥【新增】记忆编辑模态框优化样式 */
        #custom-prompt-modal .modal-content {
            animation: memoryEditSlideIn 0.3s ease-out;
        }

        #custom-prompt-modal textarea.form-input {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            min-height: 120px;
            max-height: 300px;
            transition: border-color 0.2s ease;
        }

        #custom-prompt-modal textarea.form-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.1);
        }

        @keyframes memoryEditSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }


        .app-content {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
        }

        /* 世界书应用特殊处理：移除内边距并修复高度 */
        #worldbook-screen .app-content {
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        /* 🎮【新增】五子棋游戏界面特殊处理：移除内边距并设置正确的高度 */
        #gomoku-game-screen .app-content {
            padding: 0;
            height: calc(100% - 84px); /* 减去状态栏和标题栏的高度 */
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }



/* 世界书来源标识样式 */
.worldbook-source-text {
    font-size: 11px;
    color: #007AFF;
    margin-top: 2px;
    background: rgba(0, 122, 255, 0.1);
    padding: 2px 6px;
    border-radius: 3px;
    display: inline-block;
}
        
        /* 设置应用样式 */
        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .settings-item:hover {
            background-color: rgba(0, 0, 0, 0.02);
            padding-left: 15px;
        }
        
        .settings-item-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .setting-label {
            font-weight: var(--theme-button-font-weight, 500);
            font-size: 16px;
            color: var(--theme-text-primary, #333);
            font-family: var(--theme-font-family);
            margin-bottom: 2px;
        }
        
        .setting-desc {
            font-size: 13px;
            color: #666;
            font-family: var(--theme-font-family);
        }
        
        .settings-icon {
            width: 30px;
            height: 30px;
            border-radius: 6px;
            background-color: var(--color-blue);
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            flex-shrink: 0;
        }
        
        .settings-icon.wifi { background-color: var(--color-blue); }
        .settings-icon.display { background-color: var(--color-blue); }
        .settings-icon.wallpaper { 
            background-color: var(--color-ios-green); 
            width: 30px !important;
            height: 30px !important;
            border-radius: 6px !important;
            display: flex !important;
            justify-content: center !important;
            align-items: center !important;
        }

        .settings-icon.about { background-color: var(--color-ios-gray); }
        .settings-icon.data-management { background-color: var(--color-blue); }
        .settings-icon.export { background-color: var(--color-green); }
        .settings-icon.import { background-color: var(--color-blue); }
        .settings-icon.cleanup { background-color: var(--color-orange); }
        .settings-icon.compress { background-color: var(--color-purple); }
        .settings-icon.danger { background-color: var(--color-red); }

        /* 数据管理专用样式 */
        .data-section {
            margin-bottom: 30px;
        }

        .data-section-title {
            font-size: 14px;
            font-weight: 600;
            color: #666;
            margin-bottom: 15px;
            padding: 0 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .storage-usage {
            background: white;
            border-radius: 12px;
            margin: 0 20px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .storage-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .storage-item:last-child {
            border-bottom: none;
        }

        .storage-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0 8px 0;
            border-top: 2px solid #007AFF;
            margin-top: 8px;
            font-weight: 600;
        }

        .storage-label {
            font-size: 15px;
            color: #333;
        }

        .storage-size {
            font-size: 14px;
            color: #666;
            font-weight: 500;
        }

        .storage-total .storage-size {
            color: #007AFF;
            font-weight: 600;
        }

        .danger-section .data-section-title {
            color: #dc3545;
        }

        .danger-item {
            background: var(--theme-form-bg, rgba(255, 255, 255, 0.95));
            border: 1px solid var(--theme-input-border, rgba(0, 0, 0, 0.1));
        }

        .danger-item:hover {
            background: var(--theme-button-secondary-hover-bg, rgba(0, 0, 0, 0.05));
        }


        
        /* 确保壁纸文字正常显示 */
        .settings-item-left div:not(.settings-icon) {
            white-space: nowrap;
        }
        
        /* 屏幕尺寸选择样式 */
        .size-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }
        
        .size-option:hover {
            background-color: rgba(0, 0, 0, 0.02);
            padding-left: 15px;
        }
        
        .size-option-left {
            flex: 1;
        }
        
        .size-name {
            font-weight: 600;
            font-size: 16px;
            color: #333;
            margin-bottom: 2px;
        }
        
        .size-desc {
            font-size: 13px;
            color: #666;
        }
        
        .size-preview {
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 70px;
        }
        
        .size-preview-rect {
            background-color: #333;
            border-radius: 3px;
            border: 1px solid #666;
        }
        
        .check-icon {
            color: var(--color-ios-green);
            font-size: 18px;
            position: absolute;
            right: 15px;
        }
        
        .settings-toggle {
            position: relative;
            width: 50px;
            height: 30px;
        }
        
        .settings-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .settings-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--color-border-gray);
            transition: .4s;
            border-radius: 34px;
        }
        
        .settings-slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .settings-slider {
            background-color: var(--color-ios-green);
        }
        
        input:checked + .settings-slider:before {
            transform: translateX(20px);
        }
        
        /* API设置界面 */
        .api-settings {
            padding: 15px;
        }
        
        .api-form-group {
            margin-bottom: 15px;
        }
        
        .api-form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .api-form-input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--color-border-medium);
            border-radius: 5px;
        }
        
        .api-form-select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--color-border-medium);
            border-radius: 5px;
        }
        
        .api-form-range {
            width: 100%;
        }
        
        .api-form-submit {
            background-color: var(--color-blue);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
        }
        
        /* 无线局域网设置 */
        .wifi-settings {
            padding: 15px;
        }
        
        .wifi-network {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }
        
        .wifi-network:last-child {
            border-bottom: none;
        }
        
        .wifi-network-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .wifi-icon {
            width: 24px;
            height: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .wifi-strength {
            display: flex;
            align-items: center;
            gap: 2px;
        }
        
        .wifi-strength-bar {
            width: 3px;
            height: 10px;
            background-color: var(--color-border-gray);
            border-radius: 1px;
        }
        
        .wifi-strength-bar.active {
            background-color: var(--color-blue);
        }
        
        /* 主题选择器样式 */
        .theme-option {
            display: flex;
            align-items: center;
            padding: 15px 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .theme-option:hover {
            background-color: var(--color-gray-bg);
        }
        
        .theme-option:last-child {
            border-bottom: none;
        }
        
        .theme-preview {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            margin-right: 15px;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-md);
        }
        
        .theme-preview-header {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 20px;
            background: var(--bg-white-30);
            backdrop-filter: blur(5px);
        }
        
        .theme-preview-content {
            position: absolute;
            bottom: 8px;
            left: 8px;
            right: 8px;
            height: 25px;
            background: var(--bg-white-50);
            border-radius: 4px;
        }
        
        .theme-info {
            flex: 1;
        }
        
        .theme-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
        }
        
        .theme-description {
            font-size: 13px;
            color: var(--color-gray);
        }
        
        /* 聊天对话框 */
        .chat-dialog {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            height: 100%;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            padding-bottom: 75px; /* 适中的距离，比原来的100px稍微近一点 */
        }
        
        .message-container {
            display: flex;
            margin-bottom: 10px;
            align-items: flex-start;
            position: relative;
        }
        
        .message-container.received {
            justify-content: flex-start;
            padding-left: 1px;
        }

        .message-container.sent {
            justify-content: flex-end;
            padding-right: 5px;
        }
        
        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: var(--color-border-medium);
            margin-right: 6px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            background-size: cover;
            background-position: center;
            flex-shrink: 0;
            position: relative;
            font-size: 14px;
            transition: border-radius 0.3s ease;
        }

        /* 方形圆角头像样式 */
        .message-avatar.rounded-square {
            border-radius: 12%;
        }

        /* 头像形状选择样式 - 简洁版 */
        .avatar-shape-options {
            display: flex;
            gap: 12px;
            margin-top: 10px;
        }

        .shape-radio-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 6px;
            border: 1px solid #ddd;
            background: #fff;
            transition: all 0.2s ease;
            user-select: none;
            flex: 1;
            justify-content: center;
        }

        .shape-radio-option:hover {
            border-color: #007AFF;
            background: rgba(0, 122, 255, 0.05);
        }

        .shape-radio-option.selected {
            border-color: #007AFF;
            background: rgba(0, 122, 255, 0.1);
            color: #007AFF;
        }

        .shape-radio-option input[type="radio"] {
            margin-right: 8px;
            accent-color: #007AFF;
        }

        .shape-radio-text {
            font-size: 14px;
            font-weight: 500;
            color: inherit;
        }

        /* 头像预览样式 */
        .avatar-preview-container .avatar-preview {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f0f2f5, #e8ebf0);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: #999;
            background-size: cover;
            background-position: center;
            transition: border-radius 0.3s ease;
        }

        /* 方形圆角预览头像样式 */
        .avatar-preview.rounded-square {
            border-radius: 12%;
        }

        /* 自定义CSS区域 */
        .custom-css-section {
            margin: 20px 0;
        }

        .custom-css-setting {
            margin-top: 10px;
        }

        .css-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        /* 预览区域样式 */
        .preview-section {
            margin: 20px 0;
        }

        .preview-container {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 10px;
            border: 1px solid #e9ecef;
        }

        .preview-messages {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-height: 300px;
            overflow-y: auto;
            overflow: visible !important; /* 🔥【修复】允许装饰元素溢出 */
        }

        /* 🔥【重要】预览气泡的基础样式 - 这些类在预览功能中被使用 */
        .ai-bubble {
            background-color: var(--ai-bubble-color, #f0f0f0);
            color: #333;
            border-radius: 18px;
        }

        .user-bubble {
            background-color: var(--my-bubble-color, #007AFF);
            color: white;
            border-radius: 18px;
        }
        
        /* 用户消息的头像设置左边距而不是右边距 */
        .message-container.sent .message-avatar {
            margin-right: 0;
            margin-left: 6px;
        }
        
        .message-bubble {
            max-width: 65%;
            padding: 8px 12px;
            border-radius: 16px;
            position: relative;
            min-width: 0;
            overflow-wrap: break-word;
            transition: all 0.2s ease;
            font-size: var(--global-font-size, 15px) !important;
            letter-spacing: var(--global-letter-spacing, 0px) !important;
        }
        
        /* ========== 气泡样式系统 ========== */
        
        /* 默认样式（经典圆角） */
        .bubble-style-default .message-bubble {
            border-radius: 18px;
            box-shadow: var(--shadow-sm);
            border: none;
            transition: all 0.2s ease;
        }
        

        
        /* 经典阴影样式 */
        .bubble-style-shadow .message-bubble {
            border-radius: 16px;
            box-shadow: 
                var(--shadow-lg),
                var(--shadow-md),
                var(--shadow-sm);
            border: none;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        
        .bubble-style-shadow .message-bubble:hover {
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.18),
                var(--shadow-lg),
                var(--shadow-md);
            transform: translateY(-2px);
        }
        
        /* 带尖角的经典气泡 */
        .bubble-style-tail .message-bubble {
            border-radius: 16px;
            position: relative;
            box-shadow: var(--shadow-md);
        }
        
        /* 角色消息的尖角（左上角） - 动态颜色通过JS设置 */
        .bubble-style-tail .received .message-bubble::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 8px;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 0 8px 10px 0;
            border-color: transparent var(--ai-bubble-color, var(--color-gray-light)) transparent transparent;
        }
        
        /* 用户消息的尖角（右上角） - 动态颜色通过JS设置 */
        .bubble-style-tail .sent .message-bubble::before {
            content: '';
            position: absolute;
            right: -6px;
            top: 8px;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 10px 8px 0 0;
            border-color: var(--my-bubble-color, #007AFF) transparent transparent transparent;
        }
        

        

        

        
        /* 纸张卡片样式 */
        .bubble-style-paper .message-bubble {
            border-radius: 6px;
            border: var(--paper-border);
            transition: all 0.3s ease;
            position: relative;
        }
        
        /* 纸张质感背景纹理 */
        .bubble-style-paper .message-container.received .message-bubble,
        .bubble-style-paper .received .message-bubble {
            position: relative;
            color: #2c2c2c;
            text-shadow: var(--paper-text-shadow);
        }
        
        /* 接收消息的气泡戳 */
        .bubble-style-paper .message-container.received .message-bubble::before,
        .bubble-style-paper .received .message-bubble::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 6px 8px 6px 0;
            border-color: transparent var(--ai-bubble-color, #f0f0f0) transparent transparent !important;
            z-index: 10;
        }
        
        .bubble-style-paper .message-container.received .message-bubble::after,
        .bubble-style-paper .received .message-bubble::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 20% 50%, rgba(120, 119, 118, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(120, 119, 118, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(139, 134, 128, 0.03) 0%, transparent 50%);
            border-radius: 6px;
            pointer-events: none;
            z-index: 0;
        }
        
        .bubble-style-paper .message-bubble > * {
            position: relative;
            z-index: 2;
        }
        
        .bubble-style-paper .message-container.sent .message-bubble,
        .bubble-style-paper .sent .message-bubble {
            position: relative;
            color: white;
            border-color: var(--border-white-15);
        }
        
        /* 发送消息的气泡戳 */
        .bubble-style-paper .message-container.sent .message-bubble::before,
        .bubble-style-paper .sent .message-bubble::before {
            content: '';
            position: absolute;
            right: -6px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 6px 0 6px 8px;
            border-color: transparent transparent transparent var(--my-bubble-color, #007AFF) !important;
            z-index: 10;
        }
        
        .bubble-style-paper .message-container.sent .message-bubble::after,
        .bubble-style-paper .sent .message-bubble::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.08) 0%, transparent 50%);
            border-radius: 6px;
            pointer-events: none;
            z-index: 0;
        }
        

        
        .bubble-style-paper .message-bubble:hover {
            transform: translateY(-1px) rotateX(1deg);
        }
        
        /* ========== 气泡样式选择器UI ========== */
        
        .bubble-style-section {
            margin-bottom: 25px;
        }
        
        .bubble-style-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        
        .bubble-style-option {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #fafafa;
            text-align: center;
        }
        
        .bubble-style-option:hover {
            border-color: var(--theme-button-bg, #4a84c1);
            background: var(--bg-default-05);
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }
        
        .bubble-style-option.selected {
            border-color: var(--theme-button-bg, #4a84c1);
            background: var(--bg-default-10);
            box-shadow: 0 4px 15px var(--bg-default-shadow);
        }
        
        .style-preview {
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: center;
        }
        
        .preview-bubble {
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 12px;
            max-width: 80px;
            text-align: center;
            word-break: break-word;
        }
        
        .sent-preview {
            background: #007AFF;
            color: white;
            align-self: flex-end;
        }
        
        .received-preview {
            background: #f0f0f0;
            color: #333;
            align-self: flex-start;
        }
        
        /* 预览气泡特殊样式 */
        
        .bubble-style-shadow .preview-bubble {
            box-shadow: var(--shadow-form-mixed), var(--shadow-sm);
            border-radius: 14px;
        }
        
        .bubble-style-tail .preview-bubble {
            position: relative;
        }
        
        .bubble-style-tail .sent-preview::before {
            content: '';
            position: absolute;
            right: -5px;
            top: 6px;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 8px 6px 0 0;
            border-color: var(--color-blue) transparent transparent transparent;
        }
        
        .bubble-style-tail .received-preview::before {
            content: '';
            position: absolute;
            left: -5px;
            top: 6px;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 0 6px 8px 0;
            border-color: transparent #f0f0f0 transparent transparent;
        }
        

        

        

        
        .bubble-style-paper .preview-bubble {
            border: var(--paper-border);
            border-radius: 6px;
            position: relative;
        }
        
        /* 预览气泡的气泡戳 */
        .bubble-style-paper .sent-preview::before {
            content: '';
            position: absolute;
            right: -4px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 4px 0 4px 5px;
            border-color: transparent transparent transparent var(--color-blue);
        }
        
        .bubble-style-paper .received-preview::before {
            content: '';
            position: absolute;
            left: -4px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 4px 5px 4px 0;
            border-color: transparent #f0f0f0 transparent transparent;
        }
        
        .bubble-style-paper .sent-preview {
            background: var(--color-blue);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .bubble-style-paper .received-preview {
            background: var(--color-gray-light);
            color: var(--color-gray-darker);
            text-shadow: 0 0.5px 1px rgba(255, 255, 255, 0.3);
        }
        
        .style-name {
            font-size: 13px;
            font-weight: 600;
            color: #666;
        }
        
        .bubble-style-option.selected .style-name {
            color: var(--theme-button-bg, #4a84c1);
        }

        /* 自定义CSS区域 */
        .custom-css-section {
            margin: 20px 0;
        }

        /* 预览区域样式 */
        .preview-section {
            margin: 20px 0;
        }

        .preview-container {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            position: relative;
            min-height: 120px;
        }

        .preview-chat {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .preview-msg {
            display: flex;
            align-items: flex-end;
            gap: 8px;
            position: relative;
            margin: 12px 0;
        }

        .preview-msg.ai-msg {
            justify-content: flex-start;
        }

        .preview-msg.user-msg {
            justify-content: flex-end;
        }

        .preview-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
            color: white;
            flex-shrink: 0;
        }

        .ai-msg .preview-avatar {
            background: #666;
        }

        .user-msg .preview-avatar {
            background: #007AFF;
        }

        .preview-bubble {
            max-width: 180px;
            padding: 8px 12px;
            border-radius: 16px;
            font-size: 13px;
            line-height: 1.4;
            word-wrap: break-word;
            position: relative; /* 🔥【修复】为装饰元素提供定位基准 */
            overflow: visible !important; /* 🔥【修复】允许装饰元素溢出 */
        }

        /* 🔥【移除重复定义】预览气泡样式已在上方定义 */
        
        .received .message-bubble {
            background-color: var(--color-gray-light);
            margin-left: 4px;
        }
        
        .sent .message-bubble {
            background-color: var(--color-blue);
            color: white;
            margin-right: 4px;
        }
        
        .message-image {
            max-width: 150px;  /* 从200px减小到150px */
            max-height: 150px;  /* 从200px减小到150px */
            border-radius: 10px;
            margin-top: 5px;
            cursor: pointer;
            transition: transform 0.2s ease;
            object-fit: cover;  /* 确保图片适应容器 */
        }
        
        .message-image:hover {
            transform: scale(1.05);
        }
        
        .message-emoji {
            max-width: 100px;  /* 从120px减小到100px */
            max-height: 100px;  /* 从120px减小到100px */
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        .message-emoji:hover {
            transform: scale(1.1);  /* 从1.05增加到1.1 */
        }
        
        /* 无气泡的表情包样式 */
        .message-container.emoji-only .message-bubble {
            background: none !important;
            box-shadow: none !important;
            border: none !important;
            padding: 0 !important;
        }
        
        /* 图片预览模态框 */
        .image-preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            cursor: zoom-out;
            padding: 20px;
            box-sizing: border-box;
        }

        .image-preview-modal img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            cursor: zoom-out;
            transition: transform 0.3s ease;
        }

        .image-preview-modal img:hover {
            transform: scale(1.02);
        }

        /* 移动设备优化 */
        @media (max-width: 768px) {
            .image-preview-modal {
                padding: 10px;
            }

            .image-preview-modal img {
                border-radius: 5px;
            }
        }
        
        /* 特殊消息类型样式 - 语音消息 */
        .voice-message {
            display: flex;
            align-items: center;
            padding: 3px 7px;
            border-radius: 13px;
            min-width: 49px;
            max-width: 99px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .voice-message:hover {
            transform: translateY(-1px);
        }

        .message-container.sent .voice-message {
            flex-direction: row-reverse;
        }

        /* 波形动画容器 */
        .voice-wave {
            display: flex;
            align-items: center;
            height: 13px;
            gap: 1px;
            flex-grow: 1;
            margin: 0 3px;
        }

        .voice-wave .wave-bar {
            width: 2px;
            background-color: currentColor;
            border-radius: 1px;
            animation: wave-quiet 1.5s ease-in-out infinite;
        }

        @keyframes wave-quiet {
            0%, 100% {
                height: 2px;
            }
            50% {
                height: 6px;
            }
        }

        .voice-wave .wave-bar:nth-child(2) { animation-delay: 0.2s; }
        .voice-wave .wave-bar:nth-child(3) { animation-delay: 0.4s; }
        .voice-wave .wave-bar:nth-child(4) { animation-delay: 0.6s; }
        .voice-wave .wave-bar:nth-child(5) { animation-delay: 0.8s; }

        .voice-duration {
            font-size: 10px;
            font-weight: 500;
            color: var(--color-text-secondary);
            white-space: nowrap;
        }

        /* 🔥【修复】用户发送的语音时长 - 根据气泡颜色自动适配 */
        .message-container.sent .voice-duration {
            color: rgba(0, 0, 0, 0.7); /* 深色文字，适合浅色气泡 */
        }

        /* AI接收的语音时长 - 保持原样 */
        .message-container.received .voice-duration {
            color: var(--color-text-secondary);
        }

        /* 🔥【新增】当用户使用深色主题或深色气泡时的适配 */
        .message-container.sent.dark-bubble .voice-duration,
        .dark-theme .message-container.sent .voice-duration {
            color: rgba(255, 255, 255, 0.8); /* 浅色文字，适合深色气泡 */
        }



        /* 语音消息容器 */
        .voice-message-container {
            width: 100%;
            display: flex;
            flex-direction: column;
        }

        /* 用户语音消息容器右对齐 */
        .voice-message-container.sent {
            align-self: flex-end;
            align-items: flex-end;
        }

        /* AI语音消息容器左对齐 */
        .voice-message-container.received {
            align-self: flex-start;
            align-items: flex-start;
        }

        /* 语音内容展开样式 */
        .voice-text-content {
            display: none;
            margin-top: 3px;
            padding: 5px 9px;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 11px;
            font-size: 12px;
            line-height: 1.4;
            color: #333;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            word-break: break-word;
            width: fit-content;
            max-width: 145px;
            animation: voiceTextFadeIn 0.3s ease-in-out;
            border: 1px solid rgba(0,0,0,0.06);
            position: relative;
        }

        /* AI语音文字气泡左对齐 - 跟随received消息的对齐方式 */
        .voice-message-container.received .voice-text-content {
            align-self: flex-start;
            margin-left: 0;
            margin-right: auto;
        }

        /* 用户语音文字气泡右对齐 - 跟随sent消息的对齐方式 */
        .voice-message-container.sent .voice-text-content {
            align-self: flex-end;
            margin-left: auto;
            margin-right: 0;
        }

        .voice-text-content.visible {
            display: block;
        }

        @keyframes voiceTextFadeIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 录音按钮激活状态 */
        .tool-btn-mini.recording {
            background-color: var(--theme-button-bg, #4a84c1) !important;
            color: var(--theme-button-color, white) !important;
            border-color: var(--theme-button-bg, #4a84c1) !important;
            box-shadow: 0 0 0 2px var(--theme-button-shadow-color, rgba(74, 132, 193, 0.3));
        }
        
        /* 系统消息样式 */
        .system-message {
            text-align: center;
            color: var(--color-gray-medium);
            font-size: var(--font-size-sm);
            padding: 4px 8px;
            margin: 0;
            background: transparent;
            border: none;
            display: inline-block;
            max-width: 80%;
            width: fit-content;
        }

        /* 撤回消息样式 */
        .recalled-message {
            text-align: center;
            color: #999;
            font-size: 12px;
            margin: 5px 0;
            padding: 4px 8px;
            width: fit-content;
            max-width: 80%;
            background: transparent;
            border: none;
            animation: recallFadeIn 0.5s ease-in-out;
            position: relative; /* 🔥【修复】为选中标记提供定位基准 */
        }
        
        .recalled-message .original-text {
            color: #999;
            font-size: 11px;
            margin-top: 4px;
            padding-top: 4px;
        }
        
        /* 🔥【新增】撤回消息选中状态 - 显示勾选标记 */
        [data-message-id].selected .recalled-message::after {
            content: '✔';
            position: absolute;
            right: -25px;
            top: 50%;
            transform: translateY(-50%);
            background-color: var(--theme-button-bg, #4a84c1);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        /* 撤回消息包装器 */
        .message-wrapper.system {
            display: flex;
            justify-content: center;
            width: 100%;
            margin: 5px 0;
        }

        /* 撤回动画 */
        @keyframes recallFadeIn {
            0% { opacity: 0; transform: translateY(-10px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeOut {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(10px); }
        }
        
        /* 🔥【重新设计】消息上方按钮条样式 - 白底黑字 */
        .message-action-bar {
            position: absolute;
            top: -45px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 22px;
            padding: 8px 16px;
            display: flex;
            align-items: center;
            gap: 20px;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            white-space: nowrap;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .message-action-bar.show {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-5px);
        }

        .message-action-btn {
            color: #333;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 12px;
            transition: all 0.2s ease;
            background: transparent;
            border: none;
            min-width: 40px;
            text-align: center;
        }

        .message-action-btn:hover {
            background: rgba(0, 0, 0, 0.1);
            transform: scale(1.05);
        }

        .message-action-btn:active {
            transform: scale(0.95);
        }
        
        /* 🔥【新增】消息容器相对定位，用于放置按钮条 */
        .message-container {
            position: relative;
            /* 🔥【修复】减少对触摸事件的干扰，保留必要的禁用设置 */
            -webkit-tap-highlight-color: transparent;
            /* 🔥【修复】只在非交互元素上禁用选择 */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            /* 🔥【修复】允许触摸事件正常传播 */
            touch-action: manipulation;
        }

        /* 🔥【统一样式】所有主题下按钮条都保持白底黑字 */

        /* 🔥【新增】记忆查看器中的操作按钮样式 */
        .memory-action-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 6px;
            padding: 6px 8px;
            margin: 0 3px;
            cursor: pointer;
            font-size: 12px;
            color: #333;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 28px;
            height: 28px;
        }

        .memory-action-btn:hover {
            background: rgba(0, 123, 255, 0.1);
            border-color: rgba(0, 123, 255, 0.3);
            color: #007bff;
            transform: scale(1.05);
        }

        .memory-action-btn.edit-btn:hover {
            background: rgba(40, 167, 69, 0.1);
            border-color: rgba(40, 167, 69, 0.3);
            color: #28a745;
        }

        .memory-action-btn.view-btn:hover {
            background: rgba(23, 162, 184, 0.1);
            border-color: rgba(23, 162, 184, 0.3);
            color: #17a2b8;
        }

        .memory-action-btn i {
            font-size: 11px;
        }

        /* 🔥【新增】剧情总结记忆项的特殊样式 */
        .memory-item-type.storyline {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .memory-item[data-memory-type="storyline"] {
            border-left: 4px solid #667eea;
        }

        .memory-item[data-memory-type="storyline"] .memory-item-content {
            background: rgba(102, 126, 234, 0.05);
            border-radius: 6px;
            padding: 12px;
            margin: 8px 0;
            max-height: 80px;
            overflow: hidden;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            line-clamp: 3;
        }



        /* 电话通话界面样式 */
        .call-background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, #2c3e50, #34495e);
    z-index: 0;
    opacity: 0.95;
}

/* 修复顶部状态栏 */
#phone-call-screen .app-status-bar,
#incoming-call-screen .app-status-bar {
    background: transparent;
    color: white;
    z-index: 10;
    position: relative;
}

        .call-background.incoming {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }

        .call-content {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            padding: 20px;
            padding-top: 60px;
        }

        .incoming-call-content {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            padding: 20px;
            padding-top: 60px;
            justify-content: space-between;
        }

        .call-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
        }

        /* 🔥【新增】视频来电等待接听界面头部内容位置调整 */
        #incoming-video-call-screen .call-header {
            margin-top: 40px;
            margin-bottom: 40px;
        }

        .call-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    overflow: hidden;
    margin-bottom: 15px;
    border: 2px solid rgba(255, 255, 255, 0.5);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    background-color: #f0f0f0;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    z-index: 5;
    animation: breathe 3s ease-in-out infinite;
}

        @keyframes breathe {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            }
            50% { 
                transform: scale(1.03); 
                box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
            }
        }

.call-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
}

        .call-avatar.large-avatar {
            width: 100px;
            height: 100px;
            margin-bottom: 20px;
        }

        .call-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .call-name {
            color: white;
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .call-status {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            margin-bottom: 5px;
        }

        .call-time {
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
        }

        .call-text {
            color: rgba(255, 255, 255, 0.8);
            font-size: 16px;
            margin-top: 10px;
            text-align: center;
            max-width: 80%;
            align-self: center;
        }

        /* 等待接听页面的特殊样式 - 深灰色字体 */
        #incoming-call-screen .call-name {
            color: #666666;
        }

        #incoming-call-screen .call-status {
            color: #777777;
        }

        #incoming-call-screen .call-text {
            color: #777777;
        }

        .call-message-container {
            flex: 1;
            overflow-y: auto;
            padding: 10px 20px;
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
            max-height: 40vh; /* 限制最大高度为视口高度的40% */
            min-height: 150px; /* 确保最小显示高度 */
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE/Edge */
        }

        .call-message-container::-webkit-scrollbar {
            display: none; /* Chrome/Safari */
        }

        .call-message {
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            padding: 8px 14px;
            margin: 6px 0;
            color: white;
            max-width: 85%;
            align-self: center; /* 居中显示 */
            word-break: break-word;
            animation: messageSlideIn 0.5s ease-out;
            text-align: center; /* 文字居中 */
            font-size: 14px;
            line-height: 1.3;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        .call-message.sent {
            background-color: rgba(52, 152, 219, 0.4);
            align-self: center; /* 也居中显示 */
        }

        .call-message.received {
            background-color: rgba(255, 255, 255, 0.15);
            align-self: center; /* 也居中显示 */
        }

        /* AI正在说话的指示器 */
        .call-typing-indicator {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 12px 18px;
            margin: 8px 0;
            color: white;
            align-self: center;
            text-align: center;
            animation: messageSlideIn 0.3s ease-out;
        }

        .call-typing-dots {
            display: inline-flex;
            gap: 4px;
            align-items: center;
        }

        .call-typing-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.7);
            animation: callTypingPulse 1.4s infinite ease-in-out;
        }

        .call-typing-dot:nth-child(1) {
            animation-delay: 0s;
        }

        .call-typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .call-typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes callTypingPulse {
            0%, 80%, 100% {
                opacity: 0.3;
                transform: scale(0.8);
            }
            40% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .call-input-area {
    display: flex;
    background-color: rgba(255, 255, 255, 0.1);
    border-radius: 20px;
    padding: 5px;
    margin-bottom: 15px;
    position: relative;
    z-index: 10;
}

.call-text-input {
    flex: 1;
    background: transparent !important;
    background-color: transparent !important;
    border: none !important;
    color: white !important;
    padding: 10px 15px;
    font-size: 16px;
    outline: none !important;
    -webkit-appearance: none !important;
    appearance: none !important;
    box-shadow: none !important;
}

/* 防止输入框在iOS和Android上的默认样式 */
input.call-text-input,
textarea.call-text-input {
    -webkit-appearance: none !important;
    appearance: none !important;
    background-color: transparent !important;
    background: transparent !important;
}

.call-text-input::placeholder {
    color: rgba(255, 255, 255, 0.5);
}

.call-text-input:focus {
    background: transparent !important;
    background-color: transparent !important;
    color: white !important;
    outline: none !important;
    box-shadow: none !important;
    border: none !important;
    -webkit-appearance: none !important;
    appearance: none !important;
}

.call-text-input:focus-visible {
    background: transparent !important;
    background-color: transparent !important;
    outline: none !important;
    box-shadow: none !important;
}

/* 强制覆盖输入框样式 */
.call-input-area input, 
.call-input-area textarea,
.call-input-area .call-text-input {
    background: transparent !important;
    background-color: transparent !important;
    color: white !important;
    border: none !important;
    box-shadow: none !important;
    -webkit-appearance: none !important;
    appearance: none !important;
}

        /* 防止自动填充背景色 */
        .call-text-input:-webkit-autofill,
        .call-text-input:-webkit-autofill:hover,
        .call-text-input:-webkit-autofill:focus,
        .call-text-input:-webkit-autofill:active {
            -webkit-box-shadow: 0 0 0 30px transparent inset !important;
            -webkit-text-fill-color: white !important;
            background: transparent !important;
            background-color: transparent !important;
            transition: background-color 5000s ease-in-out 0s;
        }

        /* 更强力的输入框样式覆盖 */
        #call-input,
        input#call-input,
        .call-text-input,
        input.call-text-input {
            background: transparent !important;
            background-color: transparent !important;
            color: white !important;
            border: none !important;
            outline: none !important;
            box-shadow: none !important;
            -webkit-appearance: none !important;
            appearance: none !important;
        }

        #call-input:focus,
        input#call-input:focus,
        .call-text-input:focus,
        input.call-text-input:focus {
            background: transparent !important;
            background-color: transparent !important;
            color: white !important;
            border: none !important;
            outline: none !important;
            box-shadow: none !important;
        }

        .call-send-btn {
            background: transparent;
            border: none;
            color: white;
            width: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.2s ease;
        }

        .call-send-btn:hover {
            color: #3498db;
        }

        .call-controls {
            display: flex;
            justify-content: center;
        }

        .call-control-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
            font-size: 24px;
            transition: all 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .end-call-btn {
    background-color: #FF3B30;
    color: white;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    box-shadow: 0 4px 8px rgba(255, 59, 48, 0.4);
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    transition: all 0.2s ease;
    position: relative;
    border: none;
    cursor: pointer;
}

        .speaker-btn {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .speaker-btn.active {
            background-color: #2ecc71;
            color: white;
        }

        .call-control-btn:hover {
            transform: scale(1.1);
        }

        .call-control-btn:active {
            transform: scale(0.95);
        }

        .incoming-call-controls {
            display: flex;
            justify-content: space-around;
            padding: 0 20px;
            margin-bottom: 40px;
        }

        .incoming-call-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: transparent;
            border: none;
            cursor: pointer;
        }

        .call-btn-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            margin-bottom: 10px;
            transition: all 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        /* 🔥【新增】视频来电等待接听界面按钮样式调整 */
        #incoming-video-call-screen .call-btn-icon {
            width: 60px;
            height: 60px;
            font-size: 24px;
            margin-bottom: 8px;
        }

        .reject-btn .call-btn-icon {
            background-color: #e74c3c;
            color: white;
        }

        .accept-btn .call-btn-icon {
            background-color: #2ecc71;
            color: white;
        }

        .call-btn-text {
            color: white;
            font-size: 16px;
        }

        /* 等待接听页面的按钮文字颜色 */
        #incoming-call-screen .call-btn-text {
            color: #666666;
        }

        .incoming-call-btn:hover .call-btn-icon {
            transform: scale(1.1);
        }

        .incoming-call-btn:active .call-btn-icon {
            transform: scale(0.95);
        }

        @keyframes ringing {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        .ringing-animation {
            /* 移除晃动动画，使用呼吸效果 */
            animation: breathe 3s ease-in-out infinite;
        }

        /* 通话记录消息样式 */
        .call-record-message {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background-color: rgba(0, 0, 0, 0.03);
            border-radius: 12px;
            margin: 5px 0;
            font-style: italic;
            color: #666;
            font-size: 13px;
        }

        .call-record-message i {
            margin-right: 10px;
            font-size: 18px;
            color: #888;
        }

        .call-record-message.missed i {
            color: #e74c3c;
        }

        .call-record-message.ringing i {
            color: #2ecc71;
        }

        .call-record-message.completed i {
            color: #888;
        }

        .call-record-duration {
            margin-left: auto;
            font-size: 12px;
            color: #888;
            padding-left: 8px;
        }
        
        .ai-image-container {
            max-width: 200px;
        }
        
        .ai-image-container .message-image {
            width: 100%;
            border-radius: 8px;
            margin-bottom: 5px;
        }
        
        .image-description {
            font-size: 12px;
            opacity: 0.8;
            padding: 5px 0;
            line-height: 1.3;
        }
        
        .transfer-message {
            display: flex;
            align-items: center;
            padding: 15px;
            background: var(--gradient-pink);
            border-radius: 12px;
            min-width: 150px;
            box-shadow: var(--shadow-md);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .transfer-message:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-hover);
        }
        
        .transfer-message i {
            font-size: 20px;
            margin-right: 12px;
            background: var(--bg-white-30);
            padding: 8px;
            border-radius: 50%;
        }
        
        .transfer-content {
            flex: 1;
        }
        
        .transfer-amount {
            font-size: 18px;
            font-weight: bold;
            color: var(--color-gray-dark);
            margin-bottom: 2px;
        }
        
        .transfer-note {
            font-size: 12px;
            color: var(--color-gray);
        }
        
        /* 正在输入提示 */
        .typing-indicator {
            text-align: center;
            padding: 8px 20px;
            margin: 5px 0;
            color: #666;
            font-size: 14px;
            font-weight: normal;
            font-style: normal;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            position: absolute;
            bottom: 70px;
            left: 0;
            right: 0;
        }

        .typing-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }

        .typing-indicator .dots {
            display: inline-block;
        }

        .typing-indicator .dots::before {
            content: '...';
            font-size: 14px;
            color: #666;
            font-weight: normal;
            font-style: normal;
        }

        .typing-indicator .dots::after {
            content: '';
        }

        .typing-indicator .dot3 {
            display: none;
        }
        
        /* 查看历史消息按钮 */
        .load-more-messages {
            text-align: center;
            padding: 15px 20px;
            margin: 10px 20px;
            background: var(--bg-white-90);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--border-black-05);
            box-shadow: var(--shadow-md);
        }
        
        .load-more-messages:hover {
            background: var(--bg-white-95);
            transform: translateY(-1px);
            box-shadow: var(--shadow-hover);
        }
        
        .load-more-content {
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--color-gray);
            font-size: 14px;
            font-weight: 500;
        }
        
        .load-more-content i {
            margin-right: 8px;
            font-size: 12px;
            opacity: 0.7;
        }
        
        /* 消息引用样式 */
        .reply-reference {
            margin-bottom: 6px;
            padding: 6px 10px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 6px;
            border-left: 2px solid #007AFF;
            font-size: 12px;
            position: relative;
            max-width: 85%; /* 限制最大宽度，防止超出屏幕 */
        }

        .reply-reference-line {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #007AFF;
            border-radius: 1px 0 0 1px;
        }

        .reply-reference-content {
            padding-left: 6px;
        }

        .reply-reference-sender {
            font-weight: 600;
            color: #007AFF;
            margin-bottom: 1px;
            font-size: 11px;
        }

        .reply-reference-message {
            color: #666;
            line-height: 1.2;
            word-break: break-word;
            font-size: 11px;
        }

        /* 发送消息中的引用样式（用户消息） */
        .message-container.sent .reply-reference {
            background: rgba(255, 255, 255, 0.2);
            border-left-color: rgba(255, 255, 255, 0.8);
        }

        .message-container.sent .reply-reference-line {
            background: rgba(255, 255, 255, 0.8);
        }

        .message-container.sent .reply-reference-sender {
            color: rgba(0, 0, 0, 0.8); /* 改为深色，与消息内容一致 */
        }

        .message-container.sent .reply-reference-message {
            color: rgba(0, 0, 0, 0.7); /* 🔥【修复】改为深色文字，更清楚 */
        }

        /* 🔥【新增】接收消息中的引用样式改进 */
        .message-container.received .reply-reference {
            background: rgba(255, 255, 255, 0.2); /* 🔥【修复】改为白色半透明背景 */
            border-left-color: rgba(255, 255, 255, 0.8); /* 🔥【修复】改为白色边框 */
        }

        .message-container.received .reply-reference-line {
            background: rgba(255, 255, 255, 0.8); /* 🔥【修复】改为白色线条 */
        }

        .message-container.received .reply-reference-sender {
            color: rgba(0, 0, 0, 0.8); /* 🔥【修复】改为深色发送者名字 */
        }

        .message-container.received .reply-reference-message {
            color: rgba(0, 0, 0, 0.7); /* 🔥【修复】改为深色消息内容 */
        }

        /* 引用预览样式（输入时显示） */
        .reply-preview {
            position: relative;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 8px 12px;
            margin-bottom: 6px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            animation: slideInUp 0.3s ease-out;
            z-index: 101;
            max-width: 90%; /* 限制最大宽度 */
        }

        .reply-preview-content {
            display: flex;
            align-items: flex-start;
            position: relative;
        }

        .reply-preview-line {
            width: 2px;
            height: 100%;
            background: #007AFF;
            border-radius: 1px;
            margin-right: 8px;
            flex-shrink: 0;
        }

        .reply-preview-text {
            flex: 1;
            min-width: 0;
        }

        .reply-preview-sender {
            font-weight: 600;
            color: #666;
            margin-bottom: 2px;
            font-size: 11px;
        }

        .reply-preview-message {
            color: #666;
            font-size: 12px;
            line-height: 1.2;
            word-break: break-word;
        }

        .reply-preview-close {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 16px;
            height: 16px;
            border: none;
            background: #999;
            color: white;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .reply-preview-close:hover {
            background: #666;
            transform: scale(1.05);
        }

        /* 深色主题支持 */
        body[data-theme="cute"] .reply-reference {
            background: rgba(255, 192, 203, 0.1);
            border-left-color: #ff69b4;
        }

        body[data-theme="cute"] .reply-reference-line {
            background: #ff69b4;
        }

        body[data-theme="cute"] .reply-reference-sender {
            color: #ff69b4;
        }

        body[data-theme="cute"] .reply-preview {
            background: rgba(255, 240, 245, 0.95);
            border-color: rgba(255, 105, 180, 0.3);
        }

        body[data-theme="cute"] .reply-preview-line {
            background: #ff69b4;
        }

        body[data-theme="cute"] .reply-preview-sender {
            color: #ff69b4;
        }

        /* 动画效果 */
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* 时间戳样式 */
        .timestamp {
            color: var(--color-gray-medium);
            font-size: 11px;
            margin: 2px 0;
            line-height: 1.2;
        }
        
        .timestamp-center {
            text-align: center;
            padding: 8px 0;
            margin: 5px 20px;
        }
        
        .timestamp-bubble {
            position: absolute;
            bottom: 0px;
            right: -40px; /* 🔥【修复】保持原有距离 */
            font-size: 10px;
            color: #999;
            white-space: nowrap;
            z-index: 1;
            pointer-events: none;
            /* 🔥【简化修复】确保时间戳不会超出视口 */
            max-width: 60px;
            text-align: right;
        }

        .message-container.sent .timestamp-bubble {
            right: auto;
            left: -40px; /* 🔥【修复】用户消息保持原有距离 */
            text-align: left;
        }

        /* 🔥【简化修复】在小屏幕上进一步调整时间戳位置 */
        @media (max-width: 480px) {
            .timestamp-bubble {
                right: -30px;
                max-width: 50px;
                font-size: 9px;
            }

            .message-container.sent .timestamp-bubble {
                left: -30px;
            }
        }
        
        .timestamp-avatar {
            position: absolute;
            top: 36px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: var(--color-gray-medium);
            white-space: nowrap;
            width: max-content;
        }

        /* 🔥【新增】当时间戳在头像下方时，增加消息容器的底部间距 */
        .message-container:has(.timestamp-avatar) {
            margin-bottom: 20px !important; /* 增加底部间距，为时间戳留出空间 */
        }

        /* 🔥【备用方案】如果浏览器不支持:has选择器，使用类名方式 */
        .message-container.has-avatar-timestamp {
            margin-bottom: 20px !important;
        }

        .timestamp-inside {
            display: inline-block;
            margin-left: 6px;
            font-size: 10px; /* 🔥【修复】增加字体大小，与气泡外时间戳保持一致 */
            color: var(--text-black-50); /* 🔥【修复】默认使用深色，与AI消息保持一致 */
            white-space: nowrap;
            vertical-align: baseline;
            pointer-events: none;
            line-height: 1;
        }

        .message-container.received .timestamp-inside {
            color: var(--text-black-50); /* AI消息保持深色 */
        }

        /* 🔥【新增】用户消息的气泡内时间戳也使用深色，保持一致 */
        .message-container.sent .timestamp-inside {
            color: var(--text-black-50) !important; /* 强制使用深色，避免白色看不清 */
        }

        /* 隐藏头像时的样式调整 */
        .message-container.no-avatar .message-bubble {
            margin-left: 0;
            margin-right: 0;
        }
        
        .message-container.no-avatar.sent .message-bubble {
            margin-left: 0;
        }
        
        .message-container.no-avatar.received .message-bubble {
            margin-right: 0;
        }
        
        .chat-input-area {
            background-color: var(--bg-header-default);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-top: 1px solid var(--color-gray-border);
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 100;
            box-sizing: border-box;
            padding: 8px;
        }
        
        .sender-name {
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
            margin-left: 60px;
            font-weight: normal;
        }
        
        /* 展开工具面板样式 */
        .tools-panel {
            background: var(--bg-white-95);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            margin: 0 8px 8px 8px;
            padding: 16px;
            box-shadow: var(--shadow-lg);
            animation: toolsPanelSlideUp 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }
        
        .tool-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px 8px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            background: transparent;
            position: relative;
            overflow: hidden;
        }
        
        .tool-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-white-50);
            opacity: 0;
            transition: opacity 0.3s ease;
            border-radius: 12px;
        }
        
        .tool-item:hover::before {
            opacity: 1;
        }
        
        .tool-item:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: var(--shadow-hover);
        }
        
        .tool-item:active {
            transform: translateY(-2px) scale(1.02);
            transition: all 0.1s ease;
        }
        
        .tool-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--theme-button-bg-rgba);
            color: var(--theme-button-color, white);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 6px;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-button);
            position: relative;
            z-index: 2;
        }
        
        .tool-item:hover .tool-icon {
            transform: scale(1.1);
            box-shadow: var(--shadow-hover);
        }
        
        .tool-label {
            font-size: 11px;
            font-weight: 500;
            color: var(--theme-text-primary, #333);
            text-align: center;
            line-height: 1.2;
            position: relative;
            z-index: 2;
            font-family: var(--theme-font-family);
        }
        
        /* 工具面板展开动画 */
        @keyframes toolsPanelSlideUp {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        

        
        .tool-btn-mini {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--bg-white-80);
            border: 1px solid var(--border-black-05);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        
        .tool-btn-mini:hover {
            background: var(--bg-white-95);
            border-color: var(--border-black-05);
            transform: scale(1.1);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
        }
        
        .tool-btn-mini:active {
            transform: scale(0.95);
        }
        
        .tool-btn-mini i {
            font-size: 13px;
            color: var(--color-gray);
            transition: color 0.2s ease;
        }
        
        .tool-btn-mini:hover i {
            color: var(--color-gray-darker);
        }
        
        /* 输入控制区域 */
        .input-controls {
            display: flex;
            gap: 6px;
            align-items: center;
        }
        
        .chat-input {
            width: 100%;
            padding: 10px 12px;
            border: none;
            border-radius: 18px;
            background-color: var(--color-white);
            font-size: 16px;
            resize: none;
            max-height: 100px;
            outline: none;
            box-shadow: var(--text-shadow-light);
            box-sizing: border-box;
        }
        
        .send-button {
            height: 40px;
            padding: 0 12px;
            border-radius: 20px;
            background-color: var(--theme-button-bg, rgb(74, 132, 193));
            color: var(--theme-button-color, white);
            display: flex;
            justify-content: center;
            align-items: center;
            border: var(--theme-button-border, none);
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: var(--theme-button-shadow, var(--shadow-md));
            transition: all 0.2s ease;
            border-radius: var(--theme-button-radius, 20px);
            flex-shrink: 0;
            min-width: 50px;
        }
        
        .send-button:hover {
            background-color: var(--theme-button-bg-hover, rgba(72, 125, 178, 0.95));
            transform: translateY(-1px);
            box-shadow: var(--shadow-hover);
        }
        
        .chat-action-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--bg-white-80);
            color: var(--color-gray);
            display: flex;
            justify-content: center;
            align-items: center;
            border: none;
            cursor: pointer;
            font-size: 18px;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid var(--border-black-05);
            transition: all 0.2s ease;
            flex-shrink: 0;
        }
        
        .chat-action-btn:hover {
            background-color: var(--bg-white-95);
            transform: scale(1.1);
        }
        
        /* 聊天界面 */
        #chat-screen {
            display: none;
            flex-direction: column;
        }
        
        .chat-tabs {
            display: flex;
            justify-content: space-around;
            padding: 10px 0; /* 调整为与世界书应用一致的高度 */
            border-top: 1px solid var(--color-border-light);
            background: linear-gradient(180deg, rgba(248, 249, 250, 0.95) 0%, rgba(255, 255, 255, 0.98) 100%);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        
        .chat-tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #8E8E93;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px 12px;
            border-radius: 12px;
            position: relative;
            min-width: 50px;
        }
        
        .chat-tab.active {
            color: rgb(74, 132, 193);
        }
        
        /* 可爱主题下的激活颜色 */
        body[data-theme="cute"] .chat-tab.active {
            color: #FF69B4;
        }
        
        .chat-tab i {
            font-size: 22px;
            margin-bottom: 4px;
            transition: all 0.3s ease;
        }
        
        .chat-tab:hover {
            transform: translateY(-2px);
        }
        
        .chat-tab:hover i {
            transform: scale(1.1);
        }
        
        .chat-tab span {
            font-weight: 500;
            letter-spacing: 0.3px;
        }
        
        /* 消息列表 */
        .message-list {
            flex: 1;
            overflow-y: auto;
        }
        
        .message-item {
            display: flex;
            align-items: center; /* 垂直居中对齐 */
            padding: 10px;
            border-bottom: 1px solid var(--color-border-light);
            cursor: pointer;
            gap: 10px; /* 添加元素间距 */
        }
        
        .message-content {
            flex: 1;
            min-width: 0; /* 允许内容缩小 */
            overflow: hidden; /* 防止内容溢出 */
        }
        
        .message-name {
            font-weight: bold;
            margin-bottom: 2px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .message-preview {
            color: var(--color-text-light);
            font-size: 14px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: calc(100% - 50px); /* 再增加预览长度，大约3个字符的空间 */
            flex: 1; /* 让预览文字能够缩放 */
            min-width: 0; /* 允许内容缩小 */
        }
        
        .message-time {
            font-size: 12px;
            color: var(--color-text-lighter);
            flex-shrink: 0; /* 防止时间被挤压 */
            white-space: nowrap; /* 防止时间换行 */
            margin-left: auto; /* 将时间推到右侧 */
        }
        
        /* 通讯录 */
        .contact-list {
            flex: 1;
            overflow-y: auto;
        }
        
        .contact-section {
            margin-bottom: 15px;
        }
        
        .section-title {
            padding: 5px 15px;
            background-color: var(--color-gray-bg);
            color: var(--color-text-light);
            font-size: 14px;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            border-bottom: 1px solid var(--color-border-light);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }


        
        .contact-info {
            flex: 1;
            margin-left: 10px;
            overflow: hidden;
        }
        
        .character-preview {
            font-size: 12px;
            color: #666;
            margin-top: 2px;
            line-height: 1.3;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: calc(100vw - 140px);
        }
        
        /* 动态 */
        .moment-list {
            flex: 1;
            overflow-y: auto;
        }
        
        .moment-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .moment-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .moment-name {
            font-weight: bold;
        }
        
        .moment-content {
            margin-bottom: 10px;
        }
        
        .moment-images {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .moment-image {
            aspect-ratio: 1;
            background-color: #eee;
        }
        
        .moment-actions {
            display: flex;
            justify-content: space-between;
            color: #888;
            font-size: 14px;
        }
        
        /* 个人页面 */
        .profile-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px 0;
            background-color: #f8f8f8;
        }
        
        .profile-name {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 5px;
        }
        
        .profile-id {
            color: #888;
            font-size: 14px;
        }
        
        .profile-menu {
            margin-top: 20px;
        }
        
        .menu-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .menu-item-left {
            display: flex;
            align-items: center;
        }
        
        .menu-icon {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            background-color: #07C160;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 10px;
        }
        
        /* 人物应用 */
        .character-list {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 60px;
        }
        
        .character-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }
        
        .character-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #ddd;
            margin-right: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            transition: border-radius 0.3s ease;
        }

        .character-avatar.rounded-square {
            border-radius: 20%;
        }
        
        .character-info {
            flex: 1;
        }
        
        .character-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .character-bio {
            color: #888;
            font-size: 14px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 100%;
        }
        
        .add-character-header {
            position: absolute;
            right: 15px;
            top: 15px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #007AFF;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            cursor: pointer;
        }
        
        /* 角色编辑表单 */
        .character-form {
            padding: 25px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 20px;
            margin: 15px;
            box-shadow: var(--shadow-card);
            border: 1px solid var(--border-white-20);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--theme-text-primary, #333);
            font-size: 15px;
            letter-spacing: 0.3px;
        }
        
        .form-input {
            width: 100%;
            padding: 15px 18px;
            border: 2px solid var(--theme-input-border, rgba(0, 0, 0, 0.08));
            border-radius: var(--theme-input-radius, 15px);
            font-size: 16px;
            box-sizing: border-box;
            background: var(--theme-form-bg, rgba(255, 255, 255, 0.8));
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: all var(--transition-normal, 0.3s ease);
            color: var(--theme-text-primary, #333);
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--theme-input-focus, rgba(0, 123, 255, 0.5));
            background: var(--theme-form-bg, rgba(255, 255, 255, 0.95));
            box-shadow: 0 0 0 3px var(--theme-input-focus-shadow, rgba(0, 123, 255, 0.1));
            transform: translateY(-1px);
        }
        
        .form-textarea {
            width: 100%;
            padding: 15px 18px;
            border: 2px solid var(--theme-input-border, rgba(0, 0, 0, 0.08));
            border-radius: var(--theme-input-radius, 15px);
            font-size: 16px;
            box-sizing: border-box;
            min-height: 120px;
            resize: vertical;
            background: var(--theme-form-bg, rgba(255, 255, 255, 0.8));
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: all var(--transition-normal, 0.3s ease);
            color: var(--theme-text-primary, #333);
            font-family: var(--theme-font-family);
        }
        
        .form-textarea:focus {
            outline: none;
            border-color: var(--theme-input-focus, rgba(0, 123, 255, 0.5));
            background: var(--theme-form-bg, rgba(255, 255, 255, 0.95));
            box-shadow: 0 0 0 3px var(--theme-input-focus-shadow, rgba(0, 123, 255, 0.1));
            transform: translateY(-1px);
        }
        
        .form-submit {
            width: 100%;
            padding: 16px;
            background: var(--theme-button-bg, rgba(0, 123, 255, 0.9));
            color: var(--theme-button-color, white);
            border: var(--theme-button-border, none);
            border-radius: var(--theme-button-radius, 15px);
            font-size: var(--theme-button-font-size, 17px);
            font-weight: var(--theme-button-font-weight, 600);
            font-family: var(--theme-font-family);
            cursor: pointer;
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            box-shadow: var(--theme-button-shadow, 0 4px 15px rgba(0, 123, 255, 0.3));
            transition: all var(--transition-normal, 0.3s ease);
            letter-spacing: var(--theme-button-letter-spacing, 0.5px);
            text-shadow: var(--theme-text-shadow, none);
        }
        
        .form-submit:hover {
            transform: translateY(-2px);
            box-shadow: var(--theme-button-shadow, 0 6px 20px rgba(0, 123, 255, 0.4));
            background: var(--theme-button-bg-hover, rgba(0, 123, 255, 1));
        }
        
        .form-submit:active {
            transform: translateY(0);
            box-shadow: var(--theme-button-shadow, 0 2px 10px rgba(0, 123, 255, 0.3));
        }
        
        .avatar-upload {
            margin-bottom: 25px;
            padding: 20px;
            background: var(--theme-form-bg, rgba(255, 255, 255, 0.6));
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 18px;
            border: 1px solid var(--theme-input-border, rgba(0, 0, 0, 0.05));
            text-align: center;
        }
        
        .avatar-preview {
            width: 85px;
            height: 85px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--theme-avatar-bg-1, #f0f2f5), var(--theme-avatar-bg-2, #e8ebf0));
            margin: 0 auto 15px;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            border: 3px solid var(--theme-avatar-border, rgba(255, 255, 255, 0.8));
            transition: all var(--transition-normal, 0.3s ease);
        }

        /* 方形圆角预览头像样式 */
        .avatar-preview.rounded-square {
            border-radius: 12%;
        }
        
        .avatar-preview.has-image {
            background: none !important;
        }
        
        .avatar-preview.has-image .avatar-preview-text {
            display: none !important;
        }
        
        .avatar-preview:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-hover-alt);
        }
        
        .avatar-preview-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 36px;
            font-weight: 700;
            color: var(--theme-avatar-text, #8b9dc3);
        }
        
        .upload-button {
            display: block;
            width: 100%;
            padding: 12px 20px;
            background: var(--theme-button-secondary-bg, rgba(255, 255, 255, 0.8));
            border: 2px solid var(--theme-button-secondary-border, rgba(0, 0, 0, 0.1));
            border-radius: var(--theme-button-radius, 12px);
            cursor: pointer;
            color: var(--theme-button-secondary-color, #555);
            font-weight: 500;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: all var(--transition-fast, 0.2s ease);
            box-shadow: 0 2px 8px var(--bg-black-05);
            text-align: center;
        }
        
        .upload-button:hover {
            background: var(--theme-button-secondary-bg-hover, rgba(255, 255, 255, 0.95));
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .upload-button:active {
            transform: translateY(0);
            box-shadow: var(--shadow-button);
        }
        
        /* 论坛界面 */
        .forum-categories {
            padding: 15px;
        }
        
        .forum-category {
            display: flex;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 12px;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .forum-category:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .category-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-right: 15px;
        }
        
        .forum-category:nth-child(1) .category-icon {
            background: linear-gradient(135deg, #ff6b6b, #ff8787);
            color: white;
        }
        
        .forum-category:nth-child(2) .category-icon {
            background: linear-gradient(135deg, #4ecdc4, #44a3aa);
            color: white;
        }
        
        .forum-category:nth-child(3) .category-icon {
            background: linear-gradient(135deg, #f06292, #ec407a);
            color: white;
        }
        
        .category-info {
            flex: 1;
        }
        
        .category-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
        }
        
        .category-desc {
            font-size: 13px;
            color: #666;
        }
        
        .category-count {
            font-size: 20px;
            font-weight: 600;
            color: #999;
        }
        
        /* 游戏界面 */
        .game-list {
            padding: 15px;
        }
        
        .game-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 12px;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }
        
        .game-item:hover:not(.coming-soon) {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .game-item.coming-soon {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .game-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            margin-right: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .game-info {
            flex: 1;
        }
        
        .game-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
        }
        
        .game-desc {
            font-size: 13px;
            color: #666;
        }
        
        .game-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff6b6b;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }
        



        /* 音乐播放器样式 */
        .music-status-display {
            position: absolute;
            left: 50%;
            top: 12px; /* 定位在状态栏的垂直中心 */
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 15px; /* 减小圆角 */
            padding: 4px 10px; /* 减小内边距 */
            display: flex;
            align-items: center;
            gap: 6px; /* 减小间距 */
            cursor: pointer;
            width: 140px; /* 固定宽度，不再使用max-width和min-width */
            z-index: 100; /* 确保灵动岛在状态栏之上 */
            pointer-events: auto; /* 确保可以点击 */
        }

        .music-icon {
            color: #5A9FD4; /* 降低蓝色饱和度 */
            font-size: 12px; /* 减小图标大小 */
            flex-shrink: 0; /* 防止图标被压缩 */
        }

        .music-lyrics-scroll {
            flex: 1;
            overflow: hidden;
            white-space: nowrap;
            color: white;
            font-size: 11px; /* 减小字体大小 */
            font-weight: 400; /* 减轻字体粗细 */
        }

        .music-lyrics-scroll span {
            display: inline-block;
            animation: scrollLyrics 8s linear infinite;
        }

        @keyframes scrollLyrics {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        /* 音乐模态框样式 - 现代化设计 */
        .music-modal {
            position: fixed;
            z-index: 99999;
            display: block;
            pointer-events: none; /* 让背景不阻挡点击 */
        }

        .music-modal-content {
            background: rgba(200, 200, 200, 0.25);
            backdrop-filter: blur(30px) saturate(1.5);
            -webkit-backdrop-filter: blur(30px) saturate(1.5);
            border-radius: 20px;
            width: 85%;
            height: 60%; /* 调整为屏幕高度的60% */
            overflow: visible;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            flex-direction: column;
            pointer-events: auto; /* 恢复模态框内容的点击 */
            position: absolute;
            top: 60px; /* 贴着状态栏下面 */
            left: 50%;
            transform: translateX(-50%); /* 水平居中 */
        }

        .music-modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px 8px; /* 减小内边距使头部更紧凑 */
            color: #333;
            background: transparent;
            border-bottom: none;
        }

        .music-modal-close {
            background: rgba(0, 0, 0, 0.1);
            border: none;
            font-size: 16px;
            cursor: pointer;
            color: #666;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .music-modal-close:hover {
            background: rgba(0, 0, 0, 0.2);
            color: #333;
        }

        .music-header-title {
            font-size: 14px;
            font-weight: 500;
            color: #333;
            text-align: center;
            flex: 1;
        }

        .music-view-toggle {
            background: rgba(0, 0, 0, 0.1);
            border: none;
            border-radius: 6px;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #666;
            transition: all 0.2s ease;
            font-size: 12px;
        }

        .music-view-toggle:hover {
            background: rgba(0, 0, 0, 0.2);
            color: #333;
        }

        .music-modal-body {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            padding: 0 16px; /* 移除上下内边距 */
            align-items: center;
            justify-content: flex-start; /* 改为从顶部开始布局 */
        }

        /* 唱片机模式 - 现代化设计 */
        .vinyl-player {
            padding: 10px 16px; /* 调整内边距 */
            text-align: center;
            position: relative;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start; /* 改为从顶部开始布局 */
            overflow: visible;
        }

        .vinyl-container {
            position: relative;
            width: 160px; /* 稍微减小尺寸 */
            height: 160px;
            margin: 10px auto 15px; /* 增加上下边距 */
        }

        .vinyl-disc {
            position: relative;
            width: 160px; /* 与容器尺寸匹配 */
            height: 160px;
            border-radius: 50%;
            background: linear-gradient(45deg, #0a0a0a 0%, #1a1a1a 30%, #2a2a2a 70%, #0a0a0a 100%);
            margin: 0 auto;
            animation: vinylSpin 12s linear infinite paused;
            box-shadow:
                0 0 0 1px #333,
                0 0 0 2px #111,
                0 8px 20px rgba(0, 0, 0, 0.4),
                inset 0 0 0 1px rgba(255, 255, 255, 0.05);
            z-index: 1;
        }

        .vinyl-disc.playing {
            animation-play-state: running;
        }

        @keyframes vinylSpin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .vinyl-grooves {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: repeating-conic-gradient(
                from 0deg,
                transparent 0deg,
                rgba(255, 255, 255, 0.02) 0.5deg,
                transparent 1deg
            );
            z-index: 1;
        }

        .vinyl-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background: #d3d3d3; /* 改为浅灰色 */
            border-radius: 50%;
            box-shadow:
                inset 0 0 8px rgba(0, 0, 0, 0.2), /* 减轻阴影 */
                0 2px 6px rgba(0, 0, 0, 0.2);
            z-index: 4;
        }

        .vinyl-label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px; /* 适应180px唱片盘的尺寸 */
            height: 100px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); /* 恢复原来的背景 */
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 12px;
            box-sizing: border-box;
            box-shadow:
                inset 0 0 10px rgba(0, 0, 0, 0.1),
                0 2px 8px rgba(0, 0, 0, 0.2);
            z-index: 2;
            cursor: pointer;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .vinyl-label:hover {
            transform: translate(-50%, -50%) scale(1.02);
        }

        .album-cover-upload {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: contain; /* 改为contain以显示完整图片 */
            z-index: 3;
        }

        /* 专门为唱片机模式的封面显示添加样式 */
        .album-cover-display {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: contain; /* 显示完整图片 */
            z-index: 3;
        }

        .upload-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            z-index: 4;
            cursor: pointer;
        }

        .song-info {
            color: #333;
            text-align: center;
            margin-bottom: 5px; /* 进一步减小下边距 */
        }

        .song-title {
            font-size: 13px; /* 稍微减小字体 */
            font-weight: 600;
            margin-bottom: 2px; /* 减小下边距 */
            color: #333;
            line-height: 1.1; /* 减小行高 */
        }

        .song-artist {
            font-size: 10px; /* 减小字体 */
            color: #666;
            margin-bottom: 1px; /* 减小下边距 */
        }

        .song-album {
            font-size: 9px; /* 减小字体 */
            color: #999;
        }

        .vinyl-label:hover .upload-overlay {
            display: flex;
        }

        .tonearm {
            position: absolute;
            top: 15px;
            right: 25px;
            width: 80px;
            height: 3px;
            background: linear-gradient(90deg, #666 0%, #999 50%, #666 100%);
            border-radius: 1px;
            transform-origin: right center;
            transform: rotate(15deg);
            transition: transform 0.5s ease;
            z-index: 4;
        }

        .tonearm.playing {
            transform: rotate(-2deg);
        }

        .tonearm::before {
            content: '';
            position: absolute;
            right: -5px;
            top: -4px;
            width: 10px;
            height: 10px;
            background: #333;
            border-radius: 50%;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .tonearm::after {
            content: '';
            position: absolute;
            left: -6px;
            top: -2px;
            width: 8px;
            height: 8px;
            background: #999;
            border-radius: 50%;
        }

        .vinyl-lyrics {
            margin-top: 15px; /* 增加上边距 */
            height: 25px; /* 进一步减小高度 */
            overflow: hidden;
            position: relative;
            background: transparent; /* 完全透明 */
            border-radius: 0; /* 移除圆角 */
            padding: 0 15px; /* 保持左右内边距确保歌词显示完整 */
            backdrop-filter: none; /* 移除模糊效果 */
            -webkit-backdrop-filter: none; /* 移除模糊效果 */
            width: 100%; /* 确保宽度占满 */
            box-sizing: border-box; /* 包含内边距在宽度计算中 */
        }

        .lyrics-container {
            position: relative;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .lyric-line {
            font-size: 14px;
            color: #333; /* 改为黑色 */
            margin: 2px 0;
            min-height: 20px;
            transition: all 0.5s ease;
            text-align: center;
            line-height: 1.3;
            transform: translateY(0);
            opacity: 0.8; /* 稍微提高透明度 */
        }

        .lyric-line.active {
            color: #000; /* 当前歌词改为纯黑色 */
            font-weight: 600;
            transform: translateY(0) scale(1.05);
            opacity: 1;
            text-shadow: none; /* 移除蓝色阴影 */
        }



        /* 完整歌词模式 - 现代化设计 */
        .lyrics-mode {
            padding: 20px 16px 12px;
            flex: 1;
            display: flex;
            flex-direction: column;
            color: #333;
        }

        .lyrics-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .lyrics-header .song-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
            color: #333;
        }

        .lyrics-header .song-artist {
            font-size: 13px;
            color: #666;
            margin-bottom: 2px;
        }

        .lyrics-header .song-album {
            font-size: 11px;
            color: #999;
        }

        .full-lyrics-container {
            flex: 1;
            overflow: hidden; /* 改为hidden，使用transform滚动 */
            padding: 0 16px; /* 增加左右padding，防止歌词被切割 */
            margin-bottom: 12px;
            max-height: 350px;
            min-height: 200px;
            position: relative;
            /* 添加渐变遮罩效果 */
            -webkit-mask-image: linear-gradient(transparent, black 15%, black 85%, transparent);
            mask-image: linear-gradient(transparent, black 15%, black 85%, transparent);
        }

        .full-lyrics {
            text-align: center;
            line-height: 1.6;
            /* 添加transform过渡动画 */
            transition: transform 0.6s cubic-bezier(0.25, 0.1, 0.25, 1);
            padding: 200px 0; /* 进一步增加上下padding，让当前歌词真正居中 */
        }

        .full-lyrics .lyric-line {
            font-size: 12px;
            color: rgba(0, 0, 0, 0.6);
            margin: 6px 0;
            padding: 3px 8px; /* 增加左右padding，防止长歌词被切割 */
            transition: all 0.5s ease;
            cursor: pointer;
            opacity: 0.7;
            transform: scale(0.95);
            line-height: 1.4;
            word-wrap: break-word; /* 允许长单词换行 */
            white-space: normal; /* 允许文本换行 */
        }

        .full-lyrics .lyric-line:hover {
            color: rgba(0, 0, 0, 0.8);
        }

        .full-lyrics .lyric-line.active {
            color: #007AFF;
            font-weight: 600;
            font-size: 13px;
            opacity: 1;
            transform: scale(1.05);
            text-shadow: 0 0 8px rgba(0, 122, 255, 0.2);
        }

        /* 音乐控制区域 - 现代化设计 */
        .music-modal-controls {
            padding: 8px 16px 12px; /* 进一步减小内边距 */
            background: transparent;
            backdrop-filter: none;
            -webkit-backdrop-filter: none;
            border-top: none;
            flex-shrink: 0; /* 防止控制区域被压缩 */
        }

        /* 当前歌词显示区域 */
        .current-lyric-display {
            text-align: center;
            margin-bottom: 8px;
            min-height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .current-lyric-text {
            font-size: 14px;
            color: #333;
            font-weight: 400;
            line-height: 1.4;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .music-progress {
            margin-bottom: 12px; /* 减小下边距 */
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 2px;
            margin-bottom: 8px;
            position: relative;
            cursor: pointer;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #333; /* 改为黑色 */
            border-radius: 2px;
            width: 0%;
            transition: width 0.3s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 8px;
            height: 100%;
            background: #333; /* 改为黑色 */
            border-radius: 50%;
            transform: translateX(50%);
            box-shadow: 0 0 4px rgba(0, 0, 0, 0.3); /* 改为黑色阴影 */
        }

        .time-display {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: #666;
            font-weight: 400;
        }

        .music-control-buttons {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 12px;
        }

        .control-btn {
            width: 36px;
            height: 36px;
            border: none;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.65);
            color: #666;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            font-size: 14px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            position: relative;
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.8);
            color: #333;
            transform: scale(1.05);
        }

        /* 单曲循环数字显示 */
        .control-btn {
            position: relative;
        }

        .control-btn .loop-number {
            position: absolute;
            bottom: 4px;
            right: 4px;
            font-size: 10px;
            font-weight: bold;
            color: #666; /* 和按钮图标一样的灰色 */
            background: transparent;
            line-height: 1;
        }

        .control-btn.shuffle.active {
            background: rgba(0, 122, 255, 0.2);
            color: #007AFF;
        }

        .control-btn.repeat.active {
            background: rgba(0, 122, 255, 0.2);
            color: #007AFF;
        }

        .play-pause-btn {
            width: 48px;
            height: 48px;
            background: rgba(255, 255, 255, 0.65); /* 和其他按钮一样的背景 */
            border: none;
            border-radius: 50%;
            color: #666; /* 和其他按钮一样的颜色 */
            font-size: 16px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .play-pause-btn:hover {
            background: rgba(255, 255, 255, 0.8); /* 和其他按钮一样的悬停效果 */
            color: #333;
            transform: scale(1.05);
        }

        .listening-time {
            text-align: center;
            font-size: 12px;
            color: #666;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        /* 音乐播放器关闭按钮 - 小型关机按钮样式 */
        .music-close-btn {
            position: absolute;
            bottom: 12px;
            left: 12px;
            width: 20px;
            height: 20px;
            background: rgba(255, 255, 255, 0.65);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            color: #666;
            font-size: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 10;
        }

        .music-close-btn:hover {
            background: rgba(255, 0, 0, 0.15);
            border-color: rgba(255, 0, 0, 0.3);
            color: #ff4444;
            transform: scale(1.05);
        }

        .music-close-btn:active {
            transform: scale(0.9);
        }




        
        /* 浏览器界面 */
        .browser-toolbar {
            display: flex;
            padding: 10px;
            background-color: #f8f8f8;
            border-bottom: 1px solid #ddd;
        }
        
        .browser-url-bar {
            flex: 1;
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid #ddd;
            background-color: white;
        }
        
        .browser-content {
            border: none;
            width: 100%;
            height: 100%;
        }
        

        
        /* 壁纸设置 */
        .wallpaper-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            padding: 15px;
        }
        
        .wallpaper-option {
            aspect-ratio: 1;
            border-radius: 10px;
            background-size: cover;
            background-position: center;
            border: 2px solid transparent;
            cursor: pointer;
        }
        
        .wallpaper-option.selected {
            border-color: #007AFF;
        }
        
        /* 壁纸预览容器 */
        .wallpaper-preview-container {
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 10px;
            margin-bottom: 15px;
            min-height: 250px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }
        
        .wallpaper-preview-placeholder {
            text-align: center;
            color: #999;
        }
        
        .wallpaper-preview-placeholder i {
            font-size: 48px;
            margin-bottom: 10px;
            color: #ddd;
        }
        
        .wallpaper-preview-placeholder div {
            font-size: 14px;
        }
        
        .wallpaper-preview-image {
            width: 280px;
            height: 200px;
            border-radius: 12px;
            object-fit: contain;
            border: 3px solid #ddd;
            background-color: #fff;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        /* 应用图标选择器样式 */
        .app-list-section {
            margin-bottom: 20px;
        }

        .app-list-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .app-item-selector {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 10px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            border: 2px solid transparent;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .app-item-selector:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .app-item-selector.selected {
            border-color: #007AFF;
            background: rgba(0, 122, 255, 0.1);
        }

        .app-item-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 8px;
            background: #007AFF;
            color: white;
            font-size: 24px;
            overflow: hidden;
        }

        .app-item-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 12px;
        }

        .app-item-name {
            font-size: 12px;
            color: #333;
            font-weight: 500;
            text-align: center;
        }

        .icon-upload-section {
            border-top: 1px solid #eee;
            padding-top: 20px;
        }

        .upload-area {
            border: 2px dashed #ddd;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        .upload-area:hover {
            border-color: #007AFF;
            background: rgba(0, 122, 255, 0.05);
        }

        .upload-area.has-image {
            border-style: solid;
            border-color: #007AFF;
            background: rgba(0, 122, 255, 0.1);
        }

        .icon-preview-img {
            max-width: 100px;
            max-height: 100px;
            border-radius: 12px;
            object-fit: cover;
        }
        

        
        /* 颜色选择器 */
        .color-picker {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding: 15px;
        }
        
        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid transparent;
            cursor: pointer;
        }
        
        .color-option.selected {
            border-color: #000;
        }
        
        /* 透明度滑块 */
        .opacity-slider {
            width: 100%;
            padding: 0 15px;
            margin-top: 10px;
        }
        
        /* 新建联系人模态框 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }

        /* 🔥【修复】为发布帖子模态框添加缺失的样式 */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.show,
        .modal-overlay[style*="flex"] {
            display: flex !important;
        }

        /* 🔥【新增】发布帖子模态框专用样式 */
        #create-post-modal .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            max-width: 500px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease-out;
        }

        #create-post-modal .modal-header {
            padding: 20px 24px 16px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #create-post-modal .modal-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        #create-post-modal .modal-close-btn {
            background: rgba(0, 0, 0, 0.05);
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #666;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        #create-post-modal .modal-close-btn:hover {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
            transform: scale(1.05);
        }

        #create-post-modal .modal-body {
            padding: 20px 24px;
        }

        #create-post-modal .form-group {
            margin-bottom: 20px;
        }

        #create-post-modal .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
            font-size: 14px;
        }

        #create-post-modal .form-group input[type="text"],
        #create-post-modal .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: all 0.2s ease;
            box-sizing: border-box;
            resize: vertical;
        }

        #create-post-modal .form-group input[type="text"]:focus,
        #create-post-modal .form-group textarea:focus {
            outline: none;
            border-color: var(--theme-button-bg, #007AFF);
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
            background: rgba(255, 255, 255, 0.95);
        }

        #create-post-modal .form-upload-btn {
            background: rgba(108, 117, 125, 0.1);
            border: 1px dashed rgba(108, 117, 125, 0.3);
            border-radius: 8px;
            padding: 12px 16px;
            color: #6c757d;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        #create-post-modal .form-upload-btn:hover {
            background: rgba(108, 117, 125, 0.15);
            border-color: rgba(108, 117, 125, 0.4);
            color: #495057;
        }

        #create-post-modal .char-count {
            font-size: 12px;
            color: #666;
            text-align: right;
            margin-top: 8px;
        }

        #create-post-modal .modal-footer {
            padding: 16px 24px 20px;
            border-top: 1px solid rgba(0, 0, 0, 0.08);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        #create-post-modal .btn-secondary,
        #create-post-modal .btn-primary {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 80px;
        }

        #create-post-modal .btn-secondary {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
            border: 1px solid rgba(108, 117, 125, 0.2);
        }

        #create-post-modal .btn-secondary:hover {
            background: rgba(108, 117, 125, 0.15);
            color: #495057;
        }

        #create-post-modal .btn-primary {
            background: var(--theme-button-bg, #007AFF);
            color: white;
            border: 1px solid transparent;
        }

        #create-post-modal .btn-primary:hover {
            background: var(--theme-button-bg-hover, #0056CC);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);
        }

        /* 响应式设计 */
        @media (max-width: 480px) {
            #create-post-modal .modal-content {
                width: 95%;
                margin: 20px auto;
            }

            #create-post-modal .modal-header,
            #create-post-modal .modal-body,
            #create-post-modal .modal-footer {
                padding-left: 20px;
                padding-right: 20px;
            }
        }

        /* 🎨【新增】表情包库表单模态框样式 - 简约风格 */
        #emoji-library-form-modal .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            max-width: 450px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease-out;
        }

        #emoji-library-form-modal .modal-header {
            padding: 20px 24px 16px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #emoji-library-form-modal .modal-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        #emoji-library-form-modal .modal-close-btn {
            background: rgba(0, 0, 0, 0.05);
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #666;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        #emoji-library-form-modal .modal-close-btn:hover {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
            transform: scale(1.05);
        }

        #emoji-library-form-modal .modal-body {
            padding: 20px 24px;
        }

        #emoji-library-form-modal .form-group {
            margin-bottom: 20px;
        }

        #emoji-library-form-modal .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
            font-size: 14px;
        }

        #emoji-library-form-modal .form-group input[type="text"],
        #emoji-library-form-modal .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: all 0.2s ease;
            box-sizing: border-box;
            resize: vertical;
        }

        #emoji-library-form-modal .form-group input[type="text"]:focus,
        #emoji-library-form-modal .form-group textarea:focus {
            outline: none;
            border-color: var(--theme-button-bg, #007AFF);
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
            background: rgba(255, 255, 255, 0.95);
        }

        #emoji-library-form-modal .form-group textarea {
            min-height: 80px;
        }

        #emoji-library-form-modal .modal-footer {
            padding: 16px 24px 20px;
            border-top: 1px solid rgba(0, 0, 0, 0.08);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        #emoji-library-form-modal .modal-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 80px;
        }

        #emoji-library-form-modal .cancel-btn {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
            border: 1px solid rgba(108, 117, 125, 0.2);
        }

        #emoji-library-form-modal .cancel-btn:hover {
            background: rgba(108, 117, 125, 0.15);
            color: #495057;
        }

        #emoji-library-form-modal .confirm-btn {
            background: var(--theme-button-bg, #007AFF);
            color: white;
            border: 1px solid transparent;
        }

        #emoji-library-form-modal .confirm-btn:hover {
            background: var(--theme-button-bg-hover, #0056CC);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);
        }

        /* 响应式设计 */
        @media (max-width: 480px) {
            #emoji-library-form-modal .modal-content {
                width: 95%;
                margin: 20px auto;
            }

            #emoji-library-form-modal .modal-header,
            #emoji-library-form-modal .modal-body,
            #emoji-library-form-modal .modal-footer {
                padding-left: 20px;
                padding-right: 20px;
            }
        }

        /* 🔥【新增】发帖类型选择模态框样式 */
        #post-type-modal .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            animation: modalSlideIn 0.3s ease-out;
        }

        .post-type-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .post-type-option {
            display: flex;
            align-items: center;
            padding: 16px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: rgba(255, 255, 255, 0.8);
        }

        .post-type-option:hover {
            background: rgba(255, 255, 255, 0.95);
            border-color: var(--theme-button-bg, #007AFF);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 122, 255, 0.15);
        }

        .post-type-option .option-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--theme-button-bg, #007AFF);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 16px;
            font-size: 16px;
        }

        .post-type-option .option-content h4 {
            margin: 0 0 4px 0;
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .post-type-option .option-content p {
            margin: 0;
            font-size: 14px;
            color: #666;
        }

        /* 🔥【新增】论坛帖子多选删除样式 */
        .header-actions .action-btn.active {
            background: #ff4757;
            color: white;
        }

        .post-checkbox {
            position: absolute;
            top: 12px;
            left: 12px;
            z-index: 10;
        }

        .post-checkbox input[type="checkbox"] {
            display: none;
        }

        .post-checkbox .checkbox-label {
            display: block;
            width: 20px;
            height: 20px;
            border: 2px solid #ddd;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .post-checkbox input[type="checkbox"]:checked + .checkbox-label {
            background: var(--theme-button-bg, #007AFF);
            border-color: var(--theme-button-bg, #007AFF);
        }

        .post-checkbox input[type="checkbox"]:checked + .checkbox-label::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        /* 🔥【新增】论坛多选模式右上角按钮 */
        .forum-multiselect-actions {
            display: flex;
            gap: 4px;
            align-items: center;
        }

        .forum-multiselect-actions .multiselect-btn {
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 40px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .forum-multiselect-actions .cancel-btn {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
            border: 1px solid rgba(108, 117, 125, 0.2);
        }

        .forum-multiselect-actions .cancel-btn:hover {
            background: rgba(108, 117, 125, 0.15);
            color: #495057;
        }

        .forum-multiselect-actions .delete-btn {
            background: #ff4757;
            color: white;
        }

        .forum-multiselect-actions .delete-btn:hover {
            background: #ff3742;
        }

        /* 多选模式下的帖子项样式调整 */
        .post-item {
            position: relative;
        }

        /* 多选模式下为帖子内容添加左边距，避免被复选框遮挡 */
        .post-item:has(.post-checkbox) {
            padding-left: 45px;
        }

        /* 如果浏览器不支持:has()，使用JavaScript动态添加类名 */
        .post-item.has-checkbox {
            padding-left: 45px;
        }

        /* 播放列表模态框需要更高的z-index */
        #playlist-modal {
            z-index: 100000 !important;
        }

        /* 播放列表模态框 - 简洁毛玻璃风格 */
        #playlist-modal .modal-content {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        #playlist-modal .modal-header {
            background: transparent;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: 16px 20px;
        }

        #playlist-modal .modal-header h3 {
            color: #333;
            font-weight: 500;
            font-size: 18px;
            margin: 0;
        }

        #playlist-modal .close-btn {
            color: #666;
            background: rgba(0, 0, 0, 0.05);
            border: none;
            border-radius: 6px;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }

        #playlist-modal .close-btn:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        /* 添加歌曲区域 - 简洁风格 */
        .add-song-section {
            margin-bottom: 20px;
            padding: 16px;
            background: rgba(0, 0, 0, 0.03);
            border-radius: 8px;
            border: 1px solid rgba(0, 0, 0, 0.08);
        }

        .add-song-section h4 {
            margin: 0 0 12px 0;
            color: #333;
            font-weight: 500;
            font-size: 16px;
        }

        .input-group {
            margin-bottom: 10px;
        }

        .input-row {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
        }

        .song-input {
            padding: 8px 10px;
            border: 1px solid rgba(0, 0, 0, 0.15);
            border-radius: 6px;
            background: white;
            color: #333;
            font-size: 13px;
            transition: border-color 0.2s ease;
            min-width: 0;
        }

        .song-input.half-width {
            flex: 1 1 calc(50% - 4px);
            max-width: calc(50% - 4px);
            min-width: 0;
            width: calc(50% - 4px);
            box-sizing: border-box;
        }

        .song-input:focus {
            outline: none;
            border-color: #007AFF;
        }

        .song-input::placeholder {
            color: #999;
        }

        .file-label {
            display: block;
            color: #666;
            margin-bottom: 4px;
            font-size: 13px;
        }

        .file-input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .file-input-wrapper.half-width {
            flex: 1 1 calc(50% - 4px);
            max-width: calc(50% - 4px);
            min-width: 0;
            width: calc(50% - 4px);
            box-sizing: border-box;
        }

        .lyrics-input-section {
            margin-top: 8px;
        }





        .file-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-text {
            padding: 8px 10px;
            border: 1px solid rgba(0, 0, 0, 0.15);
            border-radius: 6px;
            background: white;
            color: #999;
            font-size: 13px;
            min-width: 0;
            width: 100%;
            cursor: pointer;
            user-select: none;
            transition: border-color 0.2s ease;
        }

        .add-song-btn {
            width: 100%;
            margin-top: 12px;
            padding: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* 经典主题 - 雾霾蓝 */
        .theme-classic .add-song-btn {
            background: rgba(135, 206, 235, 0.6);
            color: rgba(255, 255, 255, 0.9);
        }

        .theme-classic .add-song-btn:hover {
            background: rgba(135, 206, 235, 0.8);
            transform: translateY(-1px);
        }

        /* 可爱主题 - 雾霾粉 */
        .theme-cute .add-song-btn {
            background: rgba(255, 182, 193, 0.6);
            color: rgba(255, 255, 255, 0.9);
        }

        .theme-cute .add-song-btn:hover {
            background: rgba(255, 182, 193, 0.8);
            transform: translateY(-1px);
        }

        /* 音乐播放器上传按钮样式 */
        .upload-btn {
            background: rgba(200, 200, 200, 0.4);
            color: rgba(0, 0, 0, 0.7);
            border: none;
            border-radius: 6px;
            padding: 8px 12px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        .upload-btn:hover {
            background: rgba(200, 200, 200, 0.6);
            transform: scale(1.02);
        }

        .upload-btn i {
            font-size: 11px;
        }

        /* 播放列表区域 */
        .current-playlist h4 {
            margin: 0 0 12px 0;
            color: #333;
            font-weight: 500;
            font-size: 16px;
        }

        .playlist-items {
            max-height: 280px;
            overflow-y: auto;
        }

        /* 简洁滚动条 */
        .playlist-items::-webkit-scrollbar {
            width: 4px;
        }

        .playlist-items::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 2px;
        }

        .playlist-items::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 2px;
        }

        .playlist-items::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        /* 播放列表项 - 简洁风格 */
        .playlist-item-modern {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            margin-bottom: 6px;
            background: rgba(0, 0, 0, 0.02);
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border: 1px solid rgba(0, 0, 0, 0.05);
            gap: 12px;
        }

        .playlist-item-modern:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .song-number {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.08);
            border-radius: 50%;
            color: #666;
            font-size: 11px;
            font-weight: 500;
            flex-shrink: 0;
        }

        .song-info {
            flex: 1;
            min-width: 0;
            margin-left: 0;
        }

        .song-title {
            color: #333;
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .song-artist {
            color: #666;
            font-size: 12px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .song-actions {
            display: flex;
            gap: 6px;
            flex-shrink: 0;
        }

        /* 播放列表按钮样式 - 限制作用域 */
        .playlist-item .play-btn,
        .playlist-item .delete-btn,
        #playlist-modal .play-btn,
        #playlist-modal .delete-btn {
            width: 28px;
            height: 28px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .playlist-item .play-btn,
        #playlist-modal .play-btn {
            background: rgba(200, 200, 200, 0.4);
            color: rgba(0, 0, 0, 0.7);
        }

        .playlist-item .play-btn:hover,
        #playlist-modal .play-btn:hover {
            background: rgba(200, 200, 200, 0.6);
            transform: scale(1.05);
        }

        .playlist-item-modern .delete-btn {
            background: rgba(200, 200, 200, 0.4) !important;
            color: rgba(100, 100, 100, 0.8) !important;
        }

        .playlist-item-modern .delete-btn i.fas.fa-trash {
            color: rgba(100, 100, 100, 0.8) !important;
        }

        /* 只针对播放列表的删除按钮使用灰色 */
        .playlist-item .delete-btn {
            background: rgba(200, 200, 200, 0.4) !important;
            color: rgba(100, 100, 100, 0.8) !important;
        }

        .playlist-item .delete-btn i.fas.fa-trash {
            color: rgba(100, 100, 100, 0.8) !important;
        }

        /* 播放列表删除按钮特殊样式 */
        #playlist-modal .delete-btn {
            background: rgba(200, 200, 200, 0.4) !important;
            color: rgba(100, 100, 100, 0.8) !important;
        }

        #playlist-modal .delete-btn i {
            color: rgba(100, 100, 100, 0.8) !important;
        }

        /* 播放列表删除按钮悬停效果 */
        .playlist-item .delete-btn:hover,
        #playlist-modal .delete-btn:hover {
            background: rgba(200, 200, 200, 0.6) !important;
            transform: scale(1.05);
        }

        /* 空状态 */
        .playlist-empty {
            text-align: center;
            padding: 30px 20px;
            color: #999;
            font-size: 14px;
        }

        .playlist-empty i {
            font-size: 32px;
            margin-bottom: 12px;
            opacity: 0.6;
        }

        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            width: 80%;
            max-width: 400px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .modal-header {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-weight: bold;
            font-size: 18px;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
        }
        
        .modal-body {
            padding: 15px;
            max-height: 400px;
            overflow-y: auto;
        }

        /* 今日日记模态框特殊样式 - 移除外层滚动条 */
        #today-diary-modal .modal-body {
            padding: 15px;
            max-height: none;
            overflow-y: visible;
        }
        
        .modal-footer {
            padding: 15px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .modal-button {
            padding: 8px 15px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
        }
        
        .modal-primary {
            background-color: var(--theme-button-bg, #007AFF);
            color: var(--theme-button-color, white);
            font-family: var(--theme-font-family);
            font-weight: var(--theme-button-font-weight, 500);
            letter-spacing: var(--theme-button-letter-spacing, 0);
            transition: all 0.2s ease;
        }
        
        .modal-primary:hover {
            background-color: var(--theme-button-bg-hover);
            transform: translateY(-1px);
            box-shadow: var(--theme-button-shadow);
        }
        
        .modal-secondary {
            background-color: var(--theme-button-secondary-bg, #eee);
            color: var(--theme-button-secondary-color, #333);
            font-family: var(--theme-font-family);
            font-weight: var(--theme-button-font-weight, 500);
            letter-spacing: var(--theme-button-letter-spacing, 0);
            transition: all 0.2s ease;
        }
        
        .modal-secondary:hover {
            background-color: var(--theme-button-secondary-bg-hover);
            transform: translateY(-1px);
        }
        
        /* 🔥【修改】桌面端消息操作菜单 - 纯文字风格 */
        .message-menu {
            position: fixed;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            z-index: 1000;
            overflow: hidden;
            min-width: 140px;
            padding: 8px;
        }

        .message-menu-item {
            padding: 10px 16px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            border-radius: 8px;
            text-align: center;
            color: #333;
            background: transparent;
            border: none;
            margin: 2px 0;
        }

        .message-menu-item:hover {
            background: rgba(240, 240, 240, 0.5);
            transform: scale(1.02);
        }

        .message-menu-item.danger {
            color: #333;
        }

        /* 🔥【新增】桌面端消息菜单深色主题适配 */
        .dark-theme .message-menu {
            background: rgba(45, 45, 45, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .dark-theme .message-menu-item {
            color: rgba(255, 255, 255, 0.9);
        }

        .dark-theme .message-menu-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .dark-theme .message-menu-item.danger {
            color: rgba(255, 255, 255, 0.9);
        }

        /* 编辑消息模态框样式 - 使用和世界书模态框相同的样式系统 */
        .edit-message-modal {
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            animation: modalSlideIn 0.3s ease-out;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 20px 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .modal-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: #999;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s ease;
        }
        
        .modal-close:hover {
            background: #f0f0f0;
            color: #666;
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .modal-footer {
            padding: 15px 20px 20px;
            display: flex;
            justify-content: flex-end;
            border-top: 1px solid #f0f0f0;
        }
        
        .edit-message-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            margin-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .message-sender {
            font-weight: 600;
            color: #333;
            font-size: 15px;
        }
        
        .message-time {
            font-size: 12px;
            color: #888;
        }
        
        .edit-form-group {
            margin-bottom: 20px;
        }
        
        .edit-form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
            font-size: 14px;
        }
        
        .edit-message-textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            font-family: inherit;
            background: white;
            color: #333;
            transition: border-color 0.2s ease;
            box-sizing: border-box;
        }
        
        .edit-message-textarea:focus {
            outline: none;
            border-color: #ddd;
            box-shadow: none;
        }
        
        .edit-message-counter {
            text-align: right;
            margin-top: 5px;
            font-size: 12px;
            color: #888;
        }

        /* 🔥【新增】编辑消息提示框样式 */
        .edit-message-tip {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .edit-message-tip p {
            color: #666;
            font-size: 12px;
            margin: 0;
            line-height: 1.4;
        }

        .edit-message-tip i {
            color: #007AFF;
            margin-right: 6px;
        }
        
        .edit-message-image {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #f5f5f5;
            border-radius: 8px;
        }
        
        .edit-message-image img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 6px;
        }
        
        .remove-image-btn {
            padding: 6px 12px;
            background: #ff3b30;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .remove-image-btn:hover {
            background: #e0261e;
        }
        
        .modal-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }
        
        .modal-cancel {
            background: #f5f5f5;
            color: #333;
            margin-right: 10px;
        }
        
        .modal-cancel:hover {
            background: #e8e8e8;
        }
        
        .modal-confirm {
            background: #007AFF;
            color: white;
        }
        
        .modal-confirm:hover {
            background: #0056b3;
        }

        /* 🔥【修复】为表情包库等表单添加通用的确认和取消按钮样式 */
        .modal-btn.cancel-btn {
            background: #f5f5f5;
            color: #333;
            margin-right: 10px;
        }

        .modal-btn.cancel-btn:hover {
            background: #e8e8e8;
        }

        .modal-btn.confirm-btn {
            background: #007AFF;
            color: white;
        }

        .modal-btn.confirm-btn:hover {
            background: #0056b3;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        /* 关于我们页面 */
        .about-content {
            padding: 20px;
            text-align: center;
        }
        
        .about-title {
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .about-version {
            color: #888;
            margin-bottom: 30px;
        }
        
        .about-author {
            margin-top: 30px;
            font-style: italic;
        }
        
        /* 动态样式 */
        .moments-page {
            height: 100%;
            overflow-y: auto;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
        }



        /* 🔥【新增】底部固定评论框样式 */
        .bottom-comment-input {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #fff;
            border-top: 1px solid #e5e5e5;
            padding: 8px 12px;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            animation: slideUp 0.3s ease-out;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .bottom-comment-container {
            display: flex;
            align-items: center;
            max-width: 100%;
            margin: 0 auto;
        }

        #bottom-comment-text {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 20px;
            font-size: 14px;
            outline: none;
            background: #f8f9fa;
            margin-right: 8px;
        }

        .bottom-comment-send {
            padding: 8px 16px;
            background: #6B9BD2;
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s ease;
        }

        .bottom-comment-send:hover {
            background: #5A8BC4;
        }

        .bottom-comment-send:active {
            transform: scale(0.95);
        }

        /* 底部评论框滑入动画 */
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(100%);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 响应式调整 */
        @media (max-width: 480px) {
            .bottom-comment-input {
                padding: 6px 8px;
            }

            #bottom-comment-text {
                font-size: 16px; /* 防止iOS缩放 */
            }
        }


        
        /* 选择模式样式 */
        .selection-bar {
            position: sticky;
            top: 0;
            background: white;
            border-bottom: 1px solid #f0f0f0;
            z-index: 100;
        }
        
        .selection-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
        }

        /* 动态页面选择模式按钮样式 - 使用更高特异性 */
        .selection-bar .selection-actions .cancel-btn {
            background: rgba(74, 132, 193, 0.85) !important;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3) !important;
            border-radius: 6px;
            color: white !important;
            font-size: 16px;
            cursor: pointer;
            padding: 5px 10px;
            width: auto !important;
            height: auto !important;
            display: inline-block !important;
            white-space: nowrap !important;
        }

        .cute-theme .selection-bar .selection-actions .cancel-btn {
            background: rgba(255, 182, 193, 0.85) !important;
        }

        .selection-count {
            font-size: 14px;
            color: #333;
            font-weight: 500;
        }

        .selection-bar .selection-actions .delete-btn {
            background: rgba(255, 59, 48, 0.85) !important;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3) !important;
            color: white !important;
            border-radius: 6px;
            padding: 5px 10px;
            font-size: 16px;
            cursor: pointer;
            width: auto !important;
            height: auto !important;
            display: inline-block !important;
            white-space: nowrap !important;
        }

        .cute-theme .selection-bar .selection-actions .delete-btn {
            background: rgba(255, 182, 193, 0.85) !important;
        }

        .selection-bar .selection-actions .delete-btn:disabled {
            background: rgba(200, 200, 200, 0.6) !important;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .moment-checkbox {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 24px;
            height: 24px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
        }
        
        .moment-checkbox i {
            font-size: 16px;
            color: #576b95;
        }
        
        .moment-item.selection-mode {
            position: relative;
        }
        
        .moment-item.selected {
            background: rgba(87, 107, 149, 0.1);
            border-left: 3px solid #576b95;
        }
        
        /* 点赞状态样式 */
        .moment-action-btn.liked {
            color: #ff4757;
        }
        
        .moment-action-btn.liked i {
            color: #ff4757;
        }
        
        .moments-header {
            position: relative;
            margin: 0;
        }
        
        .moments-cover {
            position: relative;
            height: 260px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0;
            padding: 0;
        }
        
        .moments-cover:hover {
            filter: brightness(1.1);
        }
        
        .cover-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .cover-image-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            font-weight: 500;
            position: relative;
        }
        
        .cover-image-placeholder::after {
            content: "";
        }
        
        .cover-placeholder-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 18px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.8);
        }
        

        
        .moments-avatar {
            width: 70px;
            height: 70px;
            border-radius: 10px;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            position: absolute;
            top: 210px;
            right: 10px;
            overflow: hidden;
            background-size: cover;
            background-position: center;
            z-index: 100;
        }
        
        .moments-avatar:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .moments-avatar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
            border-radius: inherit;
        }
        
        .moments-avatar:hover::before {
            opacity: 1;
        }
        
        .moments-avatar-icon {
            font-size: 30px;
            color: #ccc;
        }
        
        .moments-username {
            position: absolute;
            top: 230px;
            right: 90px;
            color: white;
            font-weight: 600;
            font-size: 16px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.7);
            cursor: pointer;
            z-index: 200;
            background: none;
            padding: 0;
            border: none;
            transition: all 0.3s ease;
        }
        
        .moments-username:hover {
            transform: scale(1.05);
            text-shadow: 0 2px 8px rgba(0,0,0,0.9);
        }
        

        
        .moments-list {
            background-color: white;
            min-height: calc(100vh - 260px);
            margin: 0;
            padding: 40px 0 0 0;
            position: relative;
            z-index: 10;
        }
        
        .moment-item {
            display: flex;
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .moment-item:first-child {
            margin-top: 10px;
        }
        
        /* 发布动态页面样式 */
        .publish-moment-form {
            padding: 0;
        }

        /* 发表动态页面标题居中，发表按钮保持右侧 */
        #publish-moment-screen .app-header {
            position: relative;
        }

        #publish-moment-screen .app-title {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
        }

        #publish-moment-screen .publish-btn {
            position: absolute;
            right: 20px;
        }

        .publish-btn {
            background: var(--color-primary-green);
            color: white;
            border: none;
            padding: 5px 11px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .publish-btn:hover {
            background: #06a850;
            transform: scale(1.02);
        }
        
        .publish-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .moment-text-input {
            padding: 20px 15px;
            border-bottom: 1px solid #f0f0f0;
            position: relative;
        }
        
        .moment-textarea {
            width: 100%;
            min-height: 120px;
            border: none;
            outline: none;
            font-size: 16px;
            line-height: 1.5;
            resize: none;
            font-family: inherit;
            background: transparent;
            color: #333;
        }
        
        .text-count {
            position: absolute;
            bottom: 8px;
            right: 15px;
            font-size: 12px;
            color: #999;
            background: rgba(255,255,255,0.9);
            padding: 2px 6px;
            border-radius: 4px;
        }        
        .moment-textarea::placeholder {
            color: #999;
        }
        
        .moment-images-section {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .moment-images-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .moment-image-item {
            position: relative;
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            background: #f5f5f5;
        }
        
        .moment-image-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .remove-image-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 20px;
            height: 20px;
            background: rgba(0,0,0,0.6);
            color: white;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
        }
        
        .add-image-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #f8f8f8;
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #666;
        }
        
        .add-image-btn:hover {
            background: #f0f0f0;
            border-color: #ccc;
        }
        
        .add-image-btn i {
            font-size: 24px;
            margin-bottom: 8px;
            color: #999;
        }
        
        .add-image-btn span {
            font-size: 14px;
        }
        
        .publish-options {
            background: white;
        }
        
        .option-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .option-item:hover {
            background: #f8f8f8;
        }
        
        .option-item:last-child {
            border-bottom: none;
        }
        
        .option-item i:first-child {
            width: 20px;
            margin-right: 15px;
            color: #666;
        }
        
        .option-item span {
            font-size: 16px;
            color: #333;
        }

        /* 为了让option-value和selected-mentions正确对齐，标签文字不占用flex空间 */
        .option-item span:first-of-type {
            flex: none;
            margin-right: auto;
        }
        
        .option-value {
            color: #666 !important; /* 改为更深的灰色，从#999改为#666 */
            font-size: 14px !important;
            margin-right: 10px;
            margin-left: auto; /* 添加这行，使文字向右对齐，与头像位置一致 */
        }
        
        .option-item i:last-child {
            color: #ccc;
            font-size: 14px;
        }
        
        .moment-avatar {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background-color: #f0f0f0;
            margin-right: 12px;
            flex-shrink: 0;
            overflow: hidden;
        }
        
        .avatar-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
        }
        
        .moment-content {
            flex: 1;
            min-width: 0;
        }
        
        .moment-username {
            font-weight: 600;
            color: #576b95;
            margin-bottom: 5px;
        }
        
        .moment-text {
            color: #333;
            line-height: 1.5;
            margin-bottom: 8px;
            word-wrap: break-word;
        }
        
        .moment-images {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 3px;
            margin-bottom: 8px;
        }
        
        .moment-images img {
            width: 100%;
            aspect-ratio: 1;
            object-fit: cover;
            border-radius: 4px;
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        .moment-images img:hover {
            transform: scale(1.02);
        }
        
        .moment-image {
            aspect-ratio: 1;
            background-color: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .moment-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .moment-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 8px;
        }
        
        .moment-time-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 8px;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .moment-time {
            font-size: 12px;
            color: #999;
        }
        
        .moment-actions {
            display: flex;
            gap: 15px;
        }
        
        .moment-action-btn {
            background: none;
            border: none;
            color: #576b95;
            font-size: 14px;
            cursor: pointer;
            padding: 5px;
        }
        
        .moment-interactions {
            background-color: #f7f7f7;
            border-radius: 4px;
            padding: 8px;
            margin-top: 8px;
            font-size: 13px;
            display: none;
        }
        
        .moment-interactions.show {
            display: block;
        }
        

        
        /* 面具区域样式 */
        .persona-section {
            margin-bottom: 20px;
        }

        .persona-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            background: rgba(0, 0, 0, 0.02);
            border-radius: 8px;
            padding: 10px 15px 10px 8px;
            margin-bottom: 15px;
        }

        .persona-title h2 {
            margin: 0;
            font-size: 18px;
            color: var(--theme-text-primary, #333);
            font-weight: 600;
        }

        .persona-title p {
            margin: 4px 0 0 0;
            font-size: 13px;
            color: #666;
        }

        .persona-header-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .add-persona-btn-header {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: #f2f2f7;
            color: #6B9BD2;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 16px;
        }

        .add-persona-btn-header:hover {
            background: #e5e5ea;
            transform: scale(1.05);
        }

        .add-persona-btn-header:active {
            background: #d1d1d6;
            transform: scale(0.95);
        }

        .persona-toggle {
            transition: transform 0.2s ease;
            cursor: pointer;
            padding: 4px;
        }

        #persona-chevron.expanded {
            transform: rotate(180deg);
        }

        .persona-content {
            padding: 0;
            animation: slideDown 0.3s ease-out;
        }
        
        .persona-list {
            flex: 1;
            overflow-y: auto;
            padding: 10px 0;
        }
        
        .persona-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background-color 0.2s ease;
            position: relative;
        }
        
        .persona-item:hover {
            background-color: #f5f5f5;
        }
        
        .persona-item.active {
            background-color: var(--bg-blue-05);
            border-left: 3px solid #007AFF;
        }
        
        .persona-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--theme-avatar-bg-1, #f0f2f5), var(--theme-avatar-bg-2, #e8ebf0));
            margin-right: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--theme-avatar-text, #8b9dc3);
            font-weight: bold;
            font-size: 18px;
            background-size: cover;
            background-position: center;
            border: 2px solid var(--theme-avatar-border, rgba(255, 255, 255, 0.8));
            flex-shrink: 0;
            transition: border-radius 0.3s ease;
        }

        .persona-avatar.rounded-square {
            border-radius: 20%;
        }
        
        .persona-info {
            flex: 1;
            min-width: 0;
        }
        
        .persona-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 5px;
            color: var(--theme-text-primary, #333);
        }
        
        .persona-description {
            font-size: 13px;
            color: #666;
            line-height: 1.4;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .persona-actions {
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }
        
        .persona-action-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .persona-edit-btn {
            background: transparent;
            color: #6B9BD2;
        }

        .persona-edit-btn:hover {
            background: rgba(107, 155, 210, 0.1);
        }

        .persona-delete-btn {
            background: transparent;
            color: #FF3B30;
        }

        .persona-delete-btn:hover {
            background: rgba(255, 59, 48, 0.1);
        }
        
        .current-persona {
            border-top: 1px solid #eee;
            background: var(--theme-form-bg, rgba(255, 255, 255, 0.9));
            padding: 0;
        }
        
        .current-persona .menu-item {
            border-bottom: none;
            margin: 0;
        }
        
        .current-persona-name {
            font-weight: 500;
            color: #007AFF;
            font-size: 14px;
        }
        
        /* 多选模式样式 */
        .contact-item.selected {
            background-color: rgba(0, 123, 255, 0.1);
            border-left: 3px solid #007AFF;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            transition: background-color 0.2s ease;
        }
        
        /* 聊天选项样式 */
        .chat-option-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background-color 0.2s ease;
            position: relative;
        }
        
        .chat-option-item:hover {
            background-color: #f5f5f5;
        }
        
        .chat-option-item:last-child {
            border-bottom: none;
        }
        
        /* 已存在对话的角色样式 */
        .chat-option-item.has-existing-chat {
            background-color: #fff8e1;
            border-left: 3px solid #ff9800;
        }
        
        .chat-option-item.has-existing-chat:hover {
            background-color: #fff3c4;
        }
        
        /* 已有对话标记 */
        .chat-exists-badge {
            background-color: #ff9800;
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 8px;
            font-weight: 500;
        }

        /* === 分组样式 === */

        .group-header {
            background: linear-gradient(135deg, #f8f9ff 0%, #e6f0ff 100%);
            padding: 12px 15px;
            border-bottom: 1px solid rgba(0, 122, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 122, 255, 0.08);
        }







        .group-title-area {
            display: flex;
            align-items: center;
            cursor: pointer;
            flex: 1;
            padding: 2px 0;
            border-radius: 4px;
            transition: all 0.2s ease;
        }



        .group-chevron {
            margin-right: 10px;
            color: #007AFF;
            font-size: 11px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: rgba(0, 122, 255, 0.1);
        }

        .group-title {
            font-weight: 600;
            font-size: 15px;
            color: #1a1a1a;
            margin-right: 8px;
            letter-spacing: 0.3px;
            display: flex;
            align-items: center;
        }



        .group-count {
            font-size: 11px;
            color: #007AFF;
            background: rgba(0, 122, 255, 0.1);
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: 500;
            margin-left: auto;
            min-width: 24px;
            text-align: center;
        }

        .group-interaction-icon {
            color: #FF6B35;
            font-size: 12px;
            margin-left: 6px;
        }

        .group-manage-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .edit-group-btn, .delete-group-btn {
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .edit-group-btn {
            background: rgba(0, 122, 255, 0.6);
            color: white;
        }

        .delete-group-btn {
            background: rgba(255, 59, 48, 0.6);
            color: white;
        }

        .edit-group-btn:hover {
            background: rgba(0, 122, 255, 0.8);
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(0, 122, 255, 0.3);
        }

        .delete-group-btn:hover {
            background: rgba(255, 59, 48, 0.8);
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(255, 59, 48, 0.3);
        }

        .group-characters {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            margin-bottom: 12px;
            padding-bottom: 8px;
        }



        .group-manage-header, .multiselect-header {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 12px 15px;
            border-bottom: 1px solid var(--color-border-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .multiselect-info {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .multiselect-icon {
            color: #007AFF;
            font-size: 16px;
        }

        .multiselect-text {
            font-weight: 500;
            color: #333;
            font-size: 14px;
        }

        .multiselect-actions {
            display: flex;
            gap: 8px;
        }

        .multiselect-btn {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 60px;
            justify-content: center;
        }

        .multiselect-btn i {
            font-size: 11px;
        }

        .multiselect-btn span {
            font-size: 12px;
        }

        .move-btn {
            background: rgba(0, 122, 255, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
        }

        .move-btn:hover {
            background: rgba(0, 122, 255, 0.8);
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(0, 122, 255, 0.3);
        }

        /* 角色分组页面多选按钮样式 - 使用更高特异性 */
        .multiselect-header .multiselect-actions .multiselect-btn.delete-btn,
        .group-manage-header .group-manage-actions .multiselect-btn.delete-btn {
            background: rgba(255, 59, 48, 0.6) !important;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3) !important;
            color: white !important;
        }

        .multiselect-header .multiselect-actions .multiselect-btn.delete-btn:hover,
        .group-manage-header .group-manage-actions .multiselect-btn.delete-btn:hover {
            background: rgba(255, 59, 48, 0.8) !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 59, 48, 0.3);
        }

        .multiselect-header .multiselect-actions .multiselect-btn.cancel-btn,
        .group-manage-header .group-manage-actions .multiselect-btn.cancel-btn {
            background: rgba(74, 132, 193, 0.6) !important;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3) !important;
            color: white !important;
        }

        .cute-theme .multiselect-header .multiselect-actions .multiselect-btn.cancel-btn,
        .cute-theme .group-manage-header .group-manage-actions .multiselect-btn.cancel-btn {
            background: rgba(255, 182, 193, 0.6) !important;
        }

        .multiselect-header .multiselect-actions .multiselect-btn.cancel-btn:hover,
        .group-manage-header .group-manage-actions .multiselect-btn.cancel-btn:hover {
            background: rgba(74, 132, 193, 0.8) !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(74, 132, 193, 0.3);
        }

        .cute-theme .multiselect-header .multiselect-actions .multiselect-btn.cancel-btn:hover,
        .cute-theme .group-manage-header .group-manage-actions .multiselect-btn.cancel-btn:hover {
            background: rgba(255, 182, 193, 0.8) !important;
            box-shadow: 0 4px 12px rgba(255, 182, 193, 0.3);
        }

        .multiselect-header .multiselect-actions .multiselect-btn.move-btn {
            background: rgba(74, 132, 193, 0.6) !important;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3) !important;
            color: white !important;
        }

        .cute-theme .multiselect-header .multiselect-actions .multiselect-btn.move-btn {
            background: rgba(255, 182, 193, 0.6) !important;
        }

        .multiselect-header .multiselect-actions .multiselect-btn.move-btn:hover {
            background: rgba(74, 132, 193, 0.8) !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(74, 132, 193, 0.3);
        }

        .cute-theme .multiselect-header .multiselect-actions .multiselect-btn.move-btn:hover {
            background: rgba(255, 182, 193, 0.8) !important;
            box-shadow: 0 4px 12px rgba(255, 182, 193, 0.3);
        }

        .group-manage-info {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .group-manage-icon {
            color: #6C757D;
            font-size: 16px;
        }

        .group-manage-text {
            font-weight: 500;
            color: #333;
            font-size: 14px;
        }

        .group-manage-actions {
            display: flex;
            gap: 8px;
        }

        .create-btn {
            background: #28A745;
            color: white;
        }

        .create-btn:hover {
            background: #1E7E34;
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(40, 167, 69, 0.3);
        }

        .done-btn {
            background: #007AFF;
            color: white;
        }

        .done-btn:hover {
            background: #0056CC;
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(0, 122, 255, 0.3);
        }

        /* 小屏幕适配 */
        @media (max-width: 480px) {
            .multiselect-header, .group-manage-header {
                flex-direction: column;
                gap: 12px;
                align-items: stretch;
            }

            .multiselect-header .multiselect-actions,
            .group-manage-header .group-manage-actions {
                justify-content: center;
                flex-wrap: wrap;
            }

            .multiselect-btn {
                flex: 1;
                min-width: 80px;
                max-width: 100px;
            }

            .multiselect-text, .group-manage-text {
                font-size: 13px;
            }

            /* 确保动态页面选择模式按钮保持水平布局 */
            .selection-bar .selection-actions {
                display: flex !important;
                flex-direction: row !important;
                justify-content: space-between !important;
                align-items: center !important;
                flex-wrap: nowrap !important;
            }
        }

        .move-group-btn, .create-group-btn {
            background: #f0f0f0;
            color: #333;
            border: 1px solid #ddd;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            margin-right: 8px;
            transition: all 0.2s ease;
        }

        .move-group-btn:hover, .create-group-btn:hover {
            background: #e0e0e0;
            border-color: #ccc;
        }

        .move-character-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: rgba(0, 123, 255, 0.1);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-left: 8px;
        }

        .move-character-btn:hover {
            background: rgba(0, 123, 255, 0.2);
            transform: scale(1.1);
        }

        .move-character-btn i {
            color: #007AFF;
            font-size: 12px;
        }

        .empty-group-message {
            padding: 20px;
            text-align: center;
            color: #999;
            font-size: 14px;
            background: linear-gradient(135deg, #f9f9f9 0%, #f5f5f5 100%);
            border: 1px dashed #ddd;
            border-radius: 8px;
            margin: 10px;
            position: relative;
        }

        .empty-group-message::before {
            content: '📝';
            display: block;
            font-size: 24px;
            margin-bottom: 8px;
            opacity: 0.6;
        }

        /* 梦幻照片样式 */
        .dreamy-photo-container {
            position: relative;
            display: inline-block;
            cursor: pointer;
            max-width: 200px;
            border-radius: 12px;
            overflow: hidden;
            margin: 8px 0;
        }
        
        .dreamy-photo {
            position: relative;
            width: 200px;
            height: 150px;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .dreamy-photo:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .photo-misty-bg {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.9) 0%, 
                rgba(240, 248, 255, 0.8) 30%, 
                rgba(230, 235, 250, 0.7) 60%, 
                rgba(255, 255, 255, 0.9) 100%);
            backdrop-filter: blur(2px);
        }
        
        .photo-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: transparent;
            backdrop-filter: none;
            border-radius: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 4;
            transition: all 0.3s ease;
            box-shadow: none;
        }
        
        .photo-badge i {
            font-size: 12px;
            color: #666;
            opacity: 0.7;
        }
        
        .dreamy-photo:hover .photo-badge {
            background: transparent;
            transform: scale(1.1);
        }
        
        .dreamy-photo:hover .photo-badge i {
            opacity: 1;
            color: #555;
        }
        
        .sparkle-container {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 2;
            transition: opacity 0.3s ease;
        }
        
        .sparkle {
            position: absolute;
            font-size: 14px;
            opacity: 0.6;
        }
        
        .sparkle-1 {
            top: 20%;
            left: 25%;
        }
        
        .sparkle-2 {
            top: 30%;
            right: 20%;
        }
        
        .sparkle-3 {
            bottom: 35%;
            left: 15%;
        }
        
        .sparkle-4 {
            bottom: 25%;
            right: 30%;
        }
        
        .sparkle-5 {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        .photo-text-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(4px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3;
            transition: all 0.3s ease;
            border-radius: 12px;
        }
        
        .photo-description {
            padding: 16px;
            text-align: center;
            color: #333;
            font-size: 14px;
            line-height: 1.4;
            max-height: 90%;
            overflow-y: auto;
        }

        /* 分组选项样式 */
        .group-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .group-option {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .group-option:hover {
            background-color: #f8f9fa;
        }

        .group-option:last-child {
            border-bottom: none;
        }

        .group-name {
            font-weight: 500;
            color: var(--color-text);
        }

        .group-option i {
            color: #ccc;
            font-size: 12px;
        }

        /* 表单样式增强 */
        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            font-weight: 500;
            margin-bottom: 6px;
            color: var(--color-text);
        }

        .form-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.2s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #007AFF;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.1);
        }

        .form-checkbox {
            margin-right: 8px;
        }

        .form-help-text {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
            margin-bottom: 0;
        }
        
        /* 对话状态指示器 */
        .chat-status-indicator {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 10px;
            color: #ff9800;
            margin-left: auto;
            text-align: center;
        }
        
        .chat-status-indicator i {
            font-size: 16px;
            margin-bottom: 2px;
        }
        
        .chat-option-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 15px;
            font-size: 18px;
        }
        
        .chat-option-text {
            flex: 1;
        }
        
        .chat-option-title {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 3px;
        }
        
        .chat-option-desc {
            font-size: 13px;
            color: #666;
        }
        
        /* 群聊成员选择样式 */
        .group-member-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .group-member-item:hover {
            background-color: #f5f5f5;
        }
        
        .group-member-item.selected {
            background-color: rgba(0, 123, 255, 0.1);
        }
        
        .group-member-checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid #007AFF;
            border-radius: 3px;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .group-member-checkbox.checked {
            background-color: #007AFF;
            color: white;
        }
        
        /* 新聊天设置界面样式 */
        .settings-container {
            padding: 0;
            background-color: #f8f9fa;
        }
        
        .settings-section {
            margin-bottom: 20px;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            padding: 15px 20px 10px 20px;
            background-color: #f8f9fa;
        }
        
        .section-icon {
            font-size: 16px;
            color: var(--theme-button-bg, #4a84c1);
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        
        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .setting-card {
            background: white;
            border-radius: 12px;
            margin: 0 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            border: 1px solid rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }
        
        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            border-bottom: 1px solid #f5f5f5;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .setting-item:last-child {
            border-bottom: none;
        }
        
        .setting-item:hover {
            background-color: #f8f9fa;
        }
        
        .setting-item.danger-item:hover {
            background-color: var(--theme-button-secondary-hover-bg, rgba(0, 0, 0, 0.05));
        }
        
        .setting-left {
            flex: 1;
            min-width: 0;
        }
        
        .setting-right {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
        }
        
        .setting-label {
            font-size: 16px;
            font-weight: 500;
            color: #333;
            margin-bottom: 2px;
        }
        
        .setting-desc {
            font-size: 13px;
            color: #666;
            line-height: 1.4;
        }
        
        .setting-value {
            font-size: 14px;
            color: #666;
            margin-right: 5px;
        }
        
        .setting-select {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            background: white;
            color: #333;
            min-width: 120px;
        }
        
        /* 开关按钮样式 */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 28px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.3s;
            border-radius: 28px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .toggle-switch input:checked + .toggle-slider {
            background-color: var(--theme-button-bg, #4a84c1);
        }
        
        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(22px);
        }
        
        /* 聊天模式切换样式 */
        .chat-mode-switch {
            display: flex;
            background: var(--bg-white-50);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--bg-black-10);
            border-radius: 12px;
            padding: 4px;
            margin: 12px 20px;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
        }
        
        .chat-mode-option {
            flex: 1;
            position: relative;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .chat-mode-option input[type="radio"] {
            display: none;
        }
        
        .chat-mode-option label {
            display: block;
            padding: 10px 16px;
            text-align: center;
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            background: transparent;
            color: rgba(0, 0, 0, 0.6);
            position: relative;
            overflow: hidden;
        }
        
                .chat-mode-option input[type="radio"]:checked + label {
            background: var(--bg-white-90);
            color: var(--theme-button-bg, #4a84c1);
            font-weight: 600;
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }

        .chat-mode-option label:hover {
            background: var(--bg-white-50);
        }
        
        /* 线下模式字数控制 */
        .offline-length-control {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 12px 20px;
            padding: 8px 12px;
            background: var(--theme-form-bg);
            backdrop-filter: blur(5px);
            border-radius: 8px;
            border: 1px solid var(--bg-black-05);
            transition: all 0.3s ease;
        }
        
        .control-label, .control-unit {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }
        
        .offline-length-control input[type="number"] {
            width: 60px;
            padding: 4px 8px;
            border: 1px solid var(--theme-input-border);
            border-radius: 6px;
            background: var(--bg-white-80);
            font-size: 12px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .offline-length-control input[type="number"]:focus {
            outline: none;
            border-color: var(--theme-button-bg, #4a84c1);
            box-shadow: 0 0 0 2px rgba(74, 132, 193, 0.2);
        }
        
        /* 后台互动详细设置 */
        .background-interaction-details {
            border-top: 1px solid #f5f5f5;
            margin-top: 0;
            padding-top: 0;
        }
        
        .background-interaction-details .setting-item {
            border-bottom: 1px solid #f8f8f8;
        }
        
        .background-interaction-details .setting-item:last-child {
            border-bottom: none;
        }
        
        /* 社交动态设置详细选项 */
        .weibo-settings {
            border-top: 1px solid #f5f5f5;
            margin-top: 0;
            padding-top: 0;
        }
        
        /* 功能说明样式 */
        .setting-explanation {
            background: var(--setting-card-bg);
            backdrop-filter: blur(5px);
            border-radius: 8px;
            margin: 12px 20px;
            padding: 12px 16px;
            border: 1px solid var(--bg-black-05);
        }
        
        .explanation-text {
            font-size: 12px;
            color: #555;
            line-height: 1.5;
        }
        
        .explanation-text strong {
            color: #333;
            font-weight: 600;
        }
        
        /* 头像设置样式 */
        .avatar-setting-group {
            margin-bottom: 25px;
        }

        .avatar-preview-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        /* 头像形状选择样式 - 简洁版 */
        .avatar-shape-options {
            display: flex;
            gap: 12px;
            margin-top: 10px;
        }

        .shape-radio-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 6px;
            border: 1px solid #ddd;
            background: #fff;
            transition: all 0.2s ease;
            user-select: none;
            flex: 1;
            justify-content: center;
        }

        .shape-radio-option:hover {
            border-color: #007AFF;
            background: rgba(0, 122, 255, 0.05);
        }

        .shape-radio-option.selected {
            border-color: #007AFF;
            background: rgba(0, 122, 255, 0.1);
            color: #007AFF;
        }

        .shape-radio-option input[type="radio"] {
            margin-right: 8px;
            accent-color: #007AFF;
        }

        .shape-radio-text {
            font-size: 14px;
            font-weight: 500;
            color: inherit;
        }
        
        .avatar-preview-container .avatar-preview {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f0f2f5, #e8ebf0);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: #999;
            background-size: cover;
            background-position: center;
            border: 3px solid var(--theme-avatar-border);
            box-shadow: var(--shadow-lg);
        }
        
        /* 背景预览样式 */
        .background-preview-container {
            margin-bottom: 20px;
        }
        
        .background-preview {
            width: 100%;
            height: 200px;
            border-radius: 12px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed #ddd;
            background-size: cover;
            background-position: center;
            position: relative;
            overflow: hidden;
        }
        
        .preview-text {
            color: #999;
            font-size: 14px;
            font-weight: 500;
        }
        
        /* 增强的颜色选择器样式 */
        .color-setting-group {
            margin-bottom: 25px;
            padding: 20px;
            background: var(--theme-form-bg);
            border-radius: 12px;
            border: 1px solid var(--bg-black-05);
        }
        
        /* 自定义表情包样式 */
        .custom-emoji-panel {
            position: fixed;
            bottom: 60px;
            left: 8px;
            right: 8px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.15);
            padding: 15px;
            display: none;
            z-index: 999;
            max-height: 300px;
            overflow-y: auto;
            max-width: 344px;
            margin: 0 auto;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .emoji-tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .emoji-tab {
            padding: 8px 12px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            font-size: 14px;
            color: #666;
            transition: all 0.2s ease;
        }
        
        .emoji-tab.active {
            color: #007AFF;
            border-bottom-color: #007AFF;
        }
        
        .emoji-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 15px;
            padding: 8px;
        }
        
        .custom-emoji-item {
            aspect-ratio: 1;
            border-radius: 8px;
            background-size: cover;
            background-position: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s ease;
            position: relative;
            overflow: visible !important;
        }
        
        .custom-emoji-item:hover {
            border-color: #007AFF;
            transform: scale(1.05);
        }
        
        .custom-emoji-item.placeholder {
            background: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #999;
            border: 2px dashed #ddd;
            overflow: hidden;
        }
        
        .custom-emoji-item.placeholder:hover {
            background: #eee;
            border-color: #007AFF;
        }
        
        .emoji-delete-btn {
            position: absolute;
            top: -4px;
            right: -4px;
            width: 14px;
            height: 14px;
            background: rgba(255, 255, 255, 0.9) !important;
            color: #666 !important;
            border-radius: 50% !important;
            border: none !important;
            cursor: pointer !important;
            font-size: 10px !important;
            font-weight: normal !important;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif !important;
            line-height: 1 !important;
            display: none !important;
            align-items: center !important;
            justify-content: center !important;
            backdrop-filter: blur(10px) !important;
            -webkit-backdrop-filter: blur(10px) !important;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1) !important;
            transition: all 0.2s ease !important;
            z-index: 10 !important;
        }
        
        .custom-emoji-item:hover .emoji-delete-btn {
            display: flex !important;
        }
        
        .emoji-delete-btn:hover {
            background: rgba(255, 255, 255, 1) !important;
            color: #ff3b30 !important;
            transform: scale(1.1) !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;
        }
        
        .emoji-delete-btn:active {
            transform: scale(0.9) !important;
            background: rgba(255, 59, 48, 0.1) !important;
        }
        
        /* 移动端适配 */
        @media (max-width: 768px) {
            .emoji-delete-btn {
                width: 16px !important;
                height: 16px !important;
                display: flex !important;
                font-size: 12px !important;
            }
            
            .emoji-delete-btn:active {
                background: rgba(255, 255, 255, 1) !important;
                color: #ff3b30 !important;
                transform: scale(0.9) !important;
            }
        }
        
        .color-picker-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .color-input {
            width: 60px;
            height: 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .color-preview {
            width: 100px;
            height: 40px;
            border-radius: 8px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: 500;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        .opacity-setting {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .opacity-setting label {
            font-size: 14px;
            color: #666;
            font-weight: 500;
        }
        
        .opacity-setting input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }
        
        .opacity-setting input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--theme-button-bg, #4a84c1);
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        /* 气泡预览演示 */
        .bubble-preview-demo {
            margin-top: 20px;
            padding: 20px;
            background: var(--bubble-demo-bg);
            border-radius: 12px;
            border: 1px solid var(--bg-black-05);
        }
        
        .demo-message {
            margin-bottom: 15px;
            display: flex;
        }
        
        .demo-message.my-message {
            justify-content: flex-end;
        }
        
        .demo-message.ai-message {
            justify-content: flex-start;
        }
        
        .demo-bubble {
            padding: 10px 15px;
            border-radius: 18px;
            font-size: 14px;
            max-width: 200px;
            word-wrap: break-word;
        }
        
        /* 定时发布时间点样式 */
        .schedule-time-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            padding: 8px 12px;
            background: var(--schedule-item-bg);
            border-radius: 8px;
            border: 1px solid var(--bg-black-05);
        }
        
        .schedule-time-item input[type="time"] {
            padding: 4px 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .schedule-time-item button {
            background: #ff3b30;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        
        /* 社交设置详细选项 */
        .social-settings {
            border-top: 1px solid #f5f5f5;
            margin-top: 0;
            padding-top: 0;
        }
        
        /* 主题化滑块样式 */
        .theme-range {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(var(--theme-button-bg-rgb, 74, 132, 193), 0.2);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .theme-range::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--theme-button-bg, #4a84c1);
            cursor: pointer;
            box-shadow: var(--shadow-md);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: var(--slider-thumb-border);
            transition: all 0.3s ease;
        }
        
        .theme-range::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .theme-range::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--theme-button-bg, #4a84c1);
            cursor: pointer;
            border: var(--slider-thumb-border);
            box-shadow: var(--shadow-md);
        }
        
        /* 设置范围容器 */
        .setting-range-container {
            margin: 15px 20px;
        }
        
        .range-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 12px;
            color: #666;
        }
        
        /* 自定义输入容器 */
        .custom-input-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 15px 20px;
            padding: 12px 16px;
            background: var(--custom-input-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 10px;
            border: 1px solid var(--bg-black-05);
        }
        
        /* API设置模型选择框样式 */
        #model-select {
            max-height: 200px !important;
            overflow-y: auto !important;
            scrollbar-width: thin;
            scrollbar-color: rgba(0, 0, 0, 0.3) transparent;
            width: 100% !important;
            max-width: calc(100vw - 160px) !important; /* 预留拉取模型按钮的空间 */
            box-sizing: border-box !important;
        }
        
        /* 模型选择框的option样式 */
        #model-select option {
            padding: 8px 12px !important;
            white-space: nowrap !important;
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            max-width: 100% !important;
            box-sizing: border-box !important;
        }
        
        /* 确保模型选择框的容器不超出屏幕 */
        #model-select[style*="flex: 1"] {
            min-width: 0 !important;
            flex-shrink: 1 !important;
        }
        
        #model-select::-webkit-scrollbar {
            width: 6px;
        }
        
        #model-select::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 3px;
        }
        
        #model-select::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 3px;
        }
        
        #model-select::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.5);
        }
        
        /* API配置卡片样式 */
        .config-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
            position: relative;
            overflow: hidden;
        }
        
        .config-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.5s;
        }
        
        .config-card:hover {
            transform: translateY(-3px) !important;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15) !important;
            border-color: rgba(74, 132, 193, 0.3) !important;
        }
        
        .config-card:hover::before {
            left: 100%;
        }
        
        .config-card:active {
            transform: translateY(-1px) !important;
            transition: transform 0.1s !important;
        }
        
        /* API设置表单输入框焦点状态 */
        input[type="text"]:focus,
        input[type="password"]:focus,
        select:focus {
            outline: none !important;
            border-color: var(--theme-input-focus, rgba(0, 123, 255, 0.5)) !important;
            background: var(--theme-form-bg, rgba(255, 255, 255, 0.95)) !important;
            box-shadow: 0 0 0 3px var(--theme-input-focus-shadow, rgba(0, 123, 255, 0.1)) !important;
            transform: translateY(-1px) !important;
        }
        
        /* 温度滑块样式增强 */
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--theme-button-bg, #4a84c1);
            cursor: pointer;
            box-shadow: var(--shadow-md);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: var(--slider-thumb-border);
            transition: all 0.3s ease;
        }
        
        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--theme-button-bg, #4a84c1);
            cursor: pointer;
            border: var(--slider-thumb-border);
            box-shadow: var(--shadow-md);
        }
        
        /* 按钮悬停效果增强 */
        button:hover {
            transform: translateY(-2px) !important;
        }
        
        button:active {
            transform: translateY(0) !important;
        }
        
        .input-label, .input-unit {
            font-size: 13px;
            color: #666;
            font-weight: 500;
        }
        
        .theme-input {
            width: 80px;
            padding: 6px 10px;
            border: 1px solid var(--theme-input-border);
            border-radius: 8px;
            font-size: 13px;
            background: var(--input-white-bg);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .theme-input:focus {
            outline: none;
            border-color: var(--theme-button-bg, #4a84c1);
            box-shadow: 0 0 0 2px rgba(var(--theme-button-bg-rgb, 74, 132, 193), 0.2);
            background: rgba(255, 255, 255, 1);
        }
        
        /* 主题化按钮 */
        .theme-button {
            padding: 10px 20px;
            border-radius: var(--theme-button-radius, 8px);
            border: none;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .theme-button-primary {
            background: var(--theme-button-bg-rgba);
            color: var(--theme-button-color, white);
            border: 1px solid var(--border-light);
        }
        
        .theme-button-primary:hover {
            background: var(--theme-button-bg-hover, rgba(74, 132, 193, 1));
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
                .theme-button-secondary {
            background: var(--theme-button-secondary-bg-rgba);
            color: #666;
            border: 1px solid var(--bg-black-10);
        }

        .theme-button-secondary:hover {
            background: rgba(255, 255, 255, 0.95);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* CSS变量支持 */
        :root {
            --theme-button-bg-rgb: 74, 132, 193;
        }
        
        body[data-theme="cute"] {
            --theme-button-bg-rgb: 255, 182, 193;
        }
        
        /* 可爱主题的header特殊样式 */
        body[data-theme="cute"] .app-header {
            border-bottom: 1px solid #ffccd5;
            background-color: rgba(255, 230, 240, 0.8) !important;
            backdrop-filter: blur(10px) !important;
            -webkit-backdrop-filter: blur(10px) !important;
        }
        
        /* 可爱主题的工具面板样式 */
        body[data-theme="cute"] .tools-panel {
            background: var(--bg-white-95);
            border: 1px solid rgba(255, 182, 193, 0.3);
        }
        
        body[data-theme="cute"] .tool-icon {
            background: var(--theme-button-bg-rgba);
        }
        
        body[data-theme="cute"] .tool-item:hover::before {
            background: rgba(255, 182, 193, 0.2);
        }

        /* 重新生成工具按钮特殊样式 */
        #regenerate-tool-item .tool-icon {
            background: var(--theme-button-bg, #4a84c1);
            color: white;
            opacity: 1;
        }

        #regenerate-tool-item:hover .tool-icon {
            background: var(--theme-button-bg-hover, #3a74b1);
            opacity: 1;
        }

        /* 重新生成按钮图标旋转动画 */
        #regenerate-tool-item:hover .tool-icon i {
            transform: rotate(180deg);
            transition: transform 0.3s ease;
        }

        /* 可爱主题下的重新生成按钮 */
        body[data-theme="cute"] #regenerate-tool-item .tool-icon {
            background: var(--theme-button-bg-rgba, rgba(255, 182, 193, 0.9));
        }

        body[data-theme="cute"] #regenerate-tool-item:hover .tool-icon {
            background: var(--theme-button-bg-hover, rgba(255, 162, 173, 0.9));
        }
        

        
        /* 响应式设计优化 */
        @media (max-width: 400px) {
            .tools-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 12px;
            }
            
            .tool-item {
                padding: 10px 6px;
            }
            
            .tool-icon {
                width: 32px;
                height: 32px;
                font-size: 14px;
            }
            
            .tool-label {
                font-size: 10px;
            }
        }
        

        
        
        
        
        /* 戳一戳系统消息样式 */
        .poke-system-message {
            text-align: center;
            color: #999;
            font-size: 13px;
            padding: 6px 12px;
            margin: 4px auto;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 12px;
            display: inline-block;
            max-width: 200px;
        }
        
        .poke-system-container {
            text-align: center;
            margin: 4px 0;
        }
        
        /* 移除重复的选中样式 - 现在只使用头像上的勾号 */
        
        /* 选择模式下的消息容器样式 */
        .message-container.selected {
            /* 保持选中状态，由其他样式控制选中效果 */
            background: none;
        }
        
        /* 主题样式定义在后面统一处理 */
        

        

        
        /* 聊天消息界面使用和完成.html一样的header样式 */
        #api-chat-screen .header {
            display: flex !important;
        }
        
        #api-chat-screen .header .default-controls, #api-chat-screen .header .selection-controls { 
            display: contents;
        }
        
        #api-chat-screen.selection-mode .default-controls { 
            display: none;
        }
        
        #api-chat-screen:not(.selection-mode) .selection-controls { 
            display: none;
        }
        
        #selection-cancel-btn, #selection-delete-btn {
            font-size: 13px;
            cursor: pointer;
            padding: 6px 12px;
            transition: all 0.2s ease;
            border-radius: 16px;
            font-weight: 500;
            min-width: 50px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* 简约经典主题 - 雾霾蓝取消按钮 */
        #selection-cancel-btn {
            background: rgba(74, 132, 193, 0.6);
            color: white;
        }

        /* 简约经典主题 - 雾霾红删除按钮 */
        #selection-delete-btn {
            background: rgba(255, 59, 48, 0.6);
            color: white;
        }

        /* 可爱风主题 - 雾霾粉取消按钮 */
        .cute-theme #selection-cancel-btn {
            background: rgba(255, 182, 193, 0.6);
            color: white;
        }

        /* 可爱风主题 - 雾霾红删除按钮 */
        .cute-theme #selection-delete-btn {
            background: rgba(255, 59, 48, 0.6);
            color: white;
        }

        #selection-count {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            padding: 0 8px;
            white-space: nowrap;
        }

        #selection-cancel-btn:hover {
            background: rgba(74, 132, 193, 0.8);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(74, 132, 193, 0.3);
        }

        .cute-theme #selection-cancel-btn:hover {
            background: rgba(255, 182, 193, 0.8);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 182, 193, 0.3);
        }

        #selection-delete-btn:hover {
            background: rgba(255, 59, 48, 0.8);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 59, 48, 0.3);
        }

        #selection-cancel-btn:active,
        #selection-delete-btn:active {
            transform: scale(0.95);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        /* 消息选中状态样式 */
        .message-container.selected .message-avatar::after { 
            content: '✔'; 
            position: absolute; 
            bottom: -5px; 
            right: -5px; 
            background-color: var(--theme-button-bg, #4a84c1); 
            color: white; 
            width: 20px; 
            height: 20px; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 12px; 
            font-weight: bold; 
            z-index: 10; 
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); 
        }
        
        .message-container.sent.selected .message-avatar::after { 
            bottom: -5px; 
            left: -5px; 
            right: auto;
        }
        
        /* 可爱主题下的选中标记 */
        body[data-theme="cute"] .message-container.selected .message-avatar::after {
            background-color: var(--theme-button-bg, #ffb6c1);
        }
        
        /* 移除消息容器选中时的背景 */
        .message-container.selected {
            background: none !important;
        }

        /* 隐藏头像时的选中标记 */
        .message-container.selected.no-avatar::before {
            content: '✔';
            position: absolute;
            right: -25px;
            top: 50%;
            transform: translateY(-50%);
            background-color: var(--theme-button-bg, #4a84c1);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .message-container.sent.selected.no-avatar::before {
            right: auto;
            left: -25px;
        }
        
        .poke-icon {
            margin-right: 8px;
            color: #ff69b4;
            animation: pokeWave 1s ease-in-out;
        }
        
        @keyframes pokeShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }
        
        @keyframes pokeWave {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }
        
        /* 头像戳一戳提示 */
        .message-avatar {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .message-avatar:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        /* 时间戳设置样式 */
        .timestamp-position-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 10px;
        }

        .radio-option {
            display: flex;
            align-items: flex-start;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
        }

        .radio-option:hover {
            border-color: var(--theme-button-bg, #007AFF);
            background: rgba(var(--theme-button-bg-rgb, 0, 122, 255), 0.05);
        }

        .radio-option input[type="radio"] {
            display: none;
        }

        .radio-custom {
            width: 20px;
            height: 20px;
            border: 2px solid #ccc;
            border-radius: 50%;
            margin-right: 12px;
            margin-top: 2px;
            position: relative;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .radio-option input[type="radio"]:checked + .radio-custom {
            border-color: var(--theme-button-bg, #007AFF);
            background-color: var(--theme-button-bg, #007AFF);
        }

        .radio-option input[type="radio"]:checked + .radio-custom::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: white;
        }

        .option-content {
            flex: 1;
        }

        .option-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
            font-size: 15px;
        }

        .option-desc {
            font-size: 13px;
            color: #666;
            line-height: 1.4;
            white-space: pre-line;
            word-wrap: break-word;
            max-height: 4.2em; /* 约3行的高度 */
            overflow: hidden;
        }

        .radio-option input[type="radio"]:checked + .radio-custom + .option-content .option-label {
            color: var(--theme-button-bg, #007AFF);
        }

        /* 悬浮按钮样式 */
        .floating-actions {
            position: absolute;
            right: 20px;
            bottom: 80px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 100;
        }

        .floating-btn {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
            position: relative;
            overflow: hidden;
        }

        .floating-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
            border-radius: 50%;
            z-index: -1;
        }

        .floating-btn:hover {
            transform: translateY(-2px) scale(1.08);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.18);
        }
        
        #smart-reply-btn:hover {
            opacity: 0.65 !important;
        }

        .floating-btn:active {
            transform: translateY(0) scale(0.98);
            transition: all 0.15s ease;
        }

        /* 智能回复按钮 */
        #smart-reply-btn {
            background: var(--floating-btn-secondary-bg);
            color: var(--theme-button-secondary-color, #555);
            border: 1px solid var(--theme-button-secondary-border, rgba(0, 0, 0, 0.05));
        }

        #smart-reply-btn:hover {
            background: var(--floating-btn-secondary-bg-hover);
        }

        /* 主题特定悬浮按钮样式现在通过CSS变量统一管理 */

        /* 按钮图标动画 */

        #smart-reply-btn i {
            transition: transform 0.3s ease;
        }

        #smart-reply-btn:hover i {
            transform: scale(1.1);
        }

        /* 悬浮按钮出现动画 */
        @keyframes floatIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .floating-btn {
            animation: floatIn 0.5s cubic-bezier(0.4, 0.0, 0.2, 1);
            opacity: 0;
            transform: translateY(20px) scale(0.8);
        }

        .floating-btn:not(.hidden) {
            opacity: 0.6;
            transform: translateY(0) scale(1);
        }

        /* 消息滑入动画关键帧 - 简单自然的滑入效果 */
        @keyframes messageSlideIn {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 电影字幕滚动效果 - 专门用于语音通话 */
        @keyframes subtitleFadeIn {
            0% {
                opacity: 0;
                transform: translateY(50px) scale(0.9);
            }
            20% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            80% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0.7;
                transform: translateY(-10px) scale(0.98);
            }
        }

        /* 脉冲动画用于智能回复按钮 */
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(74, 132, 193, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(74, 132, 193, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(74, 132, 193, 0);
            }
        }

        /* 消息容器滑入动画类 */
        .message-slide-in {
            animation: messageSlideIn 0.3s ease-out forwards;
        }

        /* 延迟动画类用于连续消息 */
        .message-slide-in-delayed {
            animation: messageSlideIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
            animation-delay: 0.1s;
        }

        .floating-btn:nth-child(1) {
            animation-delay: 0.1s;
        }

        .floating-btn:nth-child(2) {
            animation-delay: 0.2s;
        }

        /* 悬浮按钮隐藏状态 */
        .floating-btn.hidden {
            opacity: 0;
            transform: translateY(20px) scale(0.8);
            pointer-events: none;
        }

        /* 等待状态的特殊样式 */
        .floating-btn.waiting {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15), 0 0 0 4px rgba(255, 193, 7, 0.3);
        }

        /* 脉冲动画 */
        @keyframes pulse {
            0% {
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15), 0 0 0 0 var(--theme-button-secondary-border, rgba(0, 0, 0, 0.3));
            }
            50% {
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15), 0 0 0 8px rgba(0, 0, 0, 0);
            }
            100% {
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15), 0 0 0 0 rgba(0, 0, 0, 0);
            }
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15), 0 0 0 0 var(--theme-button-secondary-border, rgba(0, 0, 0, 0.3));
            }
            50% {
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15), 0 0 0 8px rgba(0, 0, 0, 0);
            }
            100% {
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15), 0 0 0 0 rgba(0, 0, 0, 0);
            }
        }

        /* 从 index.html 移动过来的静态样式 */
        .moments-page-no-padding {
            margin: 0;
            padding: 0;
        }

        .size-preview-rect-xs {
            width: 20px;
            height: 35px;
        }

        .size-preview-rect-s {
            width: 25px;
            height: 52px;
        }

        .size-preview-rect-m {
            width: 27px;
            height: 58px;
        }

        .size-preview-rect-l {
            width: 28px;
            height: 60px;
        }

        .size-preview-rect-xl {
            width: 30px;
            height: 65px;
        }

        .clear-avatar-btn {
            background-color: #ff6b6b;
            margin-left: 10px;
        }

        /* 评论回复格式间距优化 */
        .comment-reply-format {
            color: #576b95;
            font-weight: 600;
        }
        
        .comment-reply-text {
            word-spacing: 2px;
            letter-spacing: 0px;
        }

        
        /* 转账功能样式 */
        #transfer-modal, #transfer-confirm-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1001;
        }

        #transfer-modal.visible, #transfer-confirm-modal.visible {
            display: flex;
        }

        .transfer-content, .transfer-confirm-content {
            background: white;
            border-radius: 15px;
            padding: 20px;
            width: 260px;
            max-width: 260px;
            min-width: 260px;
            box-sizing: border-box;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .transfer-header, .transfer-confirm-title {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
        }

        .transfer-input-group {
            margin-bottom: 15px;
        }

        .transfer-input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }

        .transfer-input-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
        }

        .transfer-input-group input:focus {
            border-color: var(--theme-button-bg, #4a84c1);
            outline: none;
            box-shadow: 0 0 0 2px rgba(74, 132, 193, 0.2);
        }

        /* 🔥【新增】转账收款人选择框样式 */
        .transfer-recipient-select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
            background-color: white;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
            padding-right: 40px;
        }

        .transfer-recipient-select:focus {
            border-color: var(--theme-button-bg, #4a84c1);
            outline: none;
            box-shadow: 0 0 0 2px rgba(74, 132, 193, 0.2);
        }

        .transfer-recipient-select option {
            padding: 8px;
            font-size: 16px;
        }

        .transfer-actions, .transfer-confirm-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .transfer-actions button, .transfer-confirm-actions button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        #transfer-cancel-btn, #transfer-reject-btn {
            background-color: #f5f5f5;
            color: #666;
        }

        #transfer-cancel-btn:hover, #transfer-reject-btn:hover {
            background-color: #e0e0e0;
        }

        #transfer-confirm-btn, #transfer-accept-btn {
            background-color: var(--theme-button-bg, #4a84c1);
            color: white;
        }

        #transfer-confirm-btn:hover, #transfer-accept-btn:hover {
            background-color: var(--theme-button-hover, #3a74b1);
        }

        .transfer-confirm-info {
            text-align: center;
            margin: 20px 0;
        }

        .transfer-confirm-amount {
            font-size: 28px;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 10px;
        }

        .transfer-confirm-note {
            font-size: 14px;
            color: #666;
            word-break: break-all;
        }

        /* 转账卡片样式 */
        .transfer-card {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            border-radius: 12px;
            padding: 15px;
            margin: 5px 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
            min-width: 180px;
        }

        .transfer-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        /* 已确认收款状态 - 灰一点的粉色 */
        .transfer-card.accepted {
            background: linear-gradient(135deg, #d4a5a8 0%, #e6c8d2 100%);
            cursor: default;
        }

        .transfer-card.accepted:hover {
            transform: none;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* 已拒绝/退回状态 - 雾霾蓝 */
        .transfer-card.rejected {
            background: linear-gradient(135deg, #8fa3b0 0%, #b5c9d3 100%);
            cursor: default;
        }

        .transfer-card.rejected:hover {
            transform: none;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .transfer-title {
            font-size: 14px;
            color: #555;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .transfer-amount {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .transfer-note {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            word-break: break-all;
        }

        .transfer-status {
            font-size: 12px;
            color: #888;
            text-align: right;
            margin-top: 5px;
        }

        /* 用户消息中的转账卡片宽度限制 */
        .message-container.sent .transfer-card {
            max-width: 240px;
            width: auto;
        }

        /* AI消息中的转账卡片宽度限制 */
        .message-container.received .transfer-card {
            max-width: 240px;
            width: auto;
        }

        /* 转账消息容器对齐样式 - 类似语音消息容器 */
        .transfer-message-container {
            display: flex;
            flex-direction: column;
            max-width: 65%;
        }

        /* 用户转账消息容器右对齐 */
        .transfer-message-container.sent {
            align-self: flex-end;
            align-items: flex-end;
            margin-left: auto;
        }

        /* AI转账消息容器左对齐 */
        .transfer-message-container.received {
            align-self: flex-start;
            align-items: flex-start;
            margin-right: auto;
        }

        /* 位置分享模态框样式 */
        .location-modal-content {
            width: 90%;
            max-width: 400px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .location-input-section {
            margin-bottom: 20px;
        }

        .location-input-section label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        #location-address {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
        }

        #location-address:focus {
            outline: none;
            border-color: #007AFF;
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
        }

        .location-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .location-suggestion {
            padding: 6px 12px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #495057;
        }

        .location-suggestion:hover {
            background: #e9ecef;
            border-color: #dee2e6;
            transform: translateY(-1px);
        }

        .virtual-map-container {
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            overflow: hidden;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .map-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 16px;
            text-align: center;
        }

        .map-location-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .map-coordinates {
            font-size: 12px;
            opacity: 0.9;
            font-family: 'Courier New', monospace;
        }

        .virtual-map {
            position: relative;
            width: 100%;
            height: 200px;
            background: linear-gradient(45deg, #e8f5e8 0%, #f0f8f0 50%, #e8f5e8 100%);
            overflow: hidden;
        }

        .map-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(76, 175, 80, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(33, 150, 243, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 60% 20%, rgba(255, 193, 7, 0.1) 0%, transparent 50%);
        }

        .map-roads {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .road {
            position: absolute;
            background: #ddd;
            z-index: 1;
        }

        .road-horizontal {
            height: 3px;
        }

        .road-vertical {
            width: 3px;
        }

        .map-buildings {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
        }

        .building {
            position: absolute;
            background: linear-gradient(135deg, #90a4ae 0%, #78909c 100%);
            border-radius: 2px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .map-marker {
            position: absolute;
            top: 45%;
            left: 60%;
            z-index: 5;
            transform: translate(-50%, -50%);
        }

        .marker-pin {
            display: flex;
            align-items: center;
            justify-content: center;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .marker-pin svg {
            width: 28px;
            height: 28px;
        }

        .marker-pulse {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background: rgba(255, 0, 0, 0.3);
            border-radius: 50%;
            animation: markerPulse 2s ease-in-out infinite;
        }

        .map-current-location {
            position: absolute;
            bottom: 20%;
            left: 30%;
            z-index: 4;
        }

        .current-location-dot {
            width: 8px;
            height: 8px;
            background: #007AFF;
            border: 2px solid white;
            border-radius: 50%;
            box-shadow: 0 0 8px rgba(0, 122, 255, 0.5);
        }

        .current-location-ring {
            position: absolute;
            top: -4px;
            left: -4px;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(0, 122, 255, 0.3);
            border-radius: 50%;
            animation: currentLocationPulse 2s ease-in-out infinite;
        }

        .map-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 16px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
        }

        .map-scale {
            font-size: 12px;
            color: #6c757d;
            font-family: 'Courier New', monospace;
        }

        .map-control-btn {
            padding: 4px 8px;
            background: #007AFF;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .map-control-btn:hover {
            background: #0056CC;
        }

        /* 位置分享动画 */
        @keyframes markerBounce {
            0%, 100% {
                transform: translate(-50%, -50%) translateY(0);
            }
            50% {
                transform: translate(-50%, -50%) translateY(-3px);
            }
        }

        @keyframes markerPulse {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0;
            }
        }

        @keyframes currentLocationPulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.5);
                opacity: 0.5;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* 位置消息样式 */
        .location-message-container {
            display: flex;
            flex-direction: column;
            max-width: 200px;
        }

        .location-message-container.sent {
            align-self: flex-end;
            align-items: flex-end;
            margin-left: auto;
        }

        .location-message-container.received {
            align-self: flex-start;
            align-items: flex-start;
            margin-right: auto;
        }

        .location-card {
            background: white;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
            cursor: pointer;
            transition: all 0.2s ease;
            margin: 5px 0;
            width: 180px;
        }

        .location-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.12);
        }

        .location-card-header {
            background: #f8f9fa;
            color: #2c3e50;
            padding: 8px 10px;
            font-size: 13px;
            font-weight: 500;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        .location-title {
            background: #f8f9fa;
            color: #2c3e50;
            padding: 8px 10px;
            font-size: 13px !important;
            font-weight: 500;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
            line-height: 1.2;
            letter-spacing: normal;
        }

        .location-card-map {
            height: 80px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 50%, #f1f3f4 100%);
            position: relative;
            overflow: hidden;
        }

        /* 简化的地图元素 - 绿白灰配色 */
        .location-card .map-background {
            background: linear-gradient(45deg, #f8f9fa 0%, #e8f5e8 30%, #f0f0f0 70%, #f8f9fa 100%);
        }

        .location-card .map-roads {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .location-card .road {
            background: #dee2e6;
            position: absolute;
        }

        .location-card .road-horizontal {
            height: 2px;
        }

        .location-card .road-vertical {
            width: 2px;
        }

        .location-card .map-buildings {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* 河流样式 */
        .location-card .river {
            position: absolute;
            background: linear-gradient(45deg, #40a9ff 0%, #1890ff 50%, #096dd9 100%);
            border-radius: 50px;
            opacity: 0.8;
            z-index: 1;
        }

        /* 河流弯曲部分 */
        .location-card .river-curve {
            position: absolute;
            background: linear-gradient(45deg, #40a9ff 0%, #1890ff 50%, #096dd9 100%);
            border-radius: 50px;
            opacity: 0.8;
            z-index: 1;
        }

        /* 更真实的建筑物样式 */
        .location-card .building {
            position: absolute;
            z-index: 2;
            border-radius: 1px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .location-card .building.house {
            background: linear-gradient(135deg, #f0f0f0 0%, #d9d9d9 100%);
            border: 1px solid #bfbfbf;
        }

        .location-card .building.office {
            background: linear-gradient(135deg, #e6f7ff 0%, #bae7ff 100%);
            border: 1px solid #91d5ff;
        }

        .location-card .building.shop {
            background: linear-gradient(135deg, #fff1f0 0%, #ffd8d6 100%);
            border: 1px solid #ffaaa5;
        }

        /* 树木和绿化 */
        .location-card .tree {
            position: absolute;
            z-index: 3;
            border-radius: 50%;
        }

        .location-card .tree.big {
            background: radial-gradient(circle, #52c41a 0%, #389e0d 70%, #237804 100%);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
        }

        .location-card .tree.small {
            background: radial-gradient(circle, #73d13d 0%, #52c41a 70%, #389e0d 100%);
            box-shadow: 0 0.5px 1px rgba(0, 0, 0, 0.1);
        }

        /* 公园绿地 */
        .location-card .park {
            position: absolute;
            background: linear-gradient(135deg, #f6ffed 0%, #d9f7be 50%, #b7eb8f 100%);
            border-radius: 3px;
            opacity: 0.6;
            z-index: 1;
        }

        .location-card .map-marker {
            position: absolute;
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 5;
        }

        .location-card .marker-pin {
            display: flex;
            align-items: center;
            justify-content: center;
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
        }

        .location-card .marker-pin svg {
            width: 20px;
            height: 20px;
        }

        .virtual-map .river {
            position: absolute;
            background: linear-gradient(45deg, #40a9ff 0%, #1890ff 50%, #096dd9 100%);

/* 历史地点样式 */
.location-history {
    margin-top: 15px;
}

.location-history-title {
    font-size: 14px;
    color: #666;
    margin-bottom: 8px;
    font-weight: 500;
}

.location-history-items {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    max-height: 120px;
    overflow-y: auto;
}

.location-history-item {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 16px;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s ease;
    color: #333;
    font-weight: 500;
    position: relative;
    user-select: none;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.location-history-item:hover {
    background: rgba(255, 255, 255, 0.95);
    border-color: rgba(0, 0, 0, 0.15);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.location-history-item .location-text {
    flex: 1;
    min-width: 0;
}

.location-history-item .delete-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 16px !important;
    height: 16px !important;
    border-radius: 50% !important;
    background: rgba(0, 0, 0, 0.1) !important;
    color: #666 !important;
    font-size: 10px !important;
    line-height: 1 !important;
    opacity: 0;
    transition: all 0.2s ease;
    cursor: pointer;
    flex-shrink: 0;
    margin-left: 4px;
    padding: 0 !important;
    border: none !important;
}

.location-history-item:hover .delete-btn {
    opacity: 1;
}

.location-history-item .delete-btn:hover {
    background: rgba(0, 0, 0, 0.2) !important;
    color: #333 !important;
    transform: scale(1.1);
}

.location-history-item.deleting {
    background: #fff2f0;
    border-color: #ffccc7;
    color: #ff4d4f;
    animation: shake 0.5s ease-in-out;
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-2px); }
    75% { transform: translateX(2px); }
}

/* 空状态样式 */
.location-history-empty {
    color: #999;
    font-size: 12px;
    text-align: center;
    padding: 15px;
    background: #fafafa;
    border-radius: 8px;
    border: 1px dashed #d9d9d9;
}

/* 位置历史删除按钮 - 使用最强特异性 */
.location-history-items .location-history-item .delete-btn {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 16px !important;
    height: 16px !important;
    border-radius: 50% !important;
    background: rgba(0, 0, 0, 0.1) !important;
    color: #666 !important;
    font-size: 10px !important;
    line-height: 1 !important;
    opacity: 0 !important;
    transition: all 0.2s ease !important;
    cursor: pointer !important;
    flex-shrink: 0 !important;
    margin-left: 4px !important;
    padding: 0 !important;
    border: none !important;
    text-decoration: none !important;
}

.location-history-items .location-history-item:hover .delete-btn {
    opacity: 1 !important;
}

.location-history-items .location-history-item .delete-btn:hover {
    background: rgba(0, 0, 0, 0.2) !important;
    color: #333 !important;
    transform: scale(1.1) !important;
}
}





/* 位置历史胶囊气泡样式覆盖 */
.location-history-items .location-history-item {
    display: inline-block !important;
    position: relative !important;
    padding: 6px 20px 6px 12px !important;
    margin: 0 8px 8px 0 !important;
    background: rgba(255, 255, 255, 0.9) !important;
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
    border-radius: 16px !important;
    font-size: 13px !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    color: #333 !important;
    font-weight: 500 !important;
    user-select: none !important;
    backdrop-filter: blur(10px) !important;
    -webkit-backdrop-filter: blur(10px) !important;
    gap: 0 !important;
    align-items: stretch !important;
    flex-direction: row !important;
}

.location-history-items .location-history-item:hover {
    background: rgba(255, 255, 255, 0.95) !important;
    border-color: rgba(0, 0, 0, 0.15) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
}

.location-history-items .location-history-item .location-text {
    display: block !important;
    flex: none !important;
    min-width: auto !important;
}

.location-history-items .location-history-item .delete-btn {
    position: absolute !important;
    top: -4px !important;
    right: -4px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 14px !important;
    height: 14px !important;
    border-radius: 50% !important;
    background: rgba(255, 255, 255, 0.9) !important;
    color: #999 !important;
    font-size: 10px !important;
    line-height: 1 !important;
    opacity: 0.6 !important;
    transition: all 0.2s ease !important;
    cursor: pointer !important;
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    text-decoration: none !important;
    z-index: 10 !important;
    margin: 0 !important;
    padding: 0 !important;
    flex-shrink: 0 !important;
}

.location-history-items .location-history-item:hover .delete-btn {
    opacity: 1 !important;
}

.location-history-items .location-history-item .delete-btn:hover {
    background: #ff4757 !important;
    color: white !important;
    transform: scale(1.1) !important;
    border-color: #ff4757 !important;
}

/* 手机端样式优化 */
@media (max-width: 768px) {
    .location-history-items .location-history-item .delete-btn {
        opacity: 0.7 !important;
        width: 16px !important;
        height: 16px !important;
        font-size: 11px !important;
        top: -5px !important;
        right: -5px !important;
    }
    
    .location-history-items .location-history-item .delete-btn:active {
        background: #ff4757 !important;
        color: white !important;
        transform: scale(0.95) !important;
        border-color: #ff4757 !important;
    }
    
    .location-history-items .location-history-item {
        padding: 7px 22px 7px 12px !important;
        margin: 0 8px 8px 0 !important;
    }
}

/* 仿QQ/微信群聊设置界面样式 */

/* 群聊信息卡片 */
.group-info-card {
    background: white;
    border-radius: 12px;
    padding: 20px;
    margin: 15px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    display: flex;
    align-items: center;
    gap: 15px;
}

.group-avatar-section {
    position: relative;
    cursor: pointer;
}

.group-avatar-large {
    width: 80px;
    height: 80px;
    border-radius: 20px;
    object-fit: cover;
    border: 3px solid #f0f0f0;
    transition: all 0.3s ease;
}

.group-avatar-section:hover .group-avatar-large {
    border-color: #007AFF;
    transform: scale(1.05);
}

.group-avatar-edit-hint {
    position: absolute;
    bottom: -5px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 122, 255, 0.9);
    color: white;
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 8px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.group-avatar-section:hover .group-avatar-edit-hint {
    opacity: 1;
}

.group-basic-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.group-name {
    font-size: 18px;
    font-weight: 600;
    color: #333;
    cursor: pointer;
    padding: 5px 8px;
    border-radius: 6px;
    transition: background-color 0.2s ease;
}

.group-name:hover {
    background-color: #f5f5f5;
}

.group-member-count {
    font-size: 14px;
    color: #666;
    margin-bottom: 5px;
}

.group-description {
    font-size: 13px;
    color: #888;
    line-height: 1.4;
    cursor: pointer;
    padding: 5px 8px;
    border-radius: 6px;
    transition: background-color 0.2s ease;
    max-width: 200px;
    word-wrap: break-word;
}

.group-description:hover {
    background-color: #f5f5f5;
}

/* 群成员展示区域 */
.group-members-section {
    background: white;
    border-radius: 12px;
    margin: 15px;
    padding: 15px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.group-members-section .section-title {
    font-size: 16px;
    font-weight: 600;
    color: #333;
    margin-bottom: 15px;
    padding-bottom: 8px;
    border-bottom: 1px solid #f0f0f0;
}

.group-members-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    gap: 15px;
    max-height: 300px;
    overflow-y: auto;
}

.member-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    transition: transform 0.2s ease;
}

.member-item:hover {
    transform: translateY(-2px);
}

.member-avatar {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    object-fit: cover;
    background: #f0f0f0;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 5px;
    transition: all 0.3s ease;
}

.member-item.add-member .member-avatar,
.member-item.remove-member .member-avatar {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border: 2px solid #dee2e6;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

.member-item.add-member:hover .member-avatar {
    background: linear-gradient(135deg, #34c759 0%, #30d158 100%);
    border-color: #34c759;
    transform: scale(1.05);
}

.member-item.add-member:hover .member-avatar i {
    color: white;
}

.member-item.remove-member:hover .member-avatar {
    background: linear-gradient(135deg, #ff3b30 0%, #ff453a 100%);
    border-color: #ff3b30;
    transform: scale(1.05);
}

.member-item.remove-member:hover .member-avatar i {
    color: white;
}

.member-item.add-member .member-avatar i,
.member-item.remove-member .member-avatar i {
    font-size: 16px;
    color: #8e8e93;
    transition: color 0.3s ease;
}

.member-item.add-member .member-name,
.member-item.remove-member .member-name {
    color: #8e8e93;
    font-size: 12px;
    transition: color 0.3s ease;
}

.member-item.add-member:hover .member-name {
    color: #34c759;
}

.member-item.remove-member:hover .member-name {
    color: #ff3b30;
}

.member-avatar i {
    font-size: 20px;
}

.member-name {
    font-size: 12px;
    color: #666;
    text-align: center;
    max-width: 50px;
    word-wrap: break-word;
    line-height: 1.2;
}



/* 面具选择界面样式 */
.persona-selection-item {
    display: flex;
    align-items: center;
    padding: 15px;
    border-radius: 12px;
    margin-bottom: 10px;
    background: rgba(255, 255, 255, 0.8);
    border: 2px solid transparent;
    cursor: pointer;
    transition: all 0.3s ease;
}

.persona-selection-item:hover {
    background: rgba(255, 255, 255, 0.95);
    border-color: rgba(0, 123, 255, 0.3);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.persona-selection-item.selected {
    border-color: var(--color-blue);
    background: rgba(0, 123, 255, 0.1);
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.2);
}

.persona-selection-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 18px;
    margin-right: 15px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.persona-selection-info {
    flex: 1;
}

.persona-selection-name {
    font-size: 16px;
    font-weight: 600;
    color: #333;
    margin-bottom: 4px;
}

.persona-selection-desc {
    font-size: 14px;
    color: #666;
    line-height: 1.4;
    white-space: pre-line;
    word-wrap: break-word;
    max-height: 4.2em; /* 约3行的高度 */
    overflow: hidden;
}

.persona-selection-check {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: var(--color-blue);
    color: white;
    display: none;
    align-items: center;
    justify-content: center;
    font-size: 12px;
}

.persona-selection-item.selected .persona-selection-check {
    display: flex;
}

.selection-description {
    color: #666;
    font-size: 14px;
    margin-bottom: 20px;
    text-align: center;
    line-height: 1.5;
}

/* 响应式设计 */
@media (max-width: 768px) {
    .group-info-card {
        flex-direction: column;
        text-align: center;
        gap: 12px;
    }
    
    .group-basic-info {
        align-items: center;
    }
    
    .group-members-grid {
        grid-template-columns: repeat(5, 1fr);
        gap: 10px;
    }
    

}

/* 设置项样式优化 */
.group-chat-settings .setting-item {
    transition: background-color 0.2s ease;
}

.group-chat-settings .setting-item:hover {
    background-color: #f8f9fa;
}




/* 角色选择模态框样式 */
.character-selection-modal {
    z-index: 10001;
}

.character-selection-modal .modal-content {
    max-width: 600px;
    width: 90%;
    max-height: 80vh;
    overflow: hidden;
}

.character-selection-modal .modal-body {
    max-height: 60vh;
    overflow-y: auto;
    padding: 20px;
}

.selection-description {
    color: #666;
    font-size: 14px;
    margin-bottom: 20px;
    text-align: center;
}

.character-selection-grid {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.character-selection-item {
    display: flex;
    align-items: center;
    padding: 15px;
    border: 2px solid #f0f0f0;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    background: white;
}

.character-selection-item:hover {
    border-color: #007AFF;
    background: #f8f9ff;
    transform: translateY(-2px);
    box-shadow: 0 4px 16px rgba(0, 122, 255, 0.1);
}

.character-selection-item.selected {
    border-color: #007AFF;
    background: linear-gradient(135deg, #e6f3ff 0%, #f0f8ff 100%);
    box-shadow: 0 4px 16px rgba(0, 122, 255, 0.2);
}

.character-selection-avatar {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    overflow: hidden;
    margin-right: 15px;
    flex-shrink: 0;
    border: 3px solid #f0f0f0;
    transition: border-color 0.3s ease;
}

.character-selection-item.selected .character-selection-avatar {
    border-color: #007AFF;
}

.character-selection-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.character-selection-info {
    flex: 1;
    min-width: 0;
}

.character-selection-name {
    font-size: 16px;
    font-weight: 600;
    color: #333;
    margin-bottom: 4px;
}

.character-selection-bio {
    font-size: 13px;
    color: #666;
    line-height: 1.4;
    word-wrap: break-word;
}

.character-selection-check {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: #f0f0f0;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-left: 15px;
    transition: all 0.3s ease;
    opacity: 0;
}

.character-selection-item.selected .character-selection-check {
    background: #007AFF;
    opacity: 1;
    transform: scale(1.1);
}

.character-selection-check i {
    font-size: 12px;
    color: white;
}

/* 响应式设计 */
@media (max-width: 768px) {
    .character-selection-modal .modal-content {
        width: 95%;
        margin: 20px auto;
    }
    
    .character-selection-item {
        padding: 12px;
    }
    
    .character-selection-avatar {
        width: 50px;
        height: 50px;
        margin-right: 12px;
    }
    
    .character-selection-name {
        font-size: 15px;
    }
    
    .character-selection-bio {
        font-size: 12px;
    }
}

/* 群公告编辑模态框样式 */
.group-notice-form {
    padding: 5px 0;
}

.group-notice-textarea {
    min-height: 120px;
    max-height: 200px;
    resize: vertical;
    font-family: var(--theme-font-family);
    line-height: 1.5;
}

.notice-char-count {
    text-align: right;
    font-size: 12px;
    color: #999;
    margin-top: 5px;
    padding-right: 5px;
}

.notice-char-count #notice-char-current {
    color: #007AFF;
    font-weight: 500;
}

.notice-tips {
    background: linear-gradient(135deg, #f8f9ff 0%, #f0f4ff 100%);
    border: 1px solid #e6f0ff;
    border-radius: 8px;
    padding: 15px;
    margin-top: 15px;
}

.tips-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 10px;
    font-weight: 600;
    color: #333;
}

.tips-header i {
    color: #FFD700;
    font-size: 16px;
}

.tips-content {
    font-size: 13px;
    color: #666;
    line-height: 1.6;
    margin-left: 24px;
}

/* 群公告编辑模态框动画 */
#group-notice-modal .modal-content {
    animation: groupNoticeSlideIn 0.3s ease-out;
}

@keyframes groupNoticeSlideIn {
    from {
        opacity: 0;
        transform: translateY(-20px) scale(0.95);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* 🔥【新增】群成员头像更换功能样式 */

/* 头像悬停提示 */
.member-avatar-wrapper {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

.clickable-avatar {
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
}

.clickable-avatar:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.avatar-hover-hint {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.7);
    color: white;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: all 0.3s ease;
    pointer-events: none;
    font-size: 12px;
}

.member-avatar-wrapper:hover .avatar-hover-hint {
    opacity: 1;
}

/* 群成员头像更换模态框样式 */
.member-avatar-form {
    padding: 10px 0;
}

.current-member-info {
    text-align: center;
    margin-bottom: 25px;
}

.member-name-title {
    font-size: 18px;
    font-weight: 600;
    color: var(--theme-text-primary, #333);
    margin: 0 0 8px 0;
    font-family: var(--theme-font-family);
}

.member-info-desc {
    font-size: 14px;
    color: #666;
    margin: 0;
    line-height: 1.4;
}

.avatar-upload-section {
    text-align: center;
    margin-bottom: 25px;
}

.avatar-preview-large {
    margin-bottom: 20px;
}

.preview-image {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid var(--theme-avatar-border, rgba(255, 255, 255, 0.8));
    box-shadow: var(--shadow-lg);
    transition: all 0.3s ease;
}

.preview-image:hover {
    transform: scale(1.05);
}

.upload-buttons {
    display: flex;
    gap: 12px;
    justify-content: center;
    flex-wrap: wrap;
}

.upload-btn {
    padding: 12px 20px;
    border: none;
    border-radius: var(--theme-button-radius, 12px);
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: var(--shadow-md);
    font-family: var(--theme-font-family);
}

.upload-btn.primary {
    background: var(--theme-button-bg, rgba(0, 123, 255, 0.9));
    color: var(--theme-button-color, white);
    border: 1px solid var(--theme-button-border, transparent);
}

.upload-btn.primary:hover {
    background: var(--theme-button-bg-hover, rgba(0, 123, 255, 1));
    transform: translateY(-2px);
    box-shadow: var(--theme-button-shadow, 0 6px 20px rgba(0, 123, 255, 0.4));
}

.upload-btn.secondary {
    background: var(--theme-button-secondary-bg, rgba(255, 255, 255, 0.8));
    color: var(--theme-button-secondary-color, #666);
    border: 1px solid var(--theme-button-secondary-border, rgba(0, 0, 0, 0.1));
}

.upload-btn.secondary:hover {
    background: var(--theme-button-secondary-bg-hover, rgba(255, 255, 255, 0.95));
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
}

.upload-btn:active {
    transform: translateY(0);
}

.avatar-tips {
    background: linear-gradient(135deg, #f8f9ff 0%, #f0f4ff 100%);
    border: 1px solid #e6f0ff;
    border-radius: 12px;
    padding: 20px;
    margin-top: 20px;
}

.tips-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
    font-weight: 600;
    color: #333;
    font-size: 15px;
}

.tips-header i {
    color: #007AFF;
    font-size: 16px;
}

.tips-content {
    font-size: 13px;
    color: #666;
    line-height: 1.6;
    margin-left: 24px;
}

/* 模态框按钮样式 */
.modal-button {
    padding: 12px 24px;
    border: none;
    border-radius: var(--theme-button-radius, 12px);
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: var(--shadow-md);
    font-family: var(--theme-font-family);
}

.modal-button.modal-primary {
    background: var(--theme-button-bg, rgba(0, 123, 255, 0.9));
    color: var(--theme-button-color, white);
    border: 1px solid var(--theme-button-border, transparent);
}

.modal-button.modal-primary:hover {
    background: var(--theme-button-bg-hover, rgba(0, 123, 255, 1));
    transform: translateY(-2px);
    box-shadow: var(--theme-button-shadow, 0 6px 20px rgba(0, 123, 255, 0.4));
}

.modal-button.modal-secondary {
    background: var(--theme-button-secondary-bg, rgba(255, 255, 255, 0.8));
    color: var(--theme-button-secondary-color, #666);
    border: 1px solid var(--theme-button-secondary-border, rgba(0, 0, 0, 0.1));
}

.modal-button.modal-secondary:hover {
    background: var(--theme-button-secondary-bg-hover, rgba(255, 255, 255, 0.95));
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
}

.modal-button:active {
    transform: translateY(0);
}

/* 响应式设计 */
@media (max-width: 768px) {
    .avatar-hover-hint {
        opacity: 0.8;
        width: 25px;
        height: 25px;
        font-size: 10px;
    }
    
    .upload-buttons {
        flex-direction: column;
        align-items: center;
    }
    
    .upload-btn {
        width: 100%;
        max-width: 200px;
    }
    
    .preview-image {
        width: 80px;
        height: 80px;
    }
}
/* --- 您之前为了显示昵称添加的样式 --- */
.message-container {
    display: flex;
    align-items: flex-start !important;
    width: 100%; /* 确保消息容器占满可用宽度 */
}

.message-avatar {
    margin-right: 8px;
    flex-shrink: 0;
}

/* 为发送的消息添加右对齐 */
.message-container.sent {
    justify-content: flex-end;
}

.message-container.sent .bubble-wrapper {
    align-items: flex-end;
}

.bubble-wrapper {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    flex: 1;      /* 关键改动(1): 让容器伸展 */
    min-width: 0; /* 关键改动(2): 保留此项，防止内容溢出 */
}

.sender-name {
    font-size: 12px;
    color: #8e8e93;
    margin-bottom: 2px;
    margin-left: 10px; /* 关键：和气泡padding-left一致 */
    font-weight: normal;
    text-align: left;
    align-self: flex-start;
    line-height: 1.2;
    max-width: 220px;
    word-break: break-all;
}


/* --- 新增的CSS规则，用于对齐群聊头像和气泡顶部 --- */
.message-container.group-message-item .message-avatar {
    /* 16px 大约是昵称的高度 (12px * 1.2 行高 + 2px margin) */
    margin-top: 16px; 
}
/* --- 世界书新布局样式 (美化版) --- */
.worldbook-content-pane {
    flex: 1;
    overflow-y: auto;
    min-height: 0; /* 确保flex子元素可以正确收缩 */
}

.worldbook-tabs {
    display: flex;
    justify-content: space-around;
    padding: 10px 0; /* 与chat-tabs一致 */
    border-top: 1px solid var(--color-border-light);
    background-color: var(--color-gray-bg-light); /* 与chat-tabs一致 */
    flex-shrink: 0;
}

.worldbook-tab {
    display: flex;
    flex-direction: column;
    align-items: center;
    color: var(--color-text-light); /* 与chat-tab一致 */
    font-size: 12px; /* 与chat-tab一致 */
    cursor: pointer;
}

.worldbook-tab.active {
    color: var(--color-primary-green);
}

.worldbook-tab i {
    font-size: 24px;
    margin-bottom: 3px;
}

.worldbook-section {
    padding: 0;
    margin-top: 0; /* 移除上边距，让内容贴着顶部 */
}

.section-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 10px;
    padding: 0 15px; /* 为标题添加左右内边距 */
}

/* 为世界书项目添加适当的内边距 */
.worldbook-item {
    padding: 15px; /* 确保世界书项目有内边距 */
    border-bottom: 1px solid var(--color-border);
    cursor: pointer;
}

.worldbook-item:hover {
    background-color: rgba(0, 0, 0, 0.02);
}

        .edit-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #007AFF;
            font-size: 16px;
            padding: 5px 8px;
            margin-left: 8px;
        }

        /* 推送通知样式 - 🔥【修复】改为白色iOS风格，缩短高度 */
        #notification-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 340px;
            z-index: 10000;
            pointer-events: none;
        }

        .push-notification {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            color: #333;
            border-radius: 14px;
            padding: 8px 10px;
            margin: 3px 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            gap: 8px;
            transform: translateY(-60px);
            opacity: 0;
            transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            pointer-events: auto;
            cursor: pointer;
            border: 1px solid rgba(0, 0, 0, 0.05);
            min-height: 50px;
            max-height: 56px;
        }

        .push-notification.show {
            transform: translateY(0px);
            opacity: 1;
        }

        .push-notification.hide {
            transform: translateY(-60px);
            opacity: 0;
        }

        .notification-avatar {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            object-fit: cover;
            flex-shrink: 0;
            position: relative;
        }

        .notification-content {
            flex: 1;
            min-width: 0;
        }

        .notification-title {
            font-size: 13px;
            font-weight: 600;
            margin: 0 0 2px 0;
            color: #333;
            line-height: 1.2;
        }

        .notification-message {
            font-size: 12px;
            color: #666;
            margin: 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            line-height: 1.3;
        }

        .notification-time {
            font-size: 9px;
            color: #999;
            margin-left: auto;
            flex-shrink: 0;
        }



        @keyframes notificationSlide {
            from {
                transform: translateY(-60px);
                opacity: 0;
            }
            to {
                transform: translateY(0px);
                opacity: 1;
            }
        }

        .push-notification:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.2);
        }

        .push-notification:active {
            transform: translateY(0px) scale(0.98);
        }

        .worldbook-global-info {
            margin-top: 15px;
            padding: 10px;
            background-color: #f5f5f5;
            border-radius: 8px;
        }

        .global-worldbook-note {
            color: #666;
            font-size: 14px;
            text-align: center;
            margin: 0;
        }

        /* 角色状态显示样式 */
        .character-status {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: 4px;
            font-size: 12px;
            color: #666;
        }

        /* 状态指示灯 */
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            position: relative;
            flex-shrink: 0;
        }

        /* 在线状态 - 小绿灯 */
        .status-indicator.online {
            background-color: #4CAF50;
            box-shadow: 0 0 6px rgba(76, 175, 80, 0.5);
        }

        /* 忙碌状态 - 小黄灯 */
        .status-indicator.busy {
            background-color: #FF9800;
            box-shadow: 0 0 6px rgba(255, 152, 0, 0.5);
        }

        /* 离线/拉黑状态 - 小灰灯 */
        .status-indicator.blocked,
        .status-indicator.offline {
            background-color: #9E9E9E;
            box-shadow: 0 0 6px rgba(158, 158, 158, 0.3);
        }

        /* 状态文本 */
        .status-text {
            font-size: 11px;
            color: #888;
            line-height: 1.2;
            font-weight: 400;
        }

        /* @群成员功能样式 */
        .mention-dropdown {
            position: absolute;
            bottom: calc(100% + 5px);
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);
            max-height: 100px;
            overflow-y: auto;
            z-index: 1001;
            display: none;
            box-sizing: border-box;
        }

        .mention-item {
            display: flex;
            align-items: center;
            padding: 6px 10px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border-bottom: 1px solid #f5f5f5;
            min-height: 32px;
        }

        .mention-item:last-child {
            border-bottom: none;
        }

        .mention-item:hover,
        .mention-item.selected {
            background-color: #f0f8ff;
        }

        .mention-avatar {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 6px;
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            color: white;
            font-weight: 500;
            flex-shrink: 0;
        }

        .mention-name {
            font-size: 12px;
            color: #333;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
        }

        /* @某人显示样式 */
        .mention-text {
            color: #6b9bd1;
            font-weight: 500;
            text-decoration: none;
        }

        /* 日记功能全屏界面样式 */
        .diary-tabs {
            display: flex;
            background: var(--bg-white-95);
            border-radius: 12px;
            margin: 15px;
            padding: 4px;
            box-shadow: var(--shadow-sm);
        }

        .diary-tab {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
            color: #666;
        }

        .diary-tab.active {
            background: var(--theme-button-bg, #4a84c1);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .diary-tab:not(.active):hover {
            background: var(--bg-white-90);
            color: #333;
        }

        .diary-tab i {
            font-size: 16px;
        }

        .diary-view {
            display: none;
            padding: 0 15px 15px 15px;
            height: calc(100vh - 200px);
            overflow-y: auto;
        }

        .diary-view.active {
            display: block;
        }

        .diary-header-actions {
            display: flex;
            gap: 8px;
            margin-left: auto;
            margin-right: 10px;
        }

        .diary-action-btn {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            background: var(--theme-button-bg, #4a84c1);
            color: var(--theme-button-color, white);
        }

        .diary-action-btn.secondary {
            background: var(--theme-button-secondary-bg, #f8f9fa);
            color: var(--theme-button-secondary-color, #6c757d);
            border: 1px solid var(--theme-button-secondary-border, #dee2e6);
        }

        .diary-action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
            border-radius: 50%;
            z-index: -1;
        }

        .diary-action-btn:hover {
            transform: translateY(-1px) scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        /* 日记模式样式 - 仿线下模式 */
        .diary-mode-overlay {
            position: absolute;
            top: 40px; /* 为状态栏留出空间 */
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #f8f9fa;
            display: flex;
            flex-direction: column;
            z-index: 100; /* 降低z-index，让状态栏显示在上面 */
        }

        .diary-mode-header {
            position: relative;
            z-index: 15;
            flex-shrink: 0;
            padding: 8px 32px;
            padding-top: 8px; /* 进一步减少顶部padding */
            height: 40px; /* 减少高度以匹配其他界面 */
            box-sizing: border-box;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            font-weight: 600;
            transition: var(--transition-normal);
            overflow: hidden;
        }

        .diary-mode-header .back-btn {
            background: transparent;
            border: none;
            font-size: 24px;
            color: var(--theme-button-bg, #4a84c1);
            cursor: pointer;
            padding: 0;
            border-radius: 50%;
            transition: background-color 0.2s ease;
            position: absolute;
            left: 20px;
            width: 30px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .diary-mode-header .back-btn:hover {
            background-color: transparent;
        }

        .diary-mode-header .header-title {
            text-align: center;
            flex: 1;
            color: #000000;
            font-size: 18px;
            font-weight: 600;
        }

        .diary-mode-header .header-actions {
            display: flex;
            gap: 10px;
            position: absolute;
            right: 20px;
            top: 50%; /* 调整到更高的位置 */
            transform: translateY(-50%);
        }

        .diary-mode-header .action-btn {
            background: transparent;
            border: none;
            font-size: 20px;
            color: var(--theme-button-bg, #4a84c1);
            cursor: pointer;
            padding: 6px;
            border-radius: 50%;
            transition: background-color 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 26px;
            text-align: center;
            padding: 0;
        }

        .diary-mode-header .action-btn:hover {
            background-color: transparent;
        }

        /* 🔥【新增】垃圾桶按钮特殊样式 - 透明背景，蓝色图标 */
        .diary-mode-header .action-btn.delete-btn {
            background: transparent !important;
            color: var(--theme-button-bg, #4a84c1);
        }

        .diary-mode-header .action-btn.delete-btn:hover {
            background: transparent !important;
            color: var(--theme-button-bg, #4a84c1);
            opacity: 0.7;
        }

        /* 🔥【新增】日记删除模式样式 */
        .past-diaries-list.delete-mode .past-diary-item {
            padding-left: 50px;
            position: relative;
        }

        .diary-checkbox {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 10;
        }

        .diary-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .past-diaries-list.delete-mode .past-diary-item:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        /* 删除模式底部操作栏 - 透明背景 */
        .diary-delete-actions {
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: transparent;
            padding: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            gap: 15px;
        }

        .diary-delete-actions .cancel-action-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
            color: #666;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .diary-delete-actions .cancel-action-btn:hover {
            background: rgba(255, 255, 255, 0.95);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        }

        .diary-delete-actions .delete-action-btn {
            background: rgba(255, 59, 48, 0.9);
            border: none;
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 4px 12px rgba(255, 59, 48, 0.3);
        }

        .diary-delete-actions .delete-action-btn:hover {
            background: rgba(215, 0, 21, 0.9);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255, 59, 48, 0.4);
        }

        .diary-delete-actions .delete-action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .diary-delete-actions .delete-action-btn:disabled:hover {
            background: rgba(255, 59, 48, 0.9);
            transform: none;
            box-shadow: 0 4px 12px rgba(255, 59, 48, 0.3);
        }

        .diary-mode-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .diary-mode-overlay .diary-view {
            display: none;
            flex: 1;
            overflow: hidden;
            padding: 0; /* 移除边距，让内容完全填满 */
        }

        .diary-mode-overlay .diary-view.active {
            display: flex;
            flex-direction: column;
        }

        .diary-content-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: #ffffff;
            margin: 10px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .diary-content {
            min-height: 100%;
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            font-size: 16px;
            line-height: 1.6;
            color: #333;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .diary-content.empty {
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-style: italic;
        }

        .past-diaries-list {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .diary-action-btn:active {
            transform: translateY(0) scale(0.98);
            transition: all 0.15s ease;
        }

        .diary-action-btn i {
            transition: transform 0.3s ease;
        }

        .diary-action-btn:hover i {
            transform: rotate(180deg);
        }

        .diary-action-btn.edit-btn:hover i {
            transform: scale(1.1) rotate(0deg);
        }

        .diary-action-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .diary-action-btn:disabled:hover {
            transform: none;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .diary-action-btn:disabled i {
            transform: none;
        }

        /* 日记编辑文本框样式 */
        .diary-edit-textarea {
            width: 100%;
            min-height: 300px;
            max-height: 500px;
            padding: 20px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-family: 'Courier New', 'SimSun', monospace;
            font-size: 14px;
            line-height: 1.6;
            resize: vertical;
            background-color: #fefefe;
            color: #2d3748;
            box-sizing: border-box;
        }

        .diary-edit-textarea:focus {
            outline: none;
            border-color: var(--theme-button-bg, #4a84c1);
            box-shadow: 0 0 0 2px rgba(74, 132, 193, 0.2);
        }

        .diary-edit-textarea::placeholder {
            color: #9ca3af;
            font-style: italic;
        }

        /* 信息文本样式 */
        .info-text {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 12px;
            font-size: 13px;
            line-height: 1.5;
            color: #6c757d;
        }

        /* 日记纸张容器 - 用于固定打孔效果 */
        .diary-paper-container {
            position: relative;
            border-radius: 8px;
            border: 1px solid #d1d5db;
            box-shadow:
                0 1px 3px rgba(0, 0, 0, 0.1),
                inset 0 0 0 1px rgba(255, 255, 255, 0.5);
            background-color: #fefefe;
            overflow: hidden; /* 确保内容不会溢出容器 */
            height: calc(100vh - 280px); /* 全屏模式下的高度 */
            margin-bottom: 20px;
        }

        /* 日记纸张样式 */
        .diary-paper {
            min-height: 100%;
            height: 100%; /* 填满容器高度 */
            overflow-y: auto;
            padding: 20px 25px 30px 40px; /* 减少顶部内边距，左边距40px为打孔留空间，右边距25px */
            background: linear-gradient(to bottom,
                #fefefe 0%,
                #fefefe 40px,
                #e8f4fd 40px,
                #e8f4fd 42px,
                transparent 42px
            ),
            repeating-linear-gradient(
                transparent,
                transparent 30px,
                #e1e5e9 30px,
                #e1e5e9 31px
            );
            background-color: #fefefe;
            border-radius: 8px;
            white-space: pre-wrap;
            font-family: 'Courier New', 'SimSun', monospace;
            font-size: 14px;
            line-height: 31px;
            word-wrap: break-word;
            word-break: break-word;
            color: #2d3748;
            position: relative;
            box-sizing: border-box; /* 确保padding计算在内 */
        }

        /* 日记特殊样式效果 */
        .diary-strikethrough {
            text-decoration: line-through;
            text-decoration-color: #666;
            text-decoration-thickness: 1.5px;
            opacity: 0.7;
        }

        .diary-highlight {
            background: linear-gradient(120deg, #fff3cd 0%, #fff3cd 100%);
            background-size: 100% 0.8em;
            background-repeat: no-repeat;
            background-position: 0 0.2em;
            padding: 0 2px;
            border-radius: 2px;
            position: relative;
        }

        .diary-highlight::before {
            content: '';
            position: absolute;
            top: 0.2em;
            left: 0;
            right: 0;
            height: 0.8em;
            background: rgba(255, 235, 59, 0.3);
            border-radius: 2px;
            z-index: -1;
        }

        /* 红线已移除，保留注释以备后用 */

        /* 日记纸张容器的固定打孔效果 */
        .diary-paper-container::after {
            content: '';
            position: absolute;
            left: 8px; /* 更靠左，完全不影响正文 */
            top: 80px; /* 从蓝线下方开始，与正文第一行对齐 */
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: #f3f4f6;
            border: 1px solid #d1d5db;
            box-shadow:
                0 50px 0 #f3f4f6,  /* 与行间距31px对应，约1.6行间距 */
                0 50px 0 1px #d1d5db,
                0 100px 0 #f3f4f6, /* 50px * 2 */
                0 100px 0 1px #d1d5db,
                0 150px 0 #f3f4f6, /* 50px * 3 */
                0 150px 0 1px #d1d5db,
                0 200px 0 #f3f4f6, /* 50px * 4 */
                0 200px 0 1px #d1d5db;
            z-index: 10; /* 确保打孔在内容上方 */
            pointer-events: none; /* 不阻挡鼠标事件 */
        }

        /* --- 论坛功能新增样式 --- */

        /* 论坛存档列表 */
        .forum-archive-list {
            padding: 10px;
        }
        .forum-archive-item {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.95));
            border-radius: 16px;
            padding: 18px 20px;
            margin-bottom: 12px;
            box-shadow: 0 3px 12px rgba(0, 0, 0, 0.08), 0 1px 3px rgba(0, 0, 0, 0.05);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            border: 1px solid rgba(74, 132, 193, 0.12);
            position: relative;
            overflow: hidden;
        }

        .forum-archive-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(74, 132, 193, 0.03), rgba(74, 132, 193, 0.01));
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .forum-archive-item:hover {
            transform: translateY(-3px) scale(1.01);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12), 0 3px 8px rgba(0, 0, 0, 0.08);
            border-color: rgba(74, 132, 193, 0.25);
        }

        .forum-archive-item:hover::before {
            opacity: 1;
        }
        .forum-archive-title {
            font-weight: 700;
            font-size: 17px;
            margin-bottom: 10px;
            color: #1a1a1a;
            line-height: 1.3;
            letter-spacing: -0.2px;
        }
        .forum-archive-meta {
            font-size: 13px;
            color: #6b7280;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 500;
        }

        .forum-archive-meta i {
            color: #9ca3af;
            font-size: 12px;
        }

        /* 论坛用户图标样式 */
        .forum-users-icon {
            width: 14px;
            height: 14px;
            margin-right: 4px;
            vertical-align: middle;
            color: #6b7280;
        }
        .forum-empty-state {
            text-align: center;
            padding: 50px 20px;
            color: #999;
        }
        .forum-empty-state i {
            font-size: 48px;
            margin-bottom: 15px;
        }
        .add-forum-btn {
            position: absolute;
            right: 22px;
            top: 43px;
            width: var(--size-md);
            height: var(--size-md);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: var(--font-size-xxl);
        }

        /* 创建论坛界面 */
        #create-forum-screen .app-content {
            padding: 20px;
        }
        .selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            max-height: 150px;
            overflow-y: auto;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        .selection-item {
            background: #fff;
            border: 2px solid #eee;
            border-radius: 8px;
            padding: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s ease;
        }
        .selection-item.selected {
            border-color: var(--accent-color);
            background: #eef7ff;
        }
        .selection-item img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 5px;
        }
        .selection-item-name {
            font-size: 12px;
            font-weight: 500;
        }
        .selection-grid.single-selection .selection-item.selected {
            /* 单选时样式可以更突出 */
            box-shadow: 0 0 10px rgba(0,123,255,0.2);
        }

        /* 帖子列表 */
        .post-list {
            padding: 10px;
        }
        .post-item {
            background: #fff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.05);
            cursor: pointer;
        }
        .post-title {
            font-weight: 600;
            font-size: 15px;
            margin-bottom: 8px;
        }
        .post-meta {
            font-size: 12px;
            color: #999;
            display: flex;
            justify-content: space-between;
        }
        .post-author {
            font-weight: 500;
            color: #555;
        }

        /* 帖子详情 */
        #post-view-content {
            padding: 15px;
            overflow-y: auto;
            flex: 1;
        }
        .post-full-content {
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
            margin-bottom: 15px;
        }
        .post-full-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        .post-full-meta {
            font-size: 13px;
            color: #888;
            margin-bottom: 15px;
        }
        .post-full-body {
            font-size: 15px;
            line-height: 1.7;
            white-space: pre-wrap;
        }
        .replies-section h3 {
            font-size: 16px;
            margin-bottom: 10px;
        }
        .reply-item {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        .reply-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #f0f0f0;
        }
        .reply-body {
            flex: 1;
        }
        .reply-author {
            font-weight: 600;
            font-size: 13px;
        }
        .reply-content {
            font-size: 14px;
            margin-top: 4px;
        }
        .reply-input-area {
            display: flex;
            align-items: center;
            padding: 10px;
            border-top: 1px solid #eee;
            background: #f9f9f9;
            gap: 8px;
        }
        .reply-input-area input {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 18px;
            padding: 8px 12px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s ease;
        }

        .reply-input-area input:focus {
            border-color: rgba(115, 145, 185, 0.6);
            box-shadow: 0 0 0 2px rgba(115, 145, 185, 0.1);
        }
        .reply-input-area button:not(.anonymous-toggle-btn) {
            background: rgba(115, 145, 185, 0.88); /* 更亮的雾霾蓝色，88%透明度 */
            color: white;
            border: none;
            border-radius: 18px;
            padding: 8px 15px;
            cursor: pointer;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 2px 8px rgba(115, 145, 185, 0.30);
            transition: all 0.2s ease;
            font-weight: 500;
            flex-shrink: 0;
        }

        .reply-input-area button:not(.anonymous-toggle-btn):hover {
            background: rgba(105, 135, 175, 0.94); /* 悬停时稍深 */
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(115, 145, 185, 0.40);
        }

        .reply-input-area button:not(.anonymous-toggle-btn):active {
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(115, 145, 185, 0.30);
        }

        /* --- 匿名回复按钮样式 --- */
        .anonymous-toggle-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: rgba(108, 117, 125, 0.15);
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
            flex-shrink: 0;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        .anonymous-toggle-btn:hover {
            background: rgba(108, 117, 125, 0.25);
            color: #495057;
            transform: scale(1.05);
        }

        .anonymous-toggle-btn.active {
            background: rgba(255, 193, 7, 0.2);
            color: #f57c00;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .anonymous-toggle-btn.active:hover {
            background: rgba(255, 193, 7, 0.3);
            color: #e65100;
        }

        /* --- 论坛个人主页分区 --- */
        .profile-tabs {
            display: flex;
            background-color: #fff;
            border-bottom: 1px solid #eee;
        }
        .profile-tab {
            flex: 1;
            text-align: center;
            padding: 12px 0;
            font-size: 15px;
            font-weight: 500;
            color: #888;
            cursor: pointer;
            position: relative;
            transition: color 0.2s ease;
        }
        .profile-tab.active {
            color: #333;
        }
        .profile-tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 3px;
            background-color: var(--accent-color);
            border-radius: 2px;
        }
        .profile-post-list {
            padding: 10px;
            height: calc(100% - 45px); /* 减去tab的高度 */
            overflow-y: auto;
        }

        /* 收藏按钮特殊样式 */
        #favorite-btn.favorited i {
            font-weight: 900; /* 实心图标 */
            color: #ffc107;
        }

        /* --- 聊天界面中的分享卡片样式 --- */
        .shared-post-card {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 15px;
            max-width: 240px; /* 限制卡片最大宽度 */
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        .shared-post-card:hover {
            background-color: #e9ecef;
        }
        .shared-post-header {
            font-size: 12px;
            color: #6c757d;
            margin-bottom: 8px;
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 8px;
        }
        .shared-post-title {
            font-size: 14px;
            font-weight: 600;
            color: #343a40;
            margin-bottom: 6px;
        }
        .shared-post-content {
            font-size: 13px;
            color: #495057;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3; /* 标准属性 */
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* 论坛个人主页 */
        #forum-profile-screen .post-list {
            padding-top: 0;
        }

        /* --- 通用头部操作按钮组 (最终修复方案) --- */
        /* 这个统一的规则将修复所有页面的右上角按钮，包括帖子详情和记忆查看器 */
        #forum-screen .header-actions,
        #forum-profile-screen .header-actions,
        #forum-view-screen .header-actions,
        #post-view-screen .header-actions,
        #memory-viewer-screen .header-actions {
            position: absolute;
            right: 20px;
            top: 70%; /* 使用正确且统一的垂直居中定位 */
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        /* --- 确保按钮本身样式正确 --- */
        #forum-screen .header-action-btn,
        #forum-profile-screen .header-action-btn,
        #post-view-screen .header-action-btn {
            background: none !important;
            border: none !important;
            font-size: 20px !important;
            color: #555 !important;
            cursor: pointer !important;
            padding: 0 !important;
            width: 32px !important;
            height: 32px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        /* 移除日记头部样式，让日期和天气作为正文的一部分 */

        #today-diary-content {
            position: relative;
        }

        #today-diary-content.empty {
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: var(--theme-font-family);
        }

        .empty-diary-message {
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            margin-top: -150px; /* 向上移动内容 */
        }

        .empty-diary-text {
            color: #6b7280;
            font-style: italic;
            font-size: 16px;
            font-weight: 500;
        }

        .generate-diary-link {
            background: none;
            border: none;
            color: var(--theme-button-bg, #4a84c1);
            font-size: 14px;
            cursor: pointer;
            text-decoration: underline;
            padding: 8px 12px;
            border-radius: 4px;
            transition: all 0.3s ease;
            font-family: inherit;
            animation: breathe 3s ease-in-out infinite;
        }

        @keyframes breathe {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.8;
            }
        }

        .generate-diary-link:hover {
            opacity: 0.8;
        }

        /* 🔥【新增】论坛评论区"加载更多评论"按钮样式 */
        .load-more-comments-container {
            display: flex;
            justify-content: center;
            padding: 20px 0;
            margin-top: 15px;
        }

        .load-more-comments-btn {
            background: none;
            border: none;
            color: var(--theme-button-bg, #4a84c1);
            font-size: 14px;
            cursor: pointer;
            text-decoration: underline;
            padding: 8px 12px;
            border-radius: 4px;
            transition: all 0.3s ease;
            font-family: inherit;
            font-weight: 500;
        }

        .load-more-comments-btn:hover {
            opacity: 0.8;
            transform: scale(1.05);
        }

        .load-more-comments-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        #past-diaries-list {
            height: calc(100vh - 280px);
            overflow-y: auto;
            padding: 0 5px;
        }

        /* 全屏模式下的过往日记条目样式调整 */
        #past-diaries-view .diary-entry .diary-paper-container {
            height: 250px; /* 固定高度，避免过高 */
        }

        #past-diaries-view .diary-entry-full.diary-paper {
            min-height: 250px;
            max-height: 250px;
        }

        .diary-entry {
            padding: 15px;
            margin-bottom: 15px;
            background: var(--bg-white-90);
            border-radius: 12px;
            border: 1px solid var(--border-black-05);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .diary-entry:hover {
            background: var(--bg-white-95);
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }

        .diary-entry:hover .diary-entry-arrow {
            color: var(--theme-button-bg, #4a84c1);
        }

        .diary-entry-date {
            font-size: 14px;
            font-weight: 600;
            color: var(--theme-button-bg, #4a84c1);
            margin-bottom: 8px;
        }

        .diary-entry-preview {
            font-size: 13px;
            color: #666;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            margin-right: 30px; /* 为箭头留出空间 */
        }

        .diary-entry-arrow {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 18px;
            color: #999;
            transition: color 0.2s ease;
        }

        .diary-entry-full {
            font-size: 14px;
            color: #333;
            line-height: 1.6;
            white-space: pre-wrap;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #eee;
            display: none;
        }

        /* 移除过往日记的展开容器样式，现在使用全屏查看 */

        /* 过往日记中的日记纸张样式调整 */
        .diary-entry-full.diary-paper {
            min-height: 180px;
            max-height: 300px;
            margin-top: 0; /* 移除margin，由容器控制 */
            border-top: none;
            padding: 45px 30px 25px 30px; /* 增加左右边距 */
            line-height: 28px;
            font-size: 12px; /* 缩小正文字体以适应有限的展示区域 */
            background: linear-gradient(to bottom,
                #fefefe 0%,
                #fefefe 35px,
                #e8f4fd 35px,
                #e8f4fd 37px,
                transparent 37px
            ),
            repeating-linear-gradient(
                transparent,
                transparent 27px,
                #e1e5e9 27px,
                #e1e5e9 28px
            );
        }

        /* 过往日记红线也已移除 */

        /* 过往日记容器的固定打孔效果 */
        .diary-entry .diary-paper-container::after {
            content: '';
            position: absolute;
            left: 10px; /* 调整位置 */
            top: 65px; /* 调整到合适位置 */
            width: 5px;
            height: 5px;
            border-radius: 50%;
            background-color: #f3f4f6;
            border: 1px solid #d1d5db;
            box-shadow:
                0 56px 0 #f3f4f6,  /* 调整间距，与28px行高对应 */
                0 56px 0 1px #d1d5db,
                0 112px 0 #f3f4f6, /* 56px * 2 */
                0 112px 0 1px #d1d5db,
                0 168px 0 #f3f4f6, /* 56px * 3 */
                0 168px 0 1px #d1d5db;
            z-index: 10;
            pointer-events: none;
        }

        /* 移除过往日记的头部样式 */

        /* 移除展开预览隐藏样式，现在使用全屏查看 */

        /* 纪念日应用样式 */
        .anniversary-list {
            padding: 20px;
        }

        .anniversary-empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .anniversary-empty-state i {
            font-size: 48px;
            color: #ff69b4;
            margin-bottom: 20px;
        }

        .anniversary-empty-state p {
            margin: 8px 0;
            font-size: 14px;
            line-height: 1.4;
        }

        /* 置顶纪念日/约定样式 */
        .pinned-anniversary-section,
        .pinned-appointment-section {
            padding: 8px 8px 4px 8px;
        }

        .pinned-anniversary-card,
        .pinned-appointment-card {
            background: transparent;
            border-radius: 0;
            padding: 0;
            margin: 2px;
            margin-bottom: 6px;
            border: none;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            position: relative;
            min-height: 140px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pinned-anniversary-card:hover,
        .pinned-appointment-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        /* 置顶卡片背景图 */
        .pinned-card-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 1;
            z-index: 1;
        }

        /* 置顶卡片内容 */
        .pinned-card-content {
            position: relative;
            z-index: 2;
            padding: 12px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            /* 移除模糊白色覆盖效果 */
        }

        /* 置顶卡片头部 */
        .pinned-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .pinned-card-avatars {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .pinned-card-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .pinned-card-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .pinned-card-avatar-fallback {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #6c7b7f, #8a9ba8);
            color: white;
            font-weight: 600;
            font-size: 18px;
        }

        .pinned-card-type {
            font-size: 12px;
            padding: 6px 12px;
            border-radius: 15px;
            color: white;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8), 0 0 8px rgba(0, 0, 0, 0.6);
        }

        /* 约定优先级角标 - 右下角 */
        .pinned-card-priority-badge {
            position: absolute;
            bottom: 12px;
            right: 12px;
            font-size: 11px;
            padding: 4px 8px;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
            z-index: 10;
        }

        /* 优先级颜色 */
        .pinned-card-priority-badge.low {
            background: rgba(76, 175, 80, 0.6);
        }

        .pinned-card-priority-badge.medium {
            background: rgba(255, 152, 0, 0.6);
        }

        .pinned-card-priority-badge.high {
            background: rgba(244, 67, 54, 0.6);
        }

        .pinned-card-priority-badge.urgent {
            background: rgba(156, 39, 176, 0.6);
        }

        /* 置顶卡片主要内容 */
        .pinned-card-main {
            text-align: center;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            margin: 12px 0;
        }

        .pinned-card-title {
            font-size: 18px;
            font-weight: 700;
            color: white;
            margin-bottom: 6px;
            text-shadow: 0 2px 6px rgba(0, 0, 0, 0.8), 0 0 12px rgba(0, 0, 0, 0.6);
        }

        .pinned-card-countdown {
            font-size: 36px;
            font-weight: 800;
            color: white;
            margin: 8px 0;
            text-shadow: 0 3px 8px rgba(0, 0, 0, 0.9), 0 0 16px rgba(0, 0, 0, 0.7), 0 1px 0 rgba(0, 0, 0, 1);
            line-height: 1;
        }

        .pinned-card-countdown-label {
            font-size: 14px;
            color: white;
            font-weight: 500;
            margin-top: 3px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8), 0 0 8px rgba(0, 0, 0, 0.6);
        }

        .pinned-card-date {
            font-size: 12px;
            color: white;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8), 0 0 8px rgba(0, 0, 0, 0.6);
        }

        /* 置顶卡片底部 */
        .pinned-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* 🔥【新增】用户语录样式 - 置顶卡片 */
        .pinned-card-user-quote {
            background: rgba(0, 122, 255, 0.1);
            padding: 8px 12px;
            border-radius: 8px;
            font-style: italic;
            color: #555;
            font-size: 11px;
            margin-bottom: 8px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
        }

        .pinned-card-user-quote i {
            color: #007AFF;
            margin-right: 6px;
        }

        .pinned-card-user-quote .quote-author {
            font-weight: 600;
            color: #007AFF;
            margin-right: 4px;
        }

        /* 角色语录样式 - 置顶卡片 */
        .pinned-card-quote {
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 12px;
            border-radius: 8px;
            font-style: italic;
            color: #555;
            font-size: 11px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
        }

        .pinned-card-quote i {
            color: #3498db;
            margin-right: 6px;
        }

        .pinned-card-quote .quote-author {
            font-weight: 600;
            color: #3498db;
            margin-right: 4px;
        }

        .pinned-card-actions {
            display: flex;
            gap: 8px;
        }

        .pinned-card-action-btn {
            padding: 6px 8px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: rgba(255, 255, 255, 0.9);
            color: #666;
            font-weight: 500;
            min-width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pinned-card-action-btn:hover {
            transform: scale(1.05);
            background: white;
        }

        .pinned-card-unpin-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pinned-card-unpin-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        /* 🔥【新增】长按删除视觉反馈 */
        .anniversary-item.long-pressing,
        .pinned-anniversary-card.long-pressing,
        .appointment-item.long-pressing,
        .pinned-appointment-card.long-pressing {
            transform: scale(0.98);
            opacity: 0.8;
            transition: all 0.2s ease;
        }

        /* 纪念日分栏样式 */
        .anniversary-content-pane {
            height: 100%;
            overflow-y: auto;
        }

        .anniversary-tabs {
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            border-top: 1px solid var(--color-border-light);
            background-color: var(--color-gray-bg-light);
            flex-shrink: 0;
        }

        .anniversary-tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--color-text-light);
            font-size: 12px;
            cursor: pointer;
        }

        .anniversary-tab.active {
            color: #ff69b4;
        }

        .anniversary-tab i {
            font-size: 24px;
            margin-bottom: 3px;
        }

        .anniversary-item {
            background: white;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 0;
            margin-bottom: 8px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            cursor: pointer;
            overflow: hidden;
        }

        .anniversary-item:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
        }

        /* 简洁条状样式 */
        .anniversary-item-compact {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            min-height: 48px;
        }

        .anniversary-item-compact-left {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .anniversary-item-compact-name {
            font-size: 15px;
            font-weight: 600;
            color: #333;
            margin: 0;
        }

        .anniversary-item-compact-countdown {
            background: transparent;
            color: #333;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            min-width: 60px;
            text-align: center;
        }

        /* 展开状态的详细内容 */
        .anniversary-item-details {
            padding: 16px;
            border-top: 1px solid rgba(0, 0, 0, 0.05);
            background: rgba(255, 255, 255, 0.5);
            display: none;
        }

        .anniversary-item.expanded .anniversary-item-details {
            display: block;
        }

        .anniversary-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .anniversary-item-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .anniversary-item-type {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 12px;
            color: white;
            font-weight: 500;
        }

        .anniversary-item-type.birthday {
            background: #ff6b6b;
        }

        .anniversary-item-type.anniversary {
            background: #ff69b4;
        }

        .anniversary-item-type.holiday {
            background: #4ecdc4;
        }

        .anniversary-item-type.other {
            background: #a8e6cf;
        }

        .anniversary-item-date {
            font-size: 16px;
            color: #666;
            margin-bottom: 8px;
        }

        .anniversary-item-countdown {
            font-size: 14px;
            color: #ff69b4;
            font-weight: 600;
        }

        .anniversary-item-description {
            font-size: 13px;
            color: #888;
            line-height: 1.4;
            margin-top: 8px;
        }

        .anniversary-item-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            justify-content: flex-end;
        }

        .anniversary-action-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 50%;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
        }

        .anniversary-edit-btn {
            background: rgba(0, 0, 0, 0.05);
            color: #666;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .anniversary-edit-btn:hover {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
            transform: scale(1.1);
        }

        .anniversary-delete-btn {
            background: #e57373;
            color: white;
            border: 1px solid rgba(229, 115, 115, 0.3);
        }

        .anniversary-delete-btn:hover {
            background: #ef5350;
            transform: scale(1.1);
        }

        /* 通用按钮hover效果已移至具体按钮样式中 */

        /* 约定应用样式 */
        .appointment-list {
            padding: 20px;
        }

        .appointment-empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .appointment-empty-state i {
            font-size: 48px;
            color: #4ecdc4;
            margin-bottom: 20px;
        }

        .appointment-empty-state p {
            margin: 8px 0;
            font-size: 14px;
            line-height: 1.4;
        }

        .appointment-item {
            background: white;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 0;
            margin-bottom: 8px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            cursor: pointer;
            overflow: hidden;
        }

        .appointment-item:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
        }

        /* 简洁条状样式 */
        .appointment-item-compact {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            min-height: 48px;
        }

        .appointment-item-left {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .appointment-item-right {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
        }

        .appointment-item.completed {
            opacity: 0.7;
            background: var(--bg-white-70);
        }

        /* 展开状态的详细内容 */
        .appointment-item-details {
            padding: 16px;
            border-top: 1px solid rgba(0, 0, 0, 0.05);
            background: rgba(255, 255, 255, 0.5);
            display: none;
        }

        .appointment-item.expanded .appointment-item-details {
            display: block;
        }

        .appointment-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .appointment-item-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin: 0;
            line-height: 1.3;
        }

        .appointment-item.completed .appointment-item-name {
            text-decoration: line-through;
            color: #999;
        }

        .appointment-item-time {
            font-size: 13px;
            color: #666;
            margin: 0;
            line-height: 1.2;
        }

        .appointment-item-status {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
            font-weight: 500;
            white-space: nowrap;
        }

        .appointment-item-status.pending {
            background: #fff3cd;
            color: #856404;
        }

        .appointment-item-status.completed {
            background: #d4edda;
            color: #155724;
        }

        .appointment-item-status.overdue {
            background: #f8d7da;
            color: #721c24;
        }

        /* 🔥【新增】永不过期状态样式 */
        .appointment-item-status.never-expires {
            background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
            color: #5e35b1;
            font-weight: 600;
        }

        /* 🔥【新增】约定倒计时样式 */
        .appointment-countdown {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 10px;
            font-weight: 500;
            white-space: nowrap;
        }

        .appointment-countdown.pending {
            background: #fff3cd;
            color: #856404;
        }

        .appointment-countdown.completed {
            background: #d4edda;
            color: #155724;
        }

        .appointment-countdown.overdue {
            background: #f8d7da;
            color: #721c24;
        }

        .appointment-countdown.never-expires {
            background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
            color: #5e35b1;
            font-weight: 600;
            font-size: 14px;
        }

        .appointment-edit-btn {
            background: rgba(0, 0, 0, 0.05);
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #666;
            font-size: 12px;
        }

        .appointment-edit-btn:hover {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
            transform: scale(1.1);
        }

        .appointment-item-type {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 12px;
            color: white;
            font-weight: 500;
        }

        .appointment-item-type.meeting {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
        }

        .appointment-item-type.appointment {
            background: linear-gradient(135deg, #ff69b4, #ff8fa3);
        }

        .appointment-item-type.task {
            background: linear-gradient(135deg, #ffa726, #ffb74d);
        }

        .appointment-item-type.reminder {
            background: linear-gradient(135deg, #ab47bc, #ba68c8);
        }

        .appointment-item-type.other {
            background: linear-gradient(135deg, #a8e6cf, #88d8a3);
        }

        .appointment-item-datetime {
            font-size: 16px;
            color: #666;
            margin-bottom: 8px;
        }

        .appointment-item-priority {
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 8px;
            font-weight: 500;
            margin-left: 8px;
        }

        .appointment-item-priority.low {
            background: #e8f5e8;
            color: #4caf50;
        }

        .appointment-item-priority.medium {
            background: #fff3e0;
            color: #ff9800;
        }

        .appointment-item-priority.high {
            background: #ffebee;
            color: #f44336;
        }

        .appointment-item-priority.urgent {
            background: #f44336;
            color: white;
        }

        .appointment-item-description {
            font-size: 13px;
            color: #888;
            line-height: 1.4;
            margin-top: 8px;
        }

        .appointment-item-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .appointment-action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .appointment-complete-btn {
            background: #81c784;
            color: white;
        }

        .appointment-edit-btn {
            background: #64b5f6;
            color: white;
        }

        .appointment-delete-btn {
            background: #e57373;
            color: white;
        }

        .appointment-action-btn:hover {
            transform: scale(1.05);
            opacity: 0.9;
        }

        .appointment-complete-btn:hover {
            background: #66bb6a;
        }

        .appointment-edit-btn:hover {
            background: #42a5f5;
        }

        .appointment-delete-btn:hover {
            background: #ef5350;
        }

        /* 角色信息显示样式 */
        .anniversary-character-info,
        .appointment-character-info {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 6px;
            font-size: 13px;
            color: #666;
        }

        .character-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            overflow: hidden;
            position: relative;
        }

        .character-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .character-avatar-fallback {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ff69b4, #ff8fa3);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }

        .character-name {
            font-weight: 500;
        }

        /* 🔥【新增】用户语录样式 - 常规列表 */
        .anniversary-user-quote,
        .appointment-user-quote {
            background: rgba(0, 122, 255, 0.1);
            padding: 12px 15px;
            margin-top: 12px;
            border-radius: 8px;
            font-style: italic;
            color: #555;
            position: relative;
        }

        .anniversary-user-quote i,
        .appointment-user-quote i {
            color: #007AFF;
            margin-right: 8px;
            font-size: 14px;
        }

        /* 角色语录样式 */
        .anniversary-character-quote,
        .appointment-character-quote {
            background: rgba(255, 182, 193, 0.1);
            padding: 12px 15px;
            margin-top: 12px;
            border-radius: 8px;
            font-style: italic;
            color: #555;
            position: relative;
        }

        .anniversary-character-quote i,
        .appointment-character-quote i {
            color: #ff69b4;
            margin-right: 8px;
            font-size: 14px;
        }

        /* 共享状态样式 - 已移除共享标签和背景 */
        .anniversary-item.shared,
        .appointment-item.shared {
            background: white;
        }

        /* 移除共享标签 */
        .anniversary-item.shared::before,
        .appointment-item.shared::before {
            display: none;
        }

        .anniversary-item,
        .appointment-item {
            position: relative;
        }

        /* 短信应用样式 */
        .messages-list {
            padding: 20px;
        }







        /* 短信选择器模态框样式 */
        .sms-selector-modal {
            max-width: 400px;
            width: 90%;
            max-height: 70vh;
        }

        #sms-persona-selector-body, #sms-character-selector-body {
            max-height: 400px;
            overflow-y: auto;
        }

        .sms-character-item, .sms-persona-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
        }

        .sms-character-item:hover, .sms-persona-item:hover {
            background-color: #f8f9fa;
        }

        .sms-character-item:last-child, .sms-persona-item:last-child {
            border-bottom: none;
        }

        .sms-empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #999;
            font-size: 14px;
        }

        /* 短信聊天界面样式 */
        .sms-chat-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* 短信聊天界面头部布局调整 */
        #sms-chat-screen .app-header {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        /* 短信聊天界面中央头像和名字区域 */
        .sms-chat-header-center {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        /* 短信聊天界面角色头像 */
        .sms-chat-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #666;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            overflow: hidden;
        }

        .sms-chat-avatar i {
            font-size: 14px;
        }

        /* 短信聊天界面角色名字 */
        .sms-chat-name {
            font-size: 10px;
            font-weight: 500;
            color: #333;
            text-align: center;
            max-width: 100px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            line-height: 1.1;
        }

        /* 兼容旧版本的app-title样式（如果还有其他地方使用） */
        #sms-chat-screen .app-title {
            display: none; /* 隐藏旧的标题元素 */
        }

        .sms-action-btn {
            position: absolute;
            right: calc(var(--spacing-lg) + 3px);
            top: 43px;
            width: var(--size-md);
            height: var(--size-md);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: var(--font-size-xxl);
            color: #C7C7CC;
            border: none;
            background: transparent;
            border-radius: 50%;
        }



        .sms-chat-content {
            padding: 0;
            display: flex;
            flex-direction: column;
            height: calc(100vh - 140px);
        }

        .sms-messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            padding-bottom: 100px;
        }

        .sms-input-section {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            z-index: 100;
            border-top: 1px solid rgba(255, 255, 255, 0.3);
        }

        .sms-input-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sms-message-input {
            flex: 1;
            padding: 8px 15px;
            border: 1px solid rgba(209, 209, 214, 0.6);
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.9);
            font-size: 16px;
            outline: none;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .sms-message-input::placeholder {
            color: #d1d1d6;
        }

        .sms-attachment-btn, .sms-send-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: #d1d1d6;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .sms-attachment-btn {
            background: #e8e8e8;
            color: #777777;
        }

        .sms-send-btn {
            background: #007AFF;
            color: white;
            font-size: 14px;
        }

        .sms-send-btn:hover {
            background: #0056b3;
        }

        .sms-attachment-btn:hover {
            background: #bbb;
        }

        /* 短信输入框包装器 */
        .sms-input-wrapper {
            position: relative;
            flex: 1;
            display: flex;
            align-items: center;
        }

        .sms-input-wrapper .sms-message-input {
            flex: 1;
            padding-right: 40px; /* 为内部按钮留出空间 */
        }

        /* 短信等待回复按钮 - 位于输入框内部右端 */
        .sms-wait-reply-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #8E8E93;
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            opacity: 0.6;
        }

        /* 覆盖全局按钮悬停效果，保持按钮安静 */
        .sms-wait-reply-btn:hover {
            transform: translateY(-50%) !important;
            background: #8E8E93 !important;
            opacity: 0.6 !important;
        }

        .sms-wait-reply-btn:active {
            transform: translateY(-50%) !important;
        }

        /* 短信界面移除内边距并设置白色背景 */
        #messages-screen .app-content {
            padding: 0;
            background: white;
        }

        /* 短信消息列表样式 */
        .messages-list {
            padding: 0;
            background: white;
            margin-top: 0;
            min-height: 100%;
        }

        .sms-message-item {
            display: flex;
            align-items: flex-start;
            padding: 5px 20px 18px 23px;
            background: white;
            border-bottom: none;
            cursor: pointer;
            transition: background-color 0.2s ease;
            position: relative;
        }

        /* 分割线从头像右边开始 */
        .sms-message-item:not(:last-child)::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 77px; /* 23px左边距 + 42px头像宽度 + 12px头像右边距 */
            right: 0;
            height: 1px;
            background-color: #e5e5ea;
        }

        .sms-message-item:hover {
            background: #f8f8f8;
        }

        .sms-message-avatar {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            margin-right: 12px;
            margin-top: 7px;
            flex-shrink: 0;
            overflow: hidden;
            background: #e5e5ea;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sms-message-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .sms-avatar-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #c7c7cc;
            color: white;
            font-size: 18px;
            font-weight: 500;
        }

        .sms-message-content {
            flex: 1;
            min-width: 0;
        }

        .sms-message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .sms-message-name {
            font-size: 16px;
            font-weight: 600;
            color: #000;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }



        .sms-message-preview {
            font-size: 14px;
            color: #8e8e93;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.3;
        }

        .sms-message-arrow {
            margin-left: 8px;
            color: #c7c7cc;
            font-size: 14px;
        }

        /* 短信空状态样式 - 纯白背景 */
        .messages-empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: calc(100vh - 200px);
            color: #8e8e93;
            text-align: center;
            background: white;
            padding: 40px 20px;
            margin-top: -90px;
        }

        .messages-empty-state i {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
            color: #007AFF;
        }

        .messages-empty-state p {
            margin: 4px 0;
            font-size: 16px;
            line-height: 1.4;
        }

        /* 短信界面头部按钮容器 */
        .messages-header-actions {
            position: absolute;
            right: 19px;
            top: 40px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* 短信界面编辑按钮 */
        .add-message-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            background: transparent;
            border: none;
            color: #000;
            font-size: 18px;
        }

        /* 短信聊天设置界面样式 - 简洁美化版 */
        .sms-settings-content {
            padding: 0;
            background: #f2f2f7;
        }

        .sms-settings-content .setting-group {
            background: white;
            margin-bottom: 0;
            border-radius: 0;
            border-bottom: none;
        }

        .sms-settings-content .setting-group:not(:last-child) {
            border-bottom: 1px solid #f0f0f0;
        }

        .sms-settings-content .setting-group h4 {
            margin: 0;
            padding: 16px 20px 8px 20px;
            font-size: 14px;
            font-weight: 600;
            color: #5A7FBF;
            text-transform: none;
            letter-spacing: 0.3px;
            display: flex;
            align-items: center;
            gap: 8px;
            background: #fafafa;
        }

        .sms-settings-content .setting-group h4 i {
            color: #5A7FBF;
            font-size: 16px;
        }

        .sms-settings-content .setting-item {
            padding: 16px 20px;
            border-bottom: 1px solid #e8e8e8;
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-height: 50px;
            transition: background-color 0.2s ease;
        }

        .sms-settings-content .setting-item:hover {
            background-color: #f8f8f8;
        }

        .sms-settings-content .setting-item:last-child {
            border-bottom: none;
        }

        .sms-settings-content .setting-item label {
            display: block;
            margin: 0;
            font-size: 17px;
            font-weight: 400;
            color: #000000;
            flex: 1;
        }

        /* 滑块容器样式 */
        .sms-settings-content .slider-container {
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 150px;
        }

        .sms-settings-content .slider-container input[type="range"] {
            flex: 1;
            min-width: 100px;
            height: 4px;
            border-radius: 2px;
            background: #e5e5ea;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .sms-settings-content .slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #5A7FBF;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .sms-settings-content .slider-container input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #5A7FBF;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .sms-settings-content .slider-container span {
            font-size: 15px;
            color: #5A7FBF;
            font-weight: 500;
            min-width: 50px;
            text-align: right;
        }

        /* 气泡颜色选择样式 - 文字选择条 */
        .bubble-color-selector {
            display: flex;
            background: #f5f5f5;
            border-radius: 8px;
            padding: 4px;
            gap: 2px;
        }

        .color-option-text {
            flex: 1;
            padding: 8px 16px;
            text-align: center;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
            font-weight: 500;
            color: #666;
            background: transparent;
        }

        .color-option-text:hover {
            background: rgba(0, 0, 0, 0.05);
            color: #333;
        }

        .color-option-text.active {
            background: white;
            color: #007AFF;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .color-option-text[data-color="blue"].active {
            color: #007AFF;
        }

        .color-option-text[data-color="green"].active {
            color: #34C759;
        }



        /* 短信消息气泡样式 */
        .sms-message {
            display: flex;
            margin-bottom: 12px;
            align-items: flex-end;
        }

        .sms-message.user-message {
            justify-content: flex-end;
        }

        .sms-message.character-message {
            justify-content: flex-start;
        }

        /* 🔥【新增】短信消息滑入动画效果 - 使用内联样式控制 */

        .sms-message-bubble {
            position: relative;
            max-width: 70%;
            padding: 6px 10px;
            border-radius: 14.5px;
            font-size: 14px !important;
            line-height: 1.3 !important;
            word-wrap: break-word;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            /* 🔥【修复】强制使用系统字体避免自定义字体换行问题 */
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif !important;
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            white-space: normal !important;
            word-break: normal !important;
            overflow-wrap: normal !important;
        }

        /* 用户消息气泡 - 默认蓝色 */
        .sms-message.user-message .sms-message-bubble {
            background: #1689FE;
            color: white;
        }

        .sms-message.user-message .sms-message-bubble::after {
            content: '';
            position: absolute;
            right: -5.75px;
            bottom: 0px;
            width: 13px;
            height: 19px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="13" height="19.0625" viewBox="0 0 13 19.0625" fill="none"><path d="M0 14C3.5 18.5 9 20 13 18.5C9.5 15.5 6 15 7 0L0 1L0 7.75L0 14Z" fill="%231689FE"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        /* 用户消息气泡 - 绿色变体 */
        .sms-message.user-message.green-bubble .sms-message-bubble {
            background: #34C759;
        }

        .sms-message.user-message.green-bubble .sms-message-bubble::after {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="13" height="19.0625" viewBox="0 0 13 19.0625" fill="none"><path d="M0 14C3.5 18.5 9 20 13 18.5C9.5 15.5 6 15 7 0L0 1L0 7.75L0 14Z" fill="%2334C759"/></svg>');
        }

        /* 角色消息气泡 - 灰色 */
        .sms-message.character-message .sms-message-bubble {
            background: #E5E5EA;
            color: #000;
        }

        .sms-message.character-message .sms-message-bubble::after {
            content: '';
            position: absolute;
            left: -6px;
            bottom: 0px;
            width: 13px;
            height: 19px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="13" height="19.0625" viewBox="0 0 13 19.0625" fill="none"><path d="M13 14C9.49999 18.5 4 20 0 18.5C3.49998 15.5 7 15 6 0L13 1L13 7.75L13 14Z" fill="%23E5E5EA"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        /* iPhone风格的时间戳 - 显示在屏幕中央 */
        .sms-timestamp {
            font-size: 12px;
            color: #8E8E93;
            text-align: center;
            margin: 16px 0 8px 0;
            font-weight: 400;
        }

        /* 短信列表中的时间样式 */
        .sms-message-header .sms-message-time {
            font-size: 14px;
            color: #8e8e93;
            white-space: nowrap;
            transform: translateY(-4px);
        }

        /* 隐藏聊天界面中气泡旁边的时间 */
        .sms-messages-container .sms-message-time {
            display: none;
        }

        /* 绿色气泡容器样式 */
        .sms-messages-container.green-bubble .sms-message.user-message .sms-message-bubble {
            background: #34C759;
        }

        .sms-messages-container.green-bubble .sms-message.user-message .sms-message-bubble::after {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="13" height="19.0625" viewBox="0 0 13 19.0625" fill="none"><path d="M0 14C3.5 18.5 9 20 13 18.5C9.5 15.5 6 15 7 0L0 1L0 7.75L0 14Z" fill="%2334C759"/></svg>');
        }

        /* 短信正在输入指示器 */
        .sms-typing-indicator {
            display: flex;
            margin-bottom: 12px;
            align-items: flex-end;
            justify-content: flex-start;
        }

        .sms-typing-bubble {
            position: relative;
            background: #E5E5EA;
            color: #000;
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.3;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .sms-typing-bubble::after {
            content: '';
            position: absolute;
            left: -4.5px;
            bottom: 0px;
            width: 13px;
            height: 19px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="13" height="19.0625" viewBox="0 0 13 19.0625" fill="none"><path d="M13 14C9.49999 18.5 4 20 0 18.5C3.49998 15.5 7 15 6 0L13 1L13 7.75L13 14Z" fill="%23E5E5EA"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        /* 三个跳动的点 */
        .sms-typing-dots {
            display: flex;
            gap: 3px;
            align-items: center;
        }

        .sms-typing-dot {
            width: 6px;
            height: 6px;
            background: #8e8e93;
            border-radius: 50%;
            animation: sms-typing-bounce 1.4s infinite ease-in-out;
        }

        .sms-typing-dot:nth-child(1) {
            animation-delay: -0.32s;
        }

        .sms-typing-dot:nth-child(2) {
            animation-delay: -0.16s;
        }

        .sms-typing-dot:nth-child(3) {
            animation-delay: 0s;
        }

        @keyframes sms-typing-bounce {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* 短信消息菜单样式 */
        .sms-message-menu {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            min-width: 120px;
            animation: sms-menu-appear 0.2s ease-out;
        }

        .sms-menu-item {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 14px;
            color: #333;
            transition: background-color 0.2s ease;
        }

        .sms-menu-item:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .sms-menu-item i {
            font-size: 12px;
            color: #ff3b30;
        }

        @keyframes sms-menu-appear {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* 短信消息气泡长按效果 */
        .sms-message-bubble {
            transition: transform 0.1s ease;
            cursor: pointer;
        }

        .sms-message-bubble:active {
            transform: scale(0.98);
        }

        /* 🔥【新增】短信图片容器样式 */
        .sms-image-container {
            position: relative;
            max-width: 70%;
            cursor: pointer;
            transition: transform 0.1s ease;
        }

        .sms-image-container:active {
            transform: scale(0.98);
        }

        /* 短信图片样式 */
        .sms-image {
            max-width: 100%;
            max-height: 300px;
            min-width: 150px;
            min-height: 100px;
            border-radius: 12px;
            object-fit: cover;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            display: block;
        }

        .sms-image:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        /* 用户发送的图片 - 右对齐 */
        .sms-message.user-message .sms-image-container {
            margin-left: auto;
        }

        /* 角色发送的图片 - 左对齐 */
        .sms-message.character-message .sms-image-container {
            margin-right: auto;
        }

        .sms-item-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: #666;
            font-size: 16px;
            overflow: hidden;
        }

        .sms-item-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .sms-item-info {
            flex: 1;
        }

        .sms-item-name {
            font-size: 16px;
            font-weight: 500;
            color: #333;
            margin-bottom: 2px;
        }

        .sms-item-desc {
            font-size: 14px;
            color: #666;
        }

        /* 取消按钮样式 */
        .cancel-btn {
            background: none;
            border: none;
            color: #007AFF;
            font-size: 16px;
            cursor: pointer;
            padding: 8px 12px;
        }

        /* 游戏相关取消按钮样式 - 保持原有的margin-top */
        .game-cancel-btn {
            background: rgba(188, 188, 188, 0.8);
            color: #5a5a5a;
            margin-top: 6px;
        }

        .game-cancel-btn:hover {
            background: rgba(188, 188, 188, 0.9);
            transform: translateY(-1px);
        }



        /* 纪念日和约定表单样式 */
        #anniversary-form-modal .modal-content,
        #appointment-form-modal .modal-content {
            max-width: 420px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
        }

        #anniversary-form-modal .modal-body,
        #appointment-form-modal .modal-body {
            padding: 20px 24px;
        }

        #anniversary-form-modal .form-group,
        #appointment-form-modal .form-group {
            margin-bottom: 20px;
        }

        #anniversary-form-modal .form-group:last-child,
        #appointment-form-modal .form-group:last-child {
            margin-bottom: 0;
        }

        #anniversary-form-modal label,
        #appointment-form-modal label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
            font-size: 15px;
            position: relative;
        }

        /* 必填字段标识 */
        #anniversary-form-modal label[for="anniversary-name"]::after,
        #anniversary-form-modal label[for="anniversary-date"]::after,
        #appointment-form-modal label[for="appointment-name"]::after,
        #appointment-form-modal label[for="appointment-date"]::after {
            content: "*";
            color: #ff69b4;
            margin-left: 4px;
            font-weight: 700;
        }

        /* 输入框基础样式 */
        #anniversary-form-modal input,
        #anniversary-form-modal select,
        #anniversary-form-modal textarea,
        #appointment-form-modal input,
        #appointment-form-modal select,
        #appointment-form-modal textarea {
            width: 100%;
            border: 2px solid #e8e8e8;
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: #fafafa;
            box-sizing: border-box;
            position: relative;
        }

        /* 输入框动画效果 */
        #anniversary-form-modal input:not(:placeholder-shown),
        #anniversary-form-modal select:not([value=""]),
        #anniversary-form-modal textarea:not(:placeholder-shown),
        #appointment-form-modal input:not(:placeholder-shown),
        #appointment-form-modal select:not([value=""]),
        #appointment-form-modal textarea:not(:placeholder-shown) {
            background: white;
            border-color: #d0d7ff;
        }

        /* 文本输入框 */
        #anniversary-form-modal input[type="text"],
        #appointment-form-modal input[type="text"] {
            padding: 14px 18px;
            height: 50px;
            font-weight: 500;
        }

        /* 日期和时间输入框 */
        #anniversary-form-modal input[type="date"],
        #anniversary-form-modal input[type="time"],
        #appointment-form-modal input[type="date"],
        #appointment-form-modal input[type="time"] {
            padding: 12px 16px;
            height: 46px;
            background: linear-gradient(135deg, #f8f9ff, #fafafa);
            border-color: #d0d7ff;
        }

        #anniversary-form-modal input[type="date"]:focus,
        #anniversary-form-modal input[type="time"]:focus,
        #appointment-form-modal input[type="date"]:focus,
        #appointment-form-modal input[type="time"]:focus {
            border-color: #007AFF;
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
        }

        /* 下拉选择框 */
        #anniversary-form-modal select,
        #appointment-form-modal select {
            padding: 13px 40px 13px 18px;
            height: 48px;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 14px center;
            background-size: 18px;
            cursor: pointer;
            font-weight: 500;
        }

        /* 文本域 */
        #anniversary-form-modal textarea,
        #appointment-form-modal textarea {
            padding: 16px 18px;
            min-height: 85px;
            resize: vertical;
            line-height: 1.6;
            font-family: inherit;
        }

        /* 角色语录文本域 */
        #anniversary-character-quote,
        #appointment-character-quote {
            min-height: 60px;
            background: rgba(255, 255, 255, 0.9) !important;
        }

        /* 自定义类型输入框 */
        #anniversary-custom-type,
        #appointment-custom-type {
            background: linear-gradient(135deg, #fff5f8, #fafafa) !important;
            border-color: #ffb6c1 !important;
        }

        #anniversary-custom-type:focus,
        #appointment-custom-type:focus {
            border-color: #ff69b4 !important;
            box-shadow: 0 0 0 3px rgba(255, 105, 180, 0.15) !important;
            background: white !important;
        }

        /* 焦点状态 */
        #anniversary-form-modal input:focus,
        #anniversary-form-modal select:focus,
        #anniversary-form-modal textarea:focus,
        #appointment-form-modal input:focus,
        #appointment-form-modal select:focus,
        #appointment-form-modal textarea:focus {
            outline: none;
            border-color: #ff69b4;
            box-shadow: 0 0 0 3px rgba(255, 105, 180, 0.1);
            background: white;
        }

        /* 复选框样式 */
        #anniversary-form-modal .checkbox-label,
        #appointment-form-modal .checkbox-label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
            cursor: pointer;
            padding: 8px 0;
            font-size: 14px;
        }

        #anniversary-form-modal .checkbox-label input[type="checkbox"],
        #appointment-form-modal .checkbox-label input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin: 0;
            cursor: pointer;
            accent-color: #ff69b4;
        }

        /* 占位符样式 */
        #anniversary-form-modal input::placeholder,
        #anniversary-form-modal textarea::placeholder,
        #appointment-form-modal input::placeholder,
        #appointment-form-modal textarea::placeholder {
            color: #aaa;
            font-style: italic;
        }

        /* 输入框悬停效果 */
        #anniversary-form-modal input:hover,
        #anniversary-form-modal select:hover,
        #anniversary-form-modal textarea:hover,
        #appointment-form-modal input:hover,
        #appointment-form-modal select:hover,
        #appointment-form-modal textarea:hover {
            border-color: #ddd;
            background: #f8f8f8;
        }

        /* 表单标题样式 */
        #anniversary-form-modal .modal-header h3,
        #appointment-form-modal .modal-header h3 {
            color: #333;
            font-size: 20px;
            font-weight: 700;
            margin: 0;
        }

        /* 模态框关闭按钮 */
        #anniversary-form-modal .modal-close,
        #appointment-form-modal .modal-close {
            background: #f5f5f5;
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #666;
        }

        #anniversary-form-modal .modal-close:hover,
        #appointment-form-modal .modal-close:hover {
            background: #e8e8e8;
            transform: scale(1.1);
        }

        /* 响应式设计 */
        @media (max-width: 480px) {
            #anniversary-form-modal .modal-content,
            #appointment-form-modal .modal-content {
                width: 95%;
                max-height: 90vh;
            }

            #anniversary-form-modal .modal-body,
            #appointment-form-modal .modal-body {
                padding: 16px 20px;
            }

            #anniversary-form-modal input[type="text"],
            #appointment-form-modal input[type="text"] {
                height: 44px;
                font-size: 16px; /* 防止iOS缩放 */
            }

            #anniversary-form-modal .form-group,
            #appointment-form-modal .form-group {
                margin-bottom: 16px;
            }

            #anniversary-character-quote-group,
            #appointment-character-quote-group {
                padding: 16px;
            }
        }

        /* 小组件模态框样式 */
        #photo-widget-modal .form-group,
        #anniversary-widget-modal .form-group {
            margin-bottom: 20px;
        }

        #photo-widget-modal label,
        #anniversary-widget-modal label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        #photo-widget-modal input,
        #photo-widget-modal select,
        #anniversary-widget-modal input,
        #anniversary-widget-modal select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        #photo-widget-modal input:focus,
        #photo-widget-modal select:focus,
        #anniversary-widget-modal input:focus,
        #anniversary-widget-modal select:focus {
            outline: none;
            border-color: #007AFF;
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
        }

        /* 表单提示文字样式 */
        .form-hint {
            color: #888;
            font-size: 12px;
            margin-top: 4px;
            display: block;
        }

        /* 背景图和头像预览样式 */
        .background-preview,
        .avatar-preview {
            margin-top: 12px;
            position: relative;
            display: inline-block;
        }

        .background-preview {
            width: 100%;
            max-width: 200px;
            height: 100px;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid #e8e8e8;
        }

        .avatar-preview {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid #e8e8e8;
        }

        .background-preview img,
        .avatar-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .remove-background-btn,
        .remove-avatar-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #ff4444;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(255, 68, 68, 0.3);
        }

        .remove-background-btn:hover,
        .remove-avatar-btn:hover {
            background: #ff2222;
            transform: scale(1.1);
        }

        /* 角色语录组样式 */
        #anniversary-character-quote-group,
        #appointment-character-quote-group {
            background: linear-gradient(135deg, rgba(255, 182, 193, 0.08), rgba(255, 192, 203, 0.05));
            border-radius: 16px;
            padding: 20px;
            border: 2px solid rgba(255, 182, 193, 0.2);
            margin-top: 8px;
            position: relative;
        }

        #anniversary-character-quote-group::before,
        #appointment-character-quote-group::before {
            content: "💭";
            position: absolute;
            top: -8px;
            left: 16px;
            background: white;
            padding: 0 8px;
            font-size: 16px;
        }

        #anniversary-character-quote-group label,
        #appointment-character-quote-group label {
            color: #ff69b4;
            font-weight: 600;
            margin-bottom: 8px;
        }

        #anniversary-character-quote,
        #appointment-character-quote {
            background: rgba(255, 255, 255, 0.9) !important;
            border: 2px solid rgba(255, 182, 193, 0.3) !important;
            border-radius: 12px !important;
        }

        #anniversary-character-quote:focus,
        #appointment-character-quote:focus {
            border-color: #ff69b4 !important;
            box-shadow: 0 0 0 3px rgba(255, 105, 180, 0.15) !important;
        }

        /* 表单按钮样式优化 */
        #anniversary-form-modal .modal-footer,
        #appointment-form-modal .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid #f0f0f0;
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        #anniversary-form-modal .btn,
        #appointment-form-modal .btn {
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 80px;
        }

        #anniversary-form-modal .btn-secondary,
        #appointment-form-modal .btn-secondary {
            background: #f5f5f5;
            color: #666;
        }

        #anniversary-form-modal .btn-secondary:hover,
        #appointment-form-modal .btn-secondary:hover {
            background: #e8e8e8;
            transform: translateY(-1px);
        }

        #anniversary-form-modal .btn-primary,
        #appointment-form-modal .btn-primary {
            background: #ffa0b4;
            color: white;
            box-shadow: 0 4px 12px rgba(255, 160, 180, 0.3);
        }

        /* 🔥【禁用响应式】大屏幕适配 - 使用固定尺寸 */
        @media (min-width: 401px) {
            #home-grid {
                width: var(--fixed-home-grid-width) !important;
                height: var(--fixed-home-grid-width) !important;
                gap: var(--fixed-home-grid-gap) !important;
            }

            .mini-app-icon {
                width: var(--fixed-mini-app-icon-size) !important;
                height: var(--fixed-mini-app-icon-size) !important;
                border-radius: var(--fixed-mini-app-icon-radius) !important;
            }

            .mini-app-icon i {
                font-size: var(--fixed-mini-app-font-size) !important;
            }

            .mini-app {
                font-size: var(--fixed-mini-app-text-size) !important;
            }

            .large-app-icon {
                width: var(--fixed-large-app-icon-size) !important;
                height: var(--fixed-large-app-icon-size) !important;
                border-radius: var(--fixed-large-app-icon-radius) !important;
            }

            .large-app-icon i {
                font-size: var(--fixed-large-app-font-size) !important;
            }

            .large-app {
                font-size: var(--fixed-large-app-text-size) !important;
            }

            .anniversary-name {
                font-size: var(--fixed-anniversary-name-size) !important;
            }

            .anniversary-countdown {
                font-size: var(--fixed-anniversary-countdown-size) !important;
            }

            .photo-placeholder i {
                font-size: 28px;
            }

            .photo-placeholder {
                font-size: 13px;
            }

            #dock-bar {
                width: 90%;
                bottom: 25px;
            }

            .dock-container {
                padding: 12px 18px;
            }

            .dock-app-icon {
                width: var(--fixed-dock-app-icon-size) !important;
                height: var(--fixed-dock-app-icon-size) !important;
                border-radius: var(--fixed-dock-app-icon-radius) !important;
            }

            .dock-app-icon i {
                font-size: var(--fixed-dock-app-font-size) !important;
            }

            .dock-app {
                font-size: var(--fixed-dock-app-text-size) !important;
            }
        }

        /* 🔥【禁用响应式】中等屏幕适配 - 使用固定尺寸 */
        @media (max-width: 480px) and (min-width: 401px) {
            #home-grid {
                width: var(--fixed-home-grid-width) !important;
                height: var(--fixed-home-grid-width) !important;
                gap: var(--fixed-home-grid-gap) !important;
            }

            .mini-app-icon {
                width: var(--fixed-mini-app-icon-size) !important;
                height: var(--fixed-mini-app-icon-size) !important;
                border-radius: var(--fixed-mini-app-icon-radius) !important;
            }

            .mini-app-icon i {
                font-size: var(--fixed-mini-app-font-size) !important;
            }

            .large-app-icon {
                width: var(--fixed-large-app-icon-size) !important;
                height: var(--fixed-large-app-icon-size) !important;
                border-radius: var(--fixed-large-app-icon-radius) !important;
            }

            .large-app-icon i {
                font-size: var(--fixed-large-app-font-size) !important;
            }

            .dock-app-icon {
                width: var(--fixed-dock-app-icon-size) !important;
                height: var(--fixed-dock-app-icon-size) !important;
                border-radius: var(--fixed-dock-app-icon-radius) !important;
            }

            .dock-app-icon i {
                font-size: var(--fixed-dock-app-font-size) !important;
            }

            .dock-app {
                font-size: var(--fixed-dock-app-text-size) !important;
            }
        }

        /* 🔥【禁用响应式】小屏幕适配 - 使用固定尺寸 */
        @media (max-width: 400px) {
            #home-grid {
                width: var(--fixed-home-grid-width) !important;
                height: var(--fixed-home-grid-width) !important;
                gap: var(--fixed-home-grid-gap) !important;
            }

            .mini-app-icon {
                width: var(--fixed-mini-app-icon-size) !important;
                height: var(--fixed-mini-app-icon-size) !important;
                border-radius: var(--fixed-mini-app-icon-radius) !important;
            }

            .mini-app-icon i {
                font-size: var(--fixed-mini-app-font-size) !important;
            }

            .mini-app {
                font-size: var(--fixed-mini-app-text-size) !important;
            }

            .large-app-icon {
                width: var(--fixed-large-app-icon-size) !important;
                height: var(--fixed-large-app-icon-size) !important;
                border-radius: var(--fixed-large-app-icon-radius) !important;
            }

            .large-app-icon i {
                font-size: var(--fixed-large-app-font-size) !important;
            }

            .large-app {
                font-size: var(--fixed-large-app-text-size) !important;
            }

            .anniversary-name {
                font-size: var(--fixed-anniversary-name-size) !important;
            }

            .anniversary-countdown {
                font-size: var(--fixed-anniversary-countdown-size) !important;
            }

            .photo-placeholder i {
                font-size: 24px;
            }

            .photo-placeholder {
                font-size: 12px;
            }

            #dock-bar {
                width: 95%;
                bottom: 20px;
            }

            .dock-container {
                padding: 10px 15px;
            }

            .dock-app-icon {
                width: var(--fixed-dock-app-icon-size) !important;
                height: var(--fixed-dock-app-icon-size) !important;
                border-radius: var(--fixed-dock-app-icon-radius) !important;
            }

            .dock-app-icon i {
                font-size: var(--fixed-dock-app-font-size) !important;
            }

            .dock-app {
                font-size: var(--fixed-dock-app-text-size) !important;
            }
        }

        /* 🔥【禁用响应式】超小屏幕适配 - 使用固定尺寸 */
        @media (max-width: 360px) {
            #home-grid {
                width: var(--fixed-home-grid-width) !important;
                height: var(--fixed-home-grid-width) !important;
                gap: var(--fixed-home-grid-gap) !important;
            }

            .mini-app-icon {
                width: var(--fixed-mini-app-icon-size) !important;
                height: var(--fixed-mini-app-icon-size) !important;
                border-radius: var(--fixed-mini-app-icon-radius) !important;
            }

            .mini-app-icon i {
                font-size: var(--fixed-mini-app-font-size) !important;
            }

            .mini-app {
                font-size: var(--fixed-mini-app-text-size) !important;
            }

            .large-app-icon {
                width: var(--fixed-large-app-icon-size) !important;
                height: var(--fixed-large-app-icon-size) !important;
                border-radius: var(--fixed-large-app-icon-radius) !important;
            }

            .large-app-icon i {
                font-size: var(--fixed-large-app-font-size) !important;
            }

            .anniversary-name {
                font-size: var(--fixed-anniversary-name-size) !important;
            }

            .anniversary-countdown {
                font-size: var(--fixed-anniversary-countdown-size) !important;
            }

            .dock-container {
                padding: 8px 12px;
            }

            .dock-app-icon {
                width: var(--fixed-dock-app-icon-size) !important;
                height: var(--fixed-dock-app-icon-size) !important;
                border-radius: var(--fixed-dock-app-icon-radius) !important;
            }

            .dock-app-icon i {
                font-size: var(--fixed-dock-app-font-size) !important;
            }

            .dock-app {
                font-size: var(--fixed-dock-app-text-size) !important;
            }
        }

        .diary-entry.expanded .diary-entry-full {
            display: block;
        }

        .no-diaries {
            text-align: center;
            padding: 40px 20px;
            color: #999;
            font-style: italic;
        }

        .no-diaries i {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        /* 🔥【新增】群聊中隐藏日记工具 */
        .group-chat .tool-item.diary-tool {
            display: none !important;
        }

        /* 角色手机界面样式 */
        .character-phone-content {
            display: flex;
            flex-direction: column;
            height: 100%;
            padding: 0;
        }

        .phone-content-area {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
        }

        .phone-tabs {
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            border-top: 1px solid var(--color-border-light);
            background-color: var(--color-gray-bg-light);
            flex-shrink: 0;
        }

        .phone-tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--color-text-light);
            font-size: 12px;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .phone-tab.active {
            color: #6B9BD1;
        }

        .phone-tab i {
            font-size: 24px;
            margin-bottom: 3px;
        }

        .phone-tab-content {
            width: 100%;
        }

        /* 消息列表样式 */
        .phone-messages-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .phone-message-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: var(--bg-white-95);
            border-radius: 12px;
            border: 1px solid var(--border-light);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .phone-message-item:hover {
            background: var(--bg-white-90);
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .phone-message-avatar {
            width: 50px;
            height: 50px;
            border-radius: 25px;
            background: var(--theme-button-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .phone-message-info {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
        }

        .phone-message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .phone-message-name {
            font-weight: 600;
            font-size: 16px;
            color: var(--theme-text-primary);
        }

        .phone-message-time {
            font-size: 12px;
            color: var(--color-text-lighter);
            flex-shrink: 0;
            margin-left: 8px;
        }

        .phone-message-preview {
            font-size: 14px;
            color: var(--color-text-light);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* 备忘录列表样式 */
        .phone-notes-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .phone-note-item {
            padding: 15px;
            background: var(--bg-white-95);
            border-radius: 12px;
            border: 1px solid var(--border-light);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .phone-note-item:hover {
            background: var(--bg-white-90);
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .phone-note-title {
            font-weight: 600;
            font-size: 16px;
            color: var(--theme-text-primary);
            margin-bottom: 6px;
        }

        .phone-note-preview {
            font-size: 14px;
            color: var(--color-text-light);
            line-height: 1.4;
            margin-bottom: 8px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .phone-note-time {
            font-size: 12px;
            color: var(--color-text-lighter);
        }

        /* 相册网格样式 */
        .phone-photos-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .phone-photo-item {
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            background: var(--bg-white-95);
            border: 1px solid var(--border-light);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .phone-photo-item:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-hover);
        }

        .phone-photo-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--color-text-lighter);
            font-size: 24px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        /* 响应式设计 */
        @media (max-width: 480px) {
            .phone-content-area {
                padding: 10px;
            }

            .phone-message-item,
            .phone-note-item {
                padding: 10px;
            }

            .phone-message-avatar {
                width: 40px;
                height: 40px;
                font-size: 16px;
                margin-right: 10px;
            }

            .phone-message-name,
            .phone-note-title {
                font-size: 15px;
            }

            .phone-message-preview,
            .phone-note-preview {
                font-size: 13px;
            }

            .phone-photos-grid {
                gap: 6px;
            }

            .phone-photo-placeholder {
                font-size: 20px;
            }
        }

        /* 可爱主题适配 */
        body[data-theme="cute"] .phone-tabs {
            background-color: rgba(255, 182, 193, 0.1);
            border-top: 1px solid rgba(255, 182, 193, 0.3);
        }

        body[data-theme="cute"] .phone-tab.active {
            color: #ff69b4;
        }

        body[data-theme="cute"] .phone-message-avatar {
            background: var(--theme-button-bg-rgba, rgba(255, 182, 193, 0.9));
        }

        body[data-theme="cute"] .phone-message-item:hover,
        body[data-theme="cute"] .phone-note-item:hover {
            background: rgba(255, 182, 193, 0.1);
        }

        /* 手机对话详情界面样式 */
        .phone-chat-content {
            display: flex;
            flex-direction: column;
            height: 100%;
            padding: 0;
        }

        .phone-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            background: #f5f7fa;
        }

        .phone-chat-input-area {
            padding: 10px 15px;
            background: white;
            border-top: 1px solid var(--border-light);
        }

        .phone-chat-input-container {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--bg-white-95);
            border: 1px solid var(--border-light);
            border-radius: 20px;
            padding: 8px 15px;
        }

        .phone-chat-input {
            flex: 1;
            border: none;
            outline: none;
            background: transparent;
            font-size: 16px;
            color: var(--theme-text-primary);
        }

        .phone-chat-input::placeholder {
            color: var(--color-text-lighter);
        }

        .phone-chat-send-btn {
            background: var(--theme-button-bg);
            color: white;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .phone-chat-send-btn:disabled {
            background: var(--color-text-lighter);
            cursor: not-allowed;
        }

        .phone-chat-send-btn:not(:disabled):hover {
            background: var(--theme-button-bg-hover, #0056b3);
            transform: scale(1.1);
        }

        /* 消息气泡样式 */
        .phone-message-bubble {
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .phone-message-bubble.sent {
            align-items: flex-end;
        }

        .phone-message-row {
            display: flex;
            align-items: flex-end;
            gap: 8px;
            margin-bottom: 4px;
        }

        .phone-message-bubble.sent .phone-message-row {
            flex-direction: row-reverse;
        }

        .phone-message-avatar-small {
            width: 32px;
            height: 32px;
            border-radius: 16px;
            background: var(--theme-button-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            flex-shrink: 0;
        }

        .phone-message-bubble.sent .phone-message-avatar-small {
            background: var(--color-text-lighter);
        }

        .phone-message-content {
            max-width: 80%;
            position: relative;
            min-width: 0;
        }

        .phone-message-text {
            background: white;
            padding: 10px 15px;
            border-radius: 18px;
            font-size: 16px;
            line-height: 1.4;
            color: var(--theme-text-primary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            word-wrap: break-word;
            overflow-wrap: break-word;
            min-width: 0;
        }

        .phone-message-bubble.sent .phone-message-text {
            background: var(--theme-button-bg);
            color: white;
        }

        .phone-message-time {
            font-size: 12px;
            color: var(--color-text-lighter);
            margin-left: 40px;
        }

        .phone-message-bubble.sent .phone-message-time {
            margin-left: 0;
            margin-right: 40px;
            text-align: right;
        }

        /* 备忘录详情样式 */
        .phone-note-detail-content {
            padding: 20px;
        }

        .phone-note-detail {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .phone-note-detail-header {
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }

        .phone-note-detail-header h2 {
            margin: 0 0 8px 0;
            font-size: 20px;
            font-weight: 600;
            color: var(--theme-text-primary);
        }

        .phone-note-detail-time {
            font-size: 14px;
            color: var(--color-text-lighter);
        }

        .phone-note-detail-body {
            font-size: 16px;
            line-height: 1.6;
            color: var(--theme-text-primary);
            white-space: pre-wrap;
        }

        /* 照片详情样式 */
        .phone-photo-detail-content {
            padding: 20px;
        }

        .phone-photo-detail {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .phone-photo-detail-image {
            width: 100%;
            height: 300px;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .phone-photo-detail-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .phone-photo-placeholder-large {
            text-align: center;
            color: var(--color-text-lighter);
        }

        .phone-photo-placeholder-large i {
            font-size: 48px;
            margin-bottom: 10px;
            display: block;
        }

        .phone-photo-placeholder-large p {
            margin: 0;
            font-size: 16px;
        }

        /* 🔥【新增】视频预览样式 */
        .phone-video-placeholder-large {
            text-align: center;
            color: var(--color-text-lighter);
            position: relative;
        }

        .phone-video-placeholder-large i {
            font-size: 48px;
            margin-bottom: 10px;
            display: block;
        }

        .phone-video-placeholder-large p {
            margin: 0;
            font-size: 16px;
        }

        .video-duration {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .phone-photo-detail-info {
            padding: 20px;
        }

        .phone-photo-detail-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--theme-text-primary);
            margin-bottom: 8px;
        }

        .phone-photo-detail-time {
            font-size: 14px;
            color: var(--color-text-lighter);
            margin-bottom: 12px;
        }

        .phone-photo-detail-description {
            font-size: 16px;
            line-height: 1.5;
            color: var(--theme-text-primary);
        }

        /* 日期分隔符 */
        .phone-date-separator {
            text-align: center;
            margin: 20px 0;
        }

        .phone-date-separator span {
            background: rgba(0, 0, 0, 0.1);
            color: var(--color-text-light);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
        }



        /* 日记纸张背景样式 - 占满整个屏幕 */
        .diary-paper-background {
            flex: 1;
            padding: 10px 40px 60px 40px; /* 进一步减少顶部内边距到10px */
            margin: 0;
            min-height: 100%;
            max-height: calc(100vh - 140px); /* 限制最大高度，为头部和底部留空间 */
            line-height: 1.8;
            font-size: 16px;
            color: #333;
            white-space: pre-wrap;
            position: relative;
            overflow-y: auto;
            box-sizing: border-box;
        }

        /* 默认白纸 */
        .diary-paper-background {
            background: white;
        }

        /* 白纸 */
        .diary-paper-background.plain-paper {
            background: white;
        }

        /* 复古纸 */
        .diary-paper-background.vintage-paper {
            background: #e8dcc6;
            color: #4a3c28;
        }

        /* 自定义背景 */
        .diary-paper-background.custom-paper {
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* 日记设置模态框样式 */
        .paper-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .paper-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .paper-option:hover {
            border-color: #007bff;
            background-color: #f8f9fa;
        }

        .paper-option.active {
            border-color: #007bff;
            background-color: #e3f2fd;
        }

        .paper-preview {
            width: 60px;
            height: 80px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 8px;
            position: relative;
        }

        .paper-preview.plain-paper {
            background: white;
        }

        .paper-preview.vintage-paper {
            background: #e8dcc6;
        }

        .custom-preview {
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            color: #666;
            font-size: 20px;
        }

        .edit-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .edit-actions .btn {
            flex: 1;
        }

        .paper-option span {
            font-size: 12px;
            font-weight: 500;
            color: #374151;
            text-align: center;
        }

        /* 日记设置全屏界面样式 */
        .diary-settings-overlay {
            position: absolute;
            top: 40px; /* 为状态栏留出空间 */
            left: 0;
            right: 0;
            bottom: 0;
            background: #f8f9fa;
            display: flex;
            flex-direction: column;
            z-index: 100;
        }

        .diary-settings-header {
            position: relative;
            z-index: 15;
            flex-shrink: 0;
            padding: 8px 20px;
            height: 40px;
            box-sizing: border-box;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 18px;
            font-weight: 600;
            transition: var(--transition-normal);
            overflow: hidden;
        }

        .diary-settings-header .back-btn {
            background: transparent;
            border: none;
            font-size: 24px;
            color: var(--theme-button-bg, #4a84c1);
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.3s ease;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }



        .diary-settings-header .header-title {
            text-align: center;
            flex: 1;
            color: #000000;
            font-size: 18px;
            font-weight: 600;
        }

        .diary-settings-header .header-actions {
            display: flex;
            gap: 10px;
        }

        .diary-settings-header .action-btn {
            background: transparent;
            border: none;
            font-size: 20px;
            color: var(--theme-button-bg, #4a84c1);
            cursor: pointer;
            padding: 0;
            border-radius: 50%;
            transition: all 0.3s ease;
            width: 26px;
            height: 26px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }



        .diary-settings-content {
            flex: 1;
            overflow-y: auto;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        /* 预览区域样式 */
        .settings-preview-section {
            background: white;
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
        }

        .settings-preview-section h3 {
            margin: 0 0 15px 0;
            font-size: 17px;
            font-weight: 600;
            color: #1d1d1f;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .diary-preview-container {
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            overflow: hidden;
            height: 200px;
        }

        .diary-preview-paper {
            height: 100%;
            padding: 20px;
            overflow-y: auto;
            position: relative;
            background: white;
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            font-size: 16px;
            line-height: 1.6;
            color: #333;
        }

        /* 移除预览界面的头部样式 */

        .diary-preview-paper .preview-text {
            margin-top: 10px; /* 减少顶部边距，因为不再有头部 */
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* 预览纸张背景样式 */
        .diary-preview-paper.plain-paper {
            background: white;
        }

        .diary-preview-paper.vintage-paper {
            background: #e8dcc6;
            color: #4a3c28;
        }

        .diary-preview-paper.custom-paper {
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* 设置选项区域样式 */
        .settings-options-section {
            display: flex;
            flex-direction: column;
            gap: 0;
            background: white;
        }

        .setting-group {
            background: white;
            padding: 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .setting-group:last-child {
            border-bottom: none;
        }

        .setting-group h4 {
            margin: 0;
            padding: 20px 20px 0 20px;
            font-size: 13px;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .setting-group h4 i {
            color: var(--theme-button-bg, #4a84c1);
        }

        .setting-item {
            padding: 15px 20px;
            border-bottom: 1px solid #f3f4f6;
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-height: 44px;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-item label {
            display: block;
            margin: 0;
            font-size: 17px;
            font-weight: 400;
            color: #1d1d1f;
            flex: 1;
        }

        .setting-item select {
            min-width: 120px;
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            font-size: 17px;
            background: #f2f2f7;
            color: #1d1d1f;
            transition: all 0.2s ease;
            -webkit-appearance: none;
            appearance: none;
        }

        .setting-item select:focus {
            outline: none;
            background: #e5e5ea;
        }

        /* 滑块样式 */
        .slider-container {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
            max-width: 200px;
        }

        .slider-container input[type="range"] {
            flex: 1;
            height: 4px;
            border-radius: 2px;
            background: #e5e7eb;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: white;
            border: 2px solid var(--theme-button-bg, #4a84c1);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            transition: all 0.2s ease;
        }

        .slider-container input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .slider-container input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: white;
            border: 2px solid var(--theme-button-bg, #4a84c1);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .slider-container span {
            min-width: 50px;
            font-size: 17px;
            font-weight: 400;
            color: #6b7280;
            text-align: right;
        }

        /* 🔥【新增】字体颜色选择器样式 */
        .custom-color-input {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
            max-width: 200px;
        }

        .custom-color-input input[type="color"] {
            width: 40px;
            height: 32px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: none;
            padding: 0;
        }

        .custom-color-input input[type="color"]::-webkit-color-swatch-wrapper {
            padding: 0;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
        }

        .custom-color-input input[type="color"]::-webkit-color-swatch {
            border: none;
            border-radius: 6px;
        }

        .custom-color-input label {
            font-size: 17px;
            color: #6b7280;
            cursor: pointer;
        }

        /* 文本装饰样式 */
        .diary-paper-background.decoration-underline {
            text-decoration: underline;
            text-decoration-color: currentColor;
            text-decoration-thickness: 1px;
            text-underline-offset: 3px;
        }

        .diary-paper-background.decoration-none {
            text-decoration: none;
        }

        /* 预览区域的文本装饰 */
        .diary-preview-paper.decoration-underline {
            text-decoration: underline;
            text-decoration-color: currentColor;
            text-decoration-thickness: 1px;
            text-underline-offset: 3px;
        }

        .diary-preview-paper.decoration-none {
            text-decoration: none;
        }



        /* 设置界面的纸张选项样式 */
        .setting-group .paper-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            padding: 20px;
        }

        .setting-group .paper-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 12px 8px;
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #f2f2f7;
        }

        .setting-group .paper-option:hover {
            background: #e5e5ea;
        }

        .setting-group .paper-option.active {
            border-color: var(--theme-button-bg, #4a84c1);
            background: rgba(74, 132, 193, 0.1);
        }

        .setting-group .paper-preview {
            width: 50px;
            height: 65px;
            border-radius: 6px;
            border: 1px solid #d1d5db;
            position: relative;
            overflow: hidden;
        }

        .setting-group .paper-preview.plain-paper {
            background: white;
        }

        .setting-group .paper-preview.vintage-paper {
            background: #e8dcc6;
        }

        .setting-group .custom-preview {
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            color: #6c757d;
            font-size: 20px;
        }

        .setting-group .paper-option span {
            font-size: 12px;
            font-weight: 400;
            color: #1d1d1f;
            text-align: center;
        }

        /* 编辑功能样式 */
        .setting-group .edit-actions {
            display: flex;
            gap: 8px;
            padding: 20px;
        }

        .setting-group .edit-actions .btn {
            flex: 1;
            padding: 12px 16px;
            border-radius: 10px;
            font-size: 17px;
            font-weight: 400;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s ease;
            border: none;
        }

        .setting-group .edit-actions .btn.btn-primary {
            background: var(--theme-button-bg, #4a84c1);
            color: white;
        }

        .setting-group .edit-actions .btn.btn-secondary {
            background: #f2f2f7;
            color: #1d1d1f;
        }

        .setting-group .edit-actions .btn:hover {
            opacity: 0.8;
        }

        /* 设置界面响应式样式 */
        @media (max-width: 768px) {
            .settings-preview-section {
                padding: 15px;
            }

            .setting-group h4 {
                padding: 15px 15px 0 15px;
            }

            .setting-item {
                padding: 12px 15px;
            }

            .setting-group .paper-options {
                grid-template-columns: repeat(3, 1fr);
                gap: 6px;
                padding: 15px;
            }



            .setting-group .edit-actions {
                padding: 15px;
            }
        }

        /* 日记界面响应式样式 */
        @media (max-width: 480px) {
            .diary-tabs {
                margin: 10px;
                padding: 3px;
            }

            .diary-tab {
                padding: 10px 12px;
                font-size: 13px;
            }

            .diary-tab span {
                display: none; /* 在小屏幕上只显示图标 */
            }

            .diary-view {
                padding: 0 10px 10px 10px;
                height: calc(100vh - 260px);
            }

            .diary-paper-container {
                height: calc(100vh - 300px);
            }

            #past-diaries-list {
                height: calc(100vh - 300px);
                padding: 0 2px;
            }

            #past-diaries-view .diary-entry .diary-paper-container {
                height: 200px;
            }

            #past-diaries-view .diary-entry-full.diary-paper {
                min-height: 200px;
                max-height: 200px;
                padding: 40px 20px 25px 30px;
            }
        }

        /* 聊天标题区域的状态显示样式 */
        .app-header .character-status {
            margin-top: 2px;
            justify-content: center;
        }

        /* 确保状态显示在聊天头部正确定位 - 针对.app-header */
        .app-header .app-title {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* 🔥【新增】聊天界面.header容器的状态显示样式 */
        #api-chat-screen .header {
            overflow: visible; /* 允许内容溢出 */
        }

        /* 🔥【新增】线下剧情模式样式 */
        .offline-mode-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-header-default);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 999; /* 降低z-index，确保模态框能在其上方显示 */
            display: flex;
            flex-direction: column;
        }

        /* 线下模式状态栏 */
        .offline-status-bar {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            padding: 12px 24px 6px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: black;
            z-index: 1000;
            font-size: 14px;
            box-sizing: border-box;
            pointer-events: none;
            background: transparent;
            border-bottom: none;
        }

        /* --- 论坛悬浮按钮组 --- */
        .floating-action-buttons {
            position: absolute;
            bottom: 30px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 15px; /* 按钮之间的间距 */
        }

        /* 🔥【精准修复】只针对论坛页面的悬浮按钮，不影响其他按钮 - 调淡颜色 */
        #forum-view-screen .floating-action-buttons .floating-btn {
            opacity: 0.95 !important;
            background: rgba(74, 132, 193, 0.75) !important;
        }

        #forum-view-screen .floating-action-buttons .floating-btn:not(.hidden) {
            opacity: 0.95 !important;
        }

        body[data-theme="cute"] #forum-view-screen .floating-action-buttons .floating-btn {
            background: rgba(255, 182, 193, 0.75) !important;
        }

        .floating-btn {
            width: 46px;
            height: 46px;
            border-radius: 50%;
            background: rgba(74, 132, 193, 0.7); /* 主题蓝色 - 调淡 */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
        }

        /* 刷新按钮使用稍微不同的颜色以作区分 - 调淡 */
        .floating-btn.refresh-btn {
            background: rgba(108, 117, 125, 0.65); /* 中性灰色 - 调淡 */
        }
        .floating-btn.refresh-btn:hover {
            background: rgba(108, 117, 125, 0.85);
        }

        /* 可爱主题下的按钮颜色适配 - 调淡 */
        body[data-theme="cute"] .floating-btn.post-btn {
            background: rgba(255, 182, 193, 0.7); /* 可爱主题粉色 - 调淡 */
        }

        body[data-theme="cute"] .floating-btn.post-btn:hover {
            background: rgba(255, 182, 193, 0.85);
        }

        /* --- 论坛评论区美化 --- */

        /* 论坛回复元信息 (楼层和时间) */
        .reply-meta {
            font-size: 12px;
            color: #888;
            margin-top: 4px;
            margin-bottom: 6px;
            display: flex;
            gap: 12px;
            align-items: center;
        }

        /* --- 帖子列表分区样式 --- */
        .forum-section-header {
            padding: 10px 15px;
            font-size: 14px;
            font-weight: 600;
            color: #888;
            background-color: #f8f9fa;
            border-bottom: 1px solid #eee;
            margin-top: 10px;
        }

        .forum-section-header:first-child {
            margin-top: 0;
        }

        /* --- 热帖标题样式 --- */
        .post-item.hot .post-title::before {
            content: '🔥HOT';
            background-color: #ff6b6b;
            color: white;
            font-size: 10px;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 4px;
            margin-right: 8px;
            vertical-align: middle;
        }

        /* --- 用户帖子和图片帖子标记样式 --- */
        .post-title-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 8px;
        }

        .post-full-title-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 10px;
        }

        .user-post-badge {
            background-color: #8E8E93;
            color: white;
            font-size: 10px;
            font-weight: 500;
            padding: 2px 6px;
            border-radius: 4px;
            flex-shrink: 0;
            align-self: flex-start;
        }

        .image-post-badge {
            width: 14px;
            height: 14px;
            margin-left: 6px;
            vertical-align: middle;
            opacity: 0.6;
            fill: #666;
        }

        /* 可爱主题下的用户帖子标记颜色 */
        body[data-theme="cute"] .user-post-badge {
            background-color: #C7C7CC;
            color: #666;
        }

        /* 可爱主题下的论坛社区卡片样式 */
        body[data-theme="cute"] .forum-archive-item {
            background: linear-gradient(135deg, rgba(255, 248, 252, 0.95), rgba(255, 240, 245, 0.95));
            border-color: rgba(255, 182, 193, 0.15);
        }

        body[data-theme="cute"] .forum-archive-item::before {
            background: linear-gradient(135deg, rgba(255, 182, 193, 0.04), rgba(255, 182, 193, 0.02));
        }

        body[data-theme="cute"] .forum-archive-item:hover {
            border-color: rgba(255, 182, 193, 0.3);
        }

        /* --- 论坛评论区美化 --- */

        /* 1. 让每条评论的容器可以作为按钮定位的基准 */
        .reply-item {
            position: relative;
            padding-bottom: 30px; /* 为按钮留出空间 */
        }

        /* 2. 移除旧的操作区边距 */
        .reply-body .reply-actions {
            margin-top: 0;
        }

        /* 3. 全新设计的操作按钮容器，定位到右下角 */
        .reply-actions {
            position: absolute;
            bottom: 10px;
            right: 15px;
            display: flex;
            align-items: center;
            gap: 12px; /* 🔥【修改】减小按钮间距，让按钮更紧凑 */
        }

        /* 4. 全新设计的操作按钮样式（无边框，纯图标） */
        .reply-action-btn {
            background: none;
            border: none;
            padding: 0;
            color: #888; /* 图标和文字的默认颜色 */
            font-size: 13px; /* 点赞数文字大小 */
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px; /* 图标和点赞数的间距 */
            transition: color 0.2s ease;
        }

        /* 5. 鼠标悬停时图标和文字变色 */
        .reply-action-btn:hover {
            color: #333;
        }

        /* 6. SVG图标的通用样式 */
        .reply-action-btn svg {
            width: 20px;
            height: 20px;
            fill: currentColor; /* 让SVG图标颜色继承按钮的color属性 */
            transition: transform 0.2s ease;
        }

        .reply-action-btn:hover svg {
            transform: scale(1.1);
        }

        /* 7. 用户点赞后的高亮样式 */
        .reply-action-btn.liked {
            color: #007AFF; /* 点赞后变为蓝色 */
        }

        /* 8. 🔥【新增】删除按钮样式 - 保持与其他按钮风格一致 */
        .reply-action-btn.delete-btn {
            color: #888; /* 🔥【修改】删除按钮也使用灰色，保持风格一致 */
        }

        .reply-action-btn.delete-btn:hover {
            color: #333; /* 🔥【修改】悬停时与其他按钮一样变为深灰色 */
        }

        /* --- 论坛投票组件样式 --- */
        .forum-poll {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 12px;
            border: 1px solid #e9ecef;
        }

        .forum-poll h4 {
            margin-bottom: 15px;
            font-size: 16px;
            color: #333;
            font-weight: 600;
        }

        .poll-option {
            background-color: #fff;
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid #dee2e6;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .poll-option:hover {
            border-color: #007AFF;
            box-shadow: 0 2px 8px rgba(0,123,255,0.1);
            transform: translateY(-1px);
        }

        .poll-option .option-text {
            font-weight: 500;
            color: #495057;
            position: relative;
            z-index: 2;
        }

        .poll-option .vote-count {
            float: right;
            font-size: 13px;
            color: #6c757d;
            position: relative;
            z-index: 2;
        }

        /* 投票结果条 */
        .result-bar-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #e9ecef;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1;
        }

        .result-bar {
            height: 100%;
            width: 0%; /* 默认宽度为0 */
            background-color: #cfe2ff;
            border-radius: 8px;
            transition: width 0.5s ease;
        }

        /* 用户投票后的样式 */
        .forum-poll.voted .poll-option {
            cursor: default;
            pointer-events: none; /* 禁止再次点击 */
        }

        .forum-poll.voted .result-bar-bg {
            opacity: 1; /* 显示结果条背景 */
        }

        .forum-poll.voted .option-text,
        .forum-poll.voted .vote-count {
            color: #000;
        }

        /* 用户投票的选项高亮样式 */
        .poll-option.user-voted {
            border-color: #007AFF !important;
            background-color: #f0f8ff !important;
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.2) !important;
        }

        .poll-option.user-voted .option-text {
            color: #007AFF !important;
            font-weight: 600 !important;
        }

        .poll-option.user-voted .vote-count {
            color: #007AFF !important;
            font-weight: 600 !important;
        }

        .poll-option.user-voted .result-bar {
            background-color: #007AFF !important;
        }

        /* --- 多选投票增强样式 --- */

        /* 多选投票选项的选中状态 */
        .poll-option[data-selected="true"] {
            border-color: #007AFF !important;
            background-color: #f0f8ff !important;
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.2) !important;
        }

        .poll-option[data-selected="true"] .option-text {
            color: #007AFF !important;
            font-weight: 600 !important;
        }

        .poll-option[data-selected="true"] .vote-count {
            color: #007AFF !important;
            font-weight: 600 !important;
        }

        /* 多选投票的提交按钮 */
        .vote-submit-btn {
            display: block;
            width: 100%;
            padding: 12px;
            margin-top: 15px;
            border: none;
            border-radius: 8px;
            background: rgba(74, 132, 193, 0.9);
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .vote-submit-btn:hover {
            background: rgba(74, 132, 193, 1);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(74, 132, 193, 0.3);
        }

        .vote-submit-btn:disabled {
            background: rgba(128, 128, 128, 0.6);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* 可爱主题下的投票按钮 */
        body[data-theme="cute"] .vote-submit-btn {
            background: rgba(255, 182, 193, 0.9);
        }

        body[data-theme="cute"] .vote-submit-btn:hover {
            background: rgba(255, 182, 193, 1);
            box-shadow: 0 4px 12px rgba(255, 182, 193, 0.3);
        }

        /* 投票后隐藏提交按钮 */
        .forum-poll.voted .vote-submit-btn {
            display: none;
        }

        /* 多选投票标题样式 */
        .forum-poll[data-poll-type="multiple"] h4::after {
            content: " [多选]";
            color: #007AFF;
            font-size: 14px;
            font-weight: normal;
        }

        body[data-theme="cute"] .forum-poll[data-poll-type="multiple"] h4::after {
            color: #ff6b9d;
        }

        /* --- 投票结果进度条样式 --- */

        /* 进度条背景容器 */
        .poll-option .result-bar-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #f8f9fa;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1;
            border-radius: 8px;
            overflow: hidden;
        }

        /* 进度条本体 */
        .poll-option .result-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, rgba(74, 132, 193, 0.3) 0%, rgba(74, 132, 193, 0.6) 100%);
            border-radius: 8px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 1;
        }

        /* 可爱主题的进度条颜色 */
        body[data-theme="cute"] .poll-option .result-bar {
            background: linear-gradient(90deg, rgba(255, 182, 193, 0.3) 0%, rgba(255, 182, 193, 0.6) 100%);
        }

        /* 用户投票选项的进度条高亮 */
        .poll-option.user-voted .result-bar {
            background: linear-gradient(90deg, rgba(0, 122, 255, 0.6) 0%, rgba(0, 122, 255, 0.8) 100%) !important;
            box-shadow: 0 0 10px rgba(0, 122, 255, 0.3);
        }

        body[data-theme="cute"] .poll-option.user-voted .result-bar {
            background: linear-gradient(90deg, rgba(255, 107, 157, 0.6) 0%, rgba(255, 107, 157, 0.8) 100%) !important;
            box-shadow: 0 0 10px rgba(255, 107, 157, 0.3);
        }

        /* 投票后显示进度条 */
        .forum-poll.voted .result-bar-bg {
            opacity: 1;
        }

        /* 确保文字显示在进度条上方 */
        .forum-poll.voted .option-text,
        .forum-poll.voted .vote-count {
            position: relative;
            z-index: 2;
            color: #333;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
        }

        /* 用户投票选项的文字高亮 */
        .poll-option.user-voted .option-text {
            color: #007AFF !important;
            font-weight: 600 !important;
        }

        .poll-option.user-voted .vote-count {
            color: #007AFF !important;
            font-weight: 600 !important;
        }

        body[data-theme="cute"] .poll-option.user-voted .option-text,
        body[data-theme="cute"] .poll-option.user-voted .vote-count {
            color: #ff6b9d !important;
        }

        /* --- 投票历史样式 --- */
        .vote-history-modal {
            max-width: 500px;
            max-height: 70vh;
        }

        .vote-history-list {
            max-height: 400px;
            overflow-y: auto;
            padding: 10px 0;
        }

        .vote-history-item {
            padding: 15px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #007AFF;
        }

        .vote-post-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .vote-choice {
            color: #007AFF;
            font-size: 13px;
            margin-bottom: 5px;
        }

        .vote-date {
            color: #666;
            font-size: 12px;
        }



        .offline-mode-header {
            position: relative;
            z-index: 15;
            flex-shrink: 0;
            padding: 12px 32px;
            padding-top: 45px;
            height: 80px;
            box-sizing: border-box;
            background-color: var(--theme-header-bg);
            backdrop-filter: var(--theme-header-backdrop);
            -webkit-backdrop-filter: var(--theme-header-backdrop);
            border-bottom: 1px solid var(--color-border);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            font-weight: 600;
            transition: var(--transition-normal);
            overflow: hidden;
        }

        .offline-mode-header .back-btn {
            position: absolute;
            left: 20px;
            top: 43px; /* 调高2px */
            background: none;
            border: none;
            font-size: 24px;
            color: var(--color-gray-dark);
            cursor: pointer;
            padding: 0;
            width: 30px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            /* 移除悬停效果和过渡动画 */
        }

        .offline-mode-header .header-actions {
            position: absolute !important;
            right: 15px !important; /* 🔥【调整】往右挪一点 */
            top: 38px !important; /* 🔥【调整】往上挪一点 */
            transform: none !important;
            display: flex;
            gap: 6px; /* 🔥【微调】稍微增加间距，避免按钮太挤 */
        }

        .offline-mode-header .action-btn {
            background: none;
            border: none;
            font-size: 18px;
            color: var(--color-gray-dark);
            cursor: pointer;
            padding: 3px; /* 🔥【微调】增加一点内边距，改善点击体验 */
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px; /* 🔥【微调】轻微圆角，视觉更友好 */
            transition: background-color 0.15s ease; /* 🔥【微调】轻微的背景色过渡 */
        }

        /* 🔥【微调】轻微的悬停效果，改善用户体验 */
        .offline-mode-header .action-btn:hover {
            background: rgba(0, 0, 0, 0.03);
        }

        .offline-mode-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            height: calc(100vh - 84px); /* 减去header高度 */
            overflow: hidden;
        }

        .offline-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            padding-bottom: 100px; /* 🔥【修复】增加底部padding，确保最新消息不被输入框遮盖 */
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
        }

        .offline-input-area {
            background-color: var(--bg-header-default);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-top: 1px solid var(--color-gray-border);
            flex-shrink: 0; /* 防止被压缩 */
            z-index: 100;
            box-sizing: border-box;
            padding: 6px; /* 🔥【进一步降低】从8px减少到6px，使输入栏更矮 */
        }

        .offline-input-container {
            display: flex;
            align-items: flex-end;
            gap: 8px;
            background: var(--bg-white-90);
            border-radius: 20px;
            padding: 8px 12px;
            border: 1px solid var(--color-gray-border);
        }

        #offline-input {
            flex: 1;
            border: none;
            outline: none;
            background: transparent;
            resize: none;
            font-size: 16px;
            line-height: 1.4;
            max-height: 120px;
            min-height: 20px;
            font-family: var(--theme-font-family);
        }

        .offline-button-group {
            display: flex;
            align-items: center;
            gap: 6px;
            flex-shrink: 0;
        }

        .offline-regenerate-btn {
            background: var(--bg-white-80);
            color: var(--color-gray-dark);
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 12px;
            border: 1px solid var(--color-gray-border);
        }

        .offline-regenerate-btn:hover {
            background: var(--bg-white-95);
            transform: scale(1.05);
        }

        .offline-regenerate-btn:active {
            transform: scale(0.95);
        }

        .offline-send-btn {
            background: var(--theme-button-bg);
            color: white;
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 12px;
            flex-shrink: 0;
        }

        .offline-send-btn:hover {
            background: var(--theme-button-bg-hover);
            transform: scale(1.05);
        }

        .offline-send-btn:active {
            transform: scale(0.95);
        }



        .offline-continue-btn {
            background: var(--theme-button-bg);
            color: white;
            border: none;
            border-radius: 12px; /* 圆角矩形，比其他按钮稍大一点以容纳文字 */
            padding: 6px 8px; /* 紧凑的内边距 */
            font-size: 12px; /* 与其他按钮一致的字体大小 */
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease; /* 与其他按钮一致的过渡时间 */
            display: flex;
            align-items: center;
            gap: 3px; /* 减小图标和文字间距 */
            height: 28px; /* 与其他按钮一致的高度 */
            flex-shrink: 0; /* 防止被压缩 */
            justify-content: center;
        }

        .offline-continue-btn:hover {
            background: var(--theme-button-bg-hover);
            transform: scale(1.05); /* 与其他按钮一致的悬停效果 */
        }

        .offline-continue-btn:active {
            transform: scale(0.95); /* 与其他按钮一致的点击效果 */
        }

        .offline-continue-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .offline-continue-btn:disabled:hover {
            transform: none;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .offline-continue-btn i {
            font-size: 11px; /* 与其他按钮图标大小一致 */
        }

        .offline-continue-btn span {
            font-size: 12px; /* 与按钮整体字体大小一致 */
        }



        .offline-message-content {
            display: inline-block; /* 🔥【修改】改回inline-block，支持自适应宽度 */
            max-width: 90%; /* 🔥【修改】最大宽度90%，内容自适应 */
            padding: 12px 16px;
            border-radius: 12px; /* 🔥【修改】更小的圆角，更对称 */
            font-size: 15px;
            line-height: 1.5;
            word-wrap: break-word;
            text-align: left; /* 🔥【新增】气泡内文字左对齐 */
            box-sizing: border-box; /* 🔥【新增】确保padding不影响总宽度 */
        }

        /* 🔥【新增】线下模式消息容器支持头像 */
        .offline-message {
            position: relative;
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 16px;
            animation: fadeInUp 0.3s ease;
        }

        /* 🔥【重新设计】默认消息布局 */
        .offline-message.user {
            flex-direction: row;
            justify-content: flex-end; /* 🔥【修改】用户消息默认靠右 */
            text-align: right;
        }

        .offline-message.ai {
            flex-direction: row;
            justify-content: center; /* AI消息默认居中 */
            text-align: center;
        }

        /* 线下模式实际头像样式 */
        .offline-message .offline-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--color-gray-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
            position: relative;
            background-size: cover;
            background-position: center;
        }

        .offline-message.user .offline-message-content {
            /* 背景色由JavaScript动态设置，支持透明度 */
            color: #000000; /* 🔥【修改】用户文字默认为黑色 */
            /* 🔥【移除】不对称的圆角设置，使用统一的圆角 */
        }

        .offline-message.ai .offline-message-content {
            /* 背景色由JavaScript动态设置，支持透明度 */
            color: var(--text-primary);
            border: 1px solid var(--color-gray-border);
            /* 🔥【修改】AI消息固定宽度90% */
            display: block !important;
            width: 90% !important;
            max-width: none !important;
        }

        /* 🔥【简化】折叠内容样式 - 完全透明无装饰 */
        .offline-message-content details {
            margin: 0;
            border: none;
            background: none;
        }

        .offline-message-content summary {
            padding: 0;
            background: none;
            border: none;
            cursor: pointer;
            user-select: none;
            list-style: none; /* 移除默认的三角形 */
            outline: none;
        }

        .offline-message-content summary::-webkit-details-marker {
            display: none; /* 移除WebKit浏览器的默认标记 */
        }

        .offline-message-content details > *:not(summary) {
            padding: 0;
            margin: 0;
        }

        /* 线下预设模态框样式 */
        #offline-preset-modal {
            z-index: 10001 !important; /* 确保在线下模式覆盖层之上 */
            position: fixed !important; /* 确保相对于视口定位 */
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
        }

        #offline-preset-modal .modal-content {
            z-index: 10002 !important; /* 确保模态框内容在最上层 */
            position: relative !important;
        }

        .preset-help-text {
            background: rgba(248, 249, 250, 0.8);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 16px;
            font-size: 13px;
            color: var(--color-gray-dark);
            line-height: 1.5;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        }

        .preset-help-text p {
            margin: 6px 0;
            display: flex;
            align-items: center;
        }

        .preset-help-text p:before {
            content: "•";
            color: var(--theme-button-bg);
            font-weight: bold;
            margin-right: 8px;
            font-size: 16px;
        }

        .preset-help-text p:first-child {
            margin-top: 0;
        }

        .preset-help-text p:last-child {
            margin-bottom: 0;
        }

        /* 可爱主题下的预设说明样式 */
        body[data-theme="cute"] .preset-help-text {
            background: rgba(255, 240, 245, 0.8);
        }

        body[data-theme="cute"] .preset-help-text p:before {
            color: var(--theme-button-bg);
        }

        /* 已保存预设列表样式 */
        .saved-presets-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid var(--color-gray-border);
            border-radius: 8px;
            background: var(--bg-white-95);
        }

        .saved-presets-list:empty::before {
            content: "暂无保存的预设";
            display: block;
            text-align: center;
            color: var(--color-gray);
            padding: 20px;
            font-size: 14px;
        }

        .preset-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid var(--color-gray-border);
            transition: background-color 0.2s ease;
        }

        .preset-item:last-child {
            border-bottom: none;
        }

        .preset-item:hover {
            background-color: var(--bg-white-80);
        }

        .preset-item.active {
            background-color: var(--theme-button-bg-light);
            border-left: 3px solid var(--theme-button-bg);
        }

        .preset-info {
            flex: 1;
            min-width: 0;
        }

        .preset-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
            font-size: 14px;
        }

        .preset-preview {
            color: var(--color-gray);
            font-size: 12px;
            line-height: 1.3;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .preset-actions {
            display: flex;
            gap: 8px;
            margin-left: 12px;
        }

        .preset-action-btn {
            background: none;
            border: none;
            color: var(--color-gray);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .preset-action-btn:hover {
            background-color: var(--bg-white-50);
            color: var(--text-primary);
        }

        .preset-action-btn.use-btn {
            color: var(--theme-button-bg);
        }

        .preset-action-btn.use-btn:hover {
            background-color: var(--theme-button-bg-light);
        }

        .preset-action-btn.delete-btn {
            color: #dc3545;
        }

        .preset-action-btn.delete-btn:hover {
            background-color: rgba(220, 53, 69, 0.1);
        }

        /* 🔥【新增】圆圈单选按钮样式 */
        .preset-radio-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            transition: all 0.2s ease;
        }

        .preset-radio-btn:hover {
            transform: scale(1.05);
        }

        .radio-circle {
            width: 20px;
            height: 20px;
            border: 2px solid var(--color-gray);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            background: var(--bg-white);
        }

        .radio-circle.checked {
            border-color: var(--theme-button-bg);
            background: var(--theme-button-bg);
            color: white;
        }

        .radio-circle.checked i {
            font-size: 10px;
            color: white;
        }

        .preset-radio-btn:hover .radio-circle {
            border-color: var(--theme-button-bg);
            box-shadow: 0 0 0 2px rgba(var(--theme-button-bg-rgb), 0.2);
        }

        /* 🔥【新增】预设复选框样式 */
        .preset-checkbox-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            margin: 0 8px 0 0;
            transition: all 0.2s ease;
        }

        .checkbox-circle {
            width: 20px;
            height: 20px;
            border: 2px solid var(--color-gray);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            background: var(--bg-white);
        }

        .checkbox-circle.checked {
            background: var(--theme-button-bg);
            border-color: var(--theme-button-bg);
            color: white;
        }

        .checkbox-circle i {
            font-size: 10px;
        }

        .preset-checkbox-btn:hover {
            transform: scale(1.05);
        }

        .preset-checkbox-btn:hover .checkbox-circle {
            border-color: var(--theme-button-bg);
            box-shadow: 0 0 0 2px rgba(var(--theme-button-bg-rgb), 0.2);
        }



        /* 🔥【新增】线下预设模态框美化样式 */
        #offline-preset-modal .form-group input,
        #offline-preset-modal .form-group textarea {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 14px;
            color: var(--text-primary);
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        #offline-preset-modal .form-group input:focus,
        #offline-preset-modal .form-group textarea:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.9);
            border-color: var(--theme-button-bg);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }

        #offline-preset-modal .form-group textarea {
            resize: vertical;
            min-height: 120px;
            line-height: 1.5;
        }

        #offline-preset-modal .form-group input::placeholder,
        #offline-preset-modal .form-group textarea::placeholder {
            color: rgba(108, 117, 125, 0.7);
        }

        /* 线下预设模态框按钮美化 */
        #offline-preset-modal .modal-footer .btn {
            background: rgba(108, 117, 125, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 500;
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            min-width: 60px;
        }

        #offline-preset-modal .modal-footer .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            background: rgba(108, 117, 125, 0.9);
        }

        #offline-preset-modal .modal-footer .btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
        }

        #offline-preset-modal .modal-footer .btn-primary {
            background: var(--theme-button-bg);
            border-color: rgba(255, 255, 255, 0.3);
        }

        #offline-preset-modal .modal-footer .btn-primary:hover {
            background: var(--theme-button-bg-hover);
        }

        /* 经典主题下的线下预设样式 */
        body[data-theme="classic"] #offline-preset-modal .modal-footer .btn-primary {
            background: rgba(102, 126, 234, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        body[data-theme="classic"] #offline-preset-modal .modal-footer .btn-primary:hover {
            background: rgba(102, 126, 234, 0.9);
        }

        body[data-theme="classic"] #offline-preset-modal .form-group input:focus,
        body[data-theme="classic"] #offline-preset-modal .form-group textarea:focus {
            border-color: rgba(102, 126, 234, 0.8);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        /* 可爱主题下的线下预设样式 */
        body[data-theme="cute"] #offline-preset-modal .modal-footer .btn-primary {
            background: rgba(255, 182, 193, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: #8B4B8C;
        }

        body[data-theme="cute"] #offline-preset-modal .modal-footer .btn-primary:hover {
            background: rgba(255, 182, 193, 0.9);
        }

        body[data-theme="cute"] #offline-preset-modal .form-group input:focus,
        body[data-theme="cute"] #offline-preset-modal .form-group textarea:focus {
            border-color: rgba(255, 182, 193, 0.8);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 0 0 3px rgba(255, 182, 193, 0.1);
        }

        body[data-theme="cute"] #offline-preset-modal .form-group input,
        body[data-theme="cute"] #offline-preset-modal .form-group textarea {
            background: rgba(255, 240, 245, 0.8);
        }

        body[data-theme="cute"] #offline-preset-modal .form-group input:focus,
        body[data-theme="cute"] #offline-preset-modal .form-group textarea:focus {
            background: rgba(255, 240, 245, 0.9);
        }

        /* 门图标动画 */
        #offline-mode-icon {
            transition: all 0.3s ease;
        }

        .offline-mode-active #offline-mode-icon {
            transform: rotate(15deg);
        }

        /* 可爱主题下的线下模式样式 */
        body[data-theme="cute"] .offline-mode-overlay {
            background: rgba(255, 230, 240, 0.95);
        }

        body[data-theme="cute"] .offline-message.user .offline-message-content {
            background: var(--theme-button-bg);
        }

        body[data-theme="cute"] .offline-send-btn {
            background: var(--theme-button-bg);
        }

        /* 🔥【修改】线下模式消息菜单样式 - 与线上模式保持一致 */
        .offline-message-menu {
            position: fixed;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            z-index: 10001;
            overflow: hidden;
            min-width: 140px;
            padding: 8px;
            animation: fadeInScale 0.2s ease;
        }

        .offline-message-menu .menu-item {
            padding: 10px 16px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            border-radius: 8px;
            color: #333;
            display: flex;
            align-items: center;
            background: transparent;
            border: none;
            margin: 2px 0;
        }

        .offline-message-menu .menu-item:hover {
            background: rgba(240, 240, 240, 0.5);
            transform: scale(1.02);
        }

        .offline-message-menu .menu-item.delete {
            color: #ff3b30;
        }

        .offline-message-menu .menu-item.delete:hover {
            background: rgba(255, 59, 48, 0.1);
        }

        .offline-message-menu .menu-item i {
            margin-right: 8px;
            width: 16px;
            text-align: center;
        }

        .offline-message-menu .menu-item span {
            flex: 1;
        }

        /* 🔥【新增】禁用状态的菜单项样式 */
        .offline-message-menu .menu-item.disabled {
            color: #999;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .offline-message-menu .menu-item.disabled:hover {
            background: transparent;
            transform: none;
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* 可爱主题下的线下消息菜单 */
        body[data-theme="cute"] .offline-message-menu {
            background: rgba(255, 240, 245, 0.95);
            border: 1px solid rgba(255, 182, 193, 0.3);
        }

        body[data-theme="cute"] .offline-message-menu .menu-item:hover {
            background: rgba(255, 182, 193, 0.1);
        }

        body[data-theme="cute"] .offline-send-btn:hover {
            background: var(--theme-button-bg-hover);
        }

        body[data-theme="cute"] .offline-regenerate-btn {
            background: var(--bg-white-80);
            border-color: rgba(255, 182, 193, 0.3);
        }

        body[data-theme="cute"] .offline-regenerate-btn:hover {
            background: var(--bg-white-95);
        }

        /* 🔥【新增】可爱主题下的续写按钮样式 */
        body[data-theme="cute"] .offline-continue-btn {
            background: linear-gradient(135deg, var(--theme-button-bg), var(--theme-button-bg-hover));
        }

        body[data-theme="cute"] .offline-continue-btn:hover {
            background: linear-gradient(135deg, var(--theme-button-bg-hover), var(--theme-button-bg));
        }

        /* 🔥【新增】经典主题下的续写按钮样式 */
        body[data-theme="classic"] .offline-continue-btn {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.9), rgba(102, 126, 234, 0.8));
        }

        body[data-theme="classic"] .offline-continue-btn:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 1), rgba(102, 126, 234, 0.9));
        }

        /* 线下模式动画 */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 🔥【新增】线下模式AI回复加载动画 */
        .offline-loading-message {
            margin-bottom: 16px;
            animation: fadeInUp 0.3s ease;
            text-align: left;
        }

        .offline-loading-content {
            display: inline-block;
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            border-bottom-left-radius: 6px;
            background: var(--bg-white-90);
            color: var(--text-primary);
            border: 1px solid var(--color-gray-border);
            position: relative;
        }

        .offline-loading-dots {
            display: flex;
            align-items: center;
            gap: 4px;
            min-height: 20px;
        }

        .offline-loading-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--color-gray-medium);
            animation: loadingPulse 1.4s ease-in-out infinite both;
        }

        .offline-loading-dot:nth-child(1) {
            animation-delay: -0.32s;
        }

        .offline-loading-dot:nth-child(2) {
            animation-delay: -0.16s;
        }

        .offline-loading-dot:nth-child(3) {
            animation-delay: 0s;
        }

        @keyframes loadingPulse {
            0%, 80%, 100% {
                transform: scale(0.6);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* 可爱主题下的加载动画 */
        body[data-theme="cute"] .offline-loading-content {
            background: rgba(255, 240, 245, 0.95);
            border: 1px solid rgba(255, 182, 193, 0.3);
        }

        body[data-theme="cute"] .offline-loading-dot {
            background: var(--theme-button-bg);
        }

        /* 🔥【新增】线下模式文本格式化样式 */
        .offline-message-content em {
            font-style: italic;
            font-weight: normal; /* 斜体不加粗，保持正常字重 */
            color: inherit;
        }

        .offline-message-content strong {
            font-weight: bold; /* 加粗文本 */
            font-style: normal;
            color: inherit;
        }

        .offline-message-content span[style*="color"] {
            font-weight: 500;
        }

        /* 🔥【新增】退出线下模式按钮的毛玻璃样式 - 使用特定类名 */
        .offline-exit-modal .btn {
            backdrop-filter: blur(10px) !important;
            -webkit-backdrop-filter: blur(10px) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 8px !important;
            color: white !important;
            font-weight: 500 !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
            padding: 8px 16px !important; /* 更小的内边距 */
            font-size: 14px !important; /* 更小的字体 */
            min-height: 36px !important; /* 固定较小的高度 */
            width: 100% !important;
            margin-bottom: 8px !important; /* 更小的间距 */
        }

        /* 主要按钮 - 生成剧情总结 */
        .offline-exit-modal .btn-primary {
            background: rgba(40, 167, 69, 0.8) !important; /* 绿色 */
        }

        .offline-exit-modal .btn-primary:hover {
            background: rgba(40, 167, 69, 0.9) !important;
        }

        /* 次要按钮 - 暂时离开 */
        .offline-exit-modal .btn-secondary {
            background: rgba(108, 117, 125, 0.8) !important; /* 灰色 */
        }

        .offline-exit-modal .btn-secondary:hover {
            background: rgba(108, 117, 125, 0.9) !important;
        }

        /* 危险按钮 - 放弃总结 */
        .offline-exit-modal .btn-danger {
            background: rgba(220, 53, 69, 0.8) !important; /* 红色 */
        }

        .offline-exit-modal .btn-danger:hover {
            background: rgba(220, 53, 69, 0.9) !important;
        }

        /* 经典主题下的特殊样式 */
        body[data-theme="classic"] .offline-exit-modal .btn-primary {
            background: rgba(102, 126, 234, 0.8) !important; /* 雾霾蓝 */
        }

        body[data-theme="classic"] .offline-exit-modal .btn-primary:hover {
            background: rgba(102, 126, 234, 0.9) !important;
        }

        /* 可爱主题下的特殊样式 */
        body[data-theme="cute"] .offline-exit-modal .btn-primary {
            background: rgba(255, 182, 193, 0.8) !important; /* 雾霾粉 */
            color: #8B4B8C !important;
        }

        body[data-theme="cute"] .offline-exit-modal .btn-primary:hover {
            background: rgba(255, 182, 193, 0.9) !important;
        }

        /* 悬停和点击效果 */
        .offline-exit-modal .btn:hover {
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
        }

        .offline-exit-modal .btn:active {
            transform: translateY(0) !important;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1) !important;
        }

        /* 最后一个按钮不要下边距 */
        .offline-exit-modal .btn:last-child {
            margin-bottom: 0 !important;
        }

        /* 🔥【新增】加载状态的按钮样式 */
        .offline-exit-modal .btn:disabled {
            opacity: 0.7 !important;
            cursor: not-allowed !important;
            transform: none !important;
        }

        .offline-exit-modal .btn:disabled:hover {
            transform: none !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
        }

        /* 确保格式化文本在不同主题下都有良好的可读性 */
        body[data-theme="cute"] .offline-message-content em {
            color: var(--theme-button-bg);
        }

        #api-chat-screen .header .character-status {
            position: absolute;
            top: 63px; /* 向上移动1px */
            left: 50%;
            transform: translateX(-50%);
            justify-content: center;
            white-space: nowrap;
            z-index: 10;
            /* 移除所有背景装饰，保持干净 */
        }



        /* 🔥【新增】确保聊天界面标题居中显示 */
        .header .header-title {
            text-align: center;
            flex: 1;
            color: #000000;
            position: relative; /* 为状态定位提供参考 */
            transition: color 0.3s ease; /* 添加颜色过渡动画 */
        }

        /* 🔥【新增】当显示角色状态时，标题向上移动2px */
        .header:has(.character-status) .header-title {
            transform: translateY(-2px);
        }

        /* 🔥【新增】正在输入状态的标题样式 */
        .header .header-title.typing-status {
            color: #666666; /* 更深的灰色文字 */
            font-style: normal; /* 取消斜体 */
            font-weight: normal; /* 正常字体粗细 */
        }

        /* 🔥【美化】拉黑状态提示样式 - 现代社交软件风格 */
        .blocked-input-notice {
            position: absolute;
            left: 0;
            right: 0;
            bottom: 100%; /* 位于输入框上方 */
            background: rgba(248, 249, 250, 0.85); /* 淡淡的雾霾灰，接近白色 */
            backdrop-filter: blur(8px); /* 减少模糊度，能看到下面的内容 */
            -webkit-backdrop-filter: blur(8px);
            border-top: 1px solid rgba(200, 200, 200, 0.3);
            border-bottom: 1px solid rgba(200, 200, 200, 0.2);
            padding: 12px 20px;
            text-align: center;
            z-index: 101;
            font-size: 13px;
            color: #666;
            display: none;
            box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.05);
        }

        .blocked-input-notice.show {
            display: block;
        }

        .blocked-input-notice .notice-text {
            margin-bottom: 8px;
            font-weight: 500;
            color: #6B4423;
        }

        .blocked-input-notice .notice-button {
            background: linear-gradient(135deg, #1890ff, #40a9ff);
            color: white;
            border: none;
            padding: 6px 16px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(24, 144, 255, 0.2);
        }

        .blocked-input-notice .notice-button:hover {
            background: linear-gradient(135deg, #096dd9, #1890ff);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(24, 144, 255, 0.3);
        }

        .blocked-input-notice .notice-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(24, 144, 255, 0.2);
        }

        /* 🔥【新增】消息拉黑状态指示器样式 */
        .message-blocked-indicator {
            position: absolute;
            bottom: 4px;
            width: 16px;
            height: 16px;
            background: #dc3545;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 10px;
            font-weight: bold;
            z-index: 10;
        }

        /* AI消息的拉黑指示器位置由JavaScript动态设置 */

        /* 用户消息的拉黑指示器位置由JavaScript动态设置 */

        /* 🔥【新增】好友添加成功系统提示样式 - 透明背景像戳一戳 */
        .friend-added-system-message {
            text-align: center;
            color: #999;
            font-size: 12px;
            padding: 6px 12px;
            margin: 4px auto;
            background: transparent; /* 透明背景 */
            border-radius: 12px;
            max-width: 280px;
            line-height: 1.4;
        }

        /* 🔥【新增】AI主动发送的好友申请卡片样式 */
        .friend-request-container {
            display: flex;
            justify-content: center;
            margin: 8px 0;
        }

        .friend-request-card {
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 16px;
            max-width: 280px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .friend-request-title {
            font-size: 20px; /* 从16px增加到20px */
            font-weight: bold;
            color: #333;
            margin-bottom: 16px; /* 增加与申请理由的间距 */
            text-align: center;
            line-height: 1.4; /* 增加行高让标题看起来更高 */
            padding: 4px 0; /* 增加上下内边距 */
        }

        /* 🔥【新增】好友申请留言区域样式 */
        .friend-request-message-section {
            margin-bottom: 16px;
        }

        .friend-request-message-label {
            font-size: 13px;
            color: #666;
            margin-bottom: 8px;
            text-align: left;
            font-weight: 500;
        }

        .friend-request-message-content {
            background: #f5f5f5;
            border-radius: 8px;
            padding: 20px 20px; /* 增加内边距从12px 16px到20px 20px */
            font-size: 14px;
            color: #666; /* 从#333改为#666，让文字更浅 */
            line-height: 1.5; /* 增加行高 */
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e0e0e0;
            text-align: left;
            min-height: 60px; /* 设置最小高度 */
            word-wrap: break-word; /* 确保长单词能够换行 */
            word-break: break-word; /* 处理超长单词 */
        }

        /* 保留原有的 .friend-request-message 样式以兼容其他地方 */
        .friend-request-message {
            font-size: 14px;
            color: #666;
            margin-bottom: 16px;
            line-height: 1.4;
        }

        .friend-request-actions {
            display: flex;
            gap: 16px; /* 增加按钮间距从8px到16px */
            justify-content: center;
        }

        .friend-request-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            min-width: 70px;
        }

        .friend-request-btn.accept {
            background: #a8c8e8; /* 更淡的蓝色背景 */
            color: #4a6b8a; /* 深蓝色文字 */
        }

        .friend-request-btn.accept:hover {
            background: #95b8e0; /* 悬停时稍深的淡蓝色 */
            transform: translateY(-1px);
        }

        .friend-request-btn.reject {
            background: #f8d0d0; /* 更浅的粉色 */
            color: #8b2635;
        }

        .friend-request-btn.reject:hover {
            background: #f5c2c2;
            transform: translateY(-1px);
        }

        /* 让图标更粗一些 */
        .friend-request-btn {
            font-weight: 600;
        }

        /* 🔥【新增】好友申请卡片主题适配 */
        body[data-theme="dark"] .friend-request-card {
            background: rgba(40, 40, 40, 0.95);
            border-color: #555;
            color: #fff;
        }

        body[data-theme="dark"] .friend-request-title {
            color: #fff;
        }

        body[data-theme="dark"] .friend-request-message {
            color: #ccc;
        }

        /* 🔥【新增】暗色主题下的留言区域样式 */
        body[data-theme="dark"] .friend-request-message-label {
            color: #ccc;
        }

        body[data-theme="dark"] .friend-request-message-content {
            background: #2a2a2a;
            color: #bbb; /* 从#e0e0e0改为#bbb，让暗色主题下的文字也更浅 */
            border-color: #444;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        body[data-theme="cute"] .friend-request-card {
            background: rgba(255, 240, 245, 0.95);
            border-color: #ffb6c1;
        }

        /* 🔥【新增】可爱主题下的留言区域样式 */
        body[data-theme="cute"] .friend-request-message-label {
            color: #8b2d5a;
        }

        body[data-theme="cute"] .friend-request-message-content {
            background: rgba(255, 240, 245, 0.8);
            color: #a0506e; /* 从#8b2d5a改为#a0506e，让可爱主题下的文字也更浅 */
            border-color: #ffb6c1;
            box-shadow: inset 0 1px 3px rgba(255, 182, 193, 0.3);
        }

        body[data-theme="cute"] .friend-request-btn.accept {
            background: #a8c8e8; /* 和默认主题一样的更淡蓝色 */
            color: #4a6b8a; /* 和默认主题一样的深蓝色文字 */
        }

        body[data-theme="cute"] .friend-request-btn.accept:hover {
            background: #95b8e0; /* 和默认主题一样的悬停淡蓝色 */
        }

        body[data-theme="cute"] .friend-request-btn.reject {
            background: #f8d0d0; /* 和默认主题一样的浅粉色 */
            color: #8b2635; /* 和默认主题一样的深红色文字 */
        }

        body[data-theme="cute"] .friend-request-btn.reject:hover {
            background: #f5c2c2; /* 和默认主题一样的悬停粉色 */
        }

        /* 暗色主题按钮适配 */
        body[data-theme="dark"] .friend-request-btn.accept {
            background: #4a6b8a; /* 暗蓝色 */
            color: #b3d4f1; /* 浅蓝色文字 */
        }

        body[data-theme="dark"] .friend-request-btn.accept:hover {
            background: #5a7ba0; /* 悬停时稍亮的暗蓝色 */
        }

        body[data-theme="dark"] .friend-request-btn.reject {
            background: #6b4444; /* 暗红色 */
            color: #f5b2b2;
        }

        body[data-theme="dark"] .friend-request-btn.reject:hover {
            background: #7b5454;
        }

        /* 🔥【新增】好友申请处理结果样式 */
        .friend-request-result {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            text-align: center;
            min-width: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .friend-request-result.accepted {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .friend-request-result.rejected {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* 暗色主题下的处理结果样式 */
        body[data-theme="dark"] .friend-request-result.accepted {
            background: #1e4d2b;
            color: #a3d9a5;
            border-color: #2d5a34;
        }

        body[data-theme="dark"] .friend-request-result.rejected {
            background: #4d1e1e;
            color: #d9a3a3;
            border-color: #5a2d2d;
        }

        /* 可爱主题下的处理结果样式 */
        body[data-theme="cute"] .friend-request-result.accepted {
            background: #e8f5e8;
            color: #2d5a2d;
            border-color: #b3d9b3;
        }

        body[data-theme="cute"] .friend-request-result.rejected {
            background: #ffe8e8;
            color: #5a2d2d;
            border-color: #d9b3b3;
        }

        /* 🔥【新增】联系人状态指示器样式 */
        .contact-status-indicator {
            position: absolute;
            top: 50%;
            right: 12px;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: white;
        }

        .contact-status-indicator.muted {
            background: #ff9800; /* 橙色表示屏蔽 */
        }

        .contact-status-indicator.blocked {
            background: #f44336; /* 红色表示已拉黑 */
        }

        .contact-status-indicator.blocked-by {
            background: #ff5722; /* 深橙色表示被拉黑 */
        }

        /* 确保联系人项有相对定位 */
        .contact-item {
            position: relative;
        }

        /* 🔥【删除】消息拉黑状态提示文字样式 - 现在使用系统消息 */

        /* 🔥【新增】线下模式聊天记录样式 */
        .offline-history-list {
            max-height: 400px;
            overflow-y: auto;
            padding: 10px 0;
        }

        /* 🔥【新增】线下模式界面设置样式 */
        #offline-ui-settings-modal {
            z-index: 10001 !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
        }

        #offline-ui-settings-modal .modal-content {
            z-index: 10002 !important;
            position: relative !important;
            max-height: 90vh;
            overflow-y: auto;
        }

        .color-setting-group {
            margin-bottom: 15px;
        }

        .flex-gap-15 {
            display: flex;
            gap: 15px;
        }

        .flex-1 {
            flex: 1;
        }

        .label-small {
            font-size: 12px;
            color: #666;
            font-weight: 500;
            display: block;
            margin-bottom: 5px;
        }

        .wallpaper-setting,
        .font-setting {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .wallpaper-setting input,
        .font-setting input {
            flex: 1;
            min-width: 200px;
        }

        .text-color-setting {
            margin-top: 10px;
        }

        .color-section {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.02);
            border-radius: 8px;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .section-label {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
            display: block;
        }

        .saved-colors {
            display: flex;
            gap: 5px;
            margin-top: 5px;
            flex-wrap: wrap;
        }

        .saved-color-item {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .saved-color-item:hover {
            transform: scale(1.1);
            border-color: #007AFF;
        }

        .color-management {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .offline-preview-area {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            border-radius: 12px;
            padding: 15px;
            margin-top: 10px;
            min-height: 120px;
        }

        /* 🔥【修复】预览区域使用与真实气泡相同的样式 */
        .offline-preview-area .offline-message {
            margin-bottom: 12px;
            animation: fadeInUp 0.3s ease;
        }

        .offline-preview-area .offline-message.user {
            text-align: right;
        }

        .offline-preview-area .offline-message.ai {
            text-align: left;
        }

        .offline-preview-area .offline-message-content {
            display: inline-block;
            max-width: 90%;
            padding: 10px 14px;
            border-radius: 16px;
            font-size: 14px;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .offline-preview-area .offline-message.user .offline-message-content {
            background: var(--offline-my-bubble-color, #007AFF);
            color: var(--offline-user-normal-text-color, #ffffff);
            border-bottom-right-radius: 6px;
            text-align: left;
        }

        .offline-preview-area .offline-message.ai .offline-message-content {
            background: var(--offline-ai-bubble-color, #f0f0f0);
            color: var(--offline-ai-normal-text-color, #000000);
            border-bottom-left-radius: 6px;
            border: 1px solid var(--color-gray-border);
            text-align: left;
        }

        .offline-preview-area .offline-message.user .offline-message-content em {
            font-style: italic;
            color: var(--offline-user-italic-text-color, #f0f0f0);
        }

        .offline-preview-area .offline-message.user .offline-message-content strong {
            font-weight: bold;
            color: var(--offline-user-bold-text-color, #ffffff);
        }

        .offline-preview-area .offline-message.ai .offline-message-content em {
            font-style: italic;
            color: var(--offline-ai-italic-text-color, #666666);
        }

        .offline-preview-area .offline-message.ai .offline-message-content strong {
            font-weight: bold;
            color: var(--offline-ai-bold-text-color, #333333);
        }

        /* 🔥【新增】线下模式界面设置表单样式 */
        #offline-ui-settings-modal .form-group {
            margin-bottom: 20px;
        }

        #offline-ui-settings-modal .form-group label {
            display: block;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 14px;
        }

        #offline-ui-settings-modal .form-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--color-gray-border);
            border-radius: 8px;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }

        #offline-ui-settings-modal .form-input:focus {
            outline: none;
            border-color: var(--theme-button-bg);
            box-shadow: 0 0 0 2px rgba(var(--theme-button-bg-rgb), 0.2);
        }

        #offline-ui-settings-modal .theme-button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--theme-button-bg);
            color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        #offline-ui-settings-modal .theme-button:hover {
            background: var(--theme-button-bg-hover);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        #offline-ui-settings-modal .theme-button-secondary {
            background: rgba(255, 255, 255, 0.8);
            color: #333;
            border: 1px solid rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
        }

        #offline-ui-settings-modal .theme-button-secondary:hover {
            background: rgba(255, 255, 255, 0.95);
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.12);
        }

        /* 线下模式界面设置的毛玻璃按钮样式 */
        #offline-ui-settings-modal .modal-footer .btn {
            background: rgba(255, 255, 255, 0.8) !important;
            backdrop-filter: blur(10px) !important;
            -webkit-backdrop-filter: blur(10px) !important;
            border: 1px solid rgba(0, 0, 0, 0.1) !important;
            border-radius: 10px !important;
            color: #333 !important;
            font-weight: 500 !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08) !important;
            padding: 6px 14px !important;
            font-size: 13px !important;
            min-height: 32px !important;
            margin-left: 6px !important;
        }

        #offline-ui-settings-modal .modal-footer .btn:hover {
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.12) !important;
            background: rgba(255, 255, 255, 0.95) !important;
        }

        #offline-ui-settings-modal .modal-footer .btn-primary {
            background: var(--theme-button-bg, rgba(0, 122, 255, 0.8)) !important;
            border-color: rgba(255, 255, 255, 0.3) !important;
            color: white !important;
        }

        #offline-ui-settings-modal .modal-footer .btn-primary:hover {
            background: var(--theme-button-bg-hover, rgba(0, 122, 255, 0.9)) !important;
        }

        /* 经典主题下的线下界面设置样式 */
        body[data-theme="classic"] #offline-ui-settings-modal .modal-footer .btn-primary {
            background: rgba(102, 126, 234, 0.8) !important;
        }

        body[data-theme="classic"] #offline-ui-settings-modal .modal-footer .btn-primary:hover {
            background: rgba(102, 126, 234, 0.9) !important;
        }

        /* 可爱主题下的线下界面设置样式 */
        body[data-theme="cute"] #offline-ui-settings-modal .modal-footer .btn-primary {
            background: rgba(255, 182, 193, 0.8) !important;
        }

        body[data-theme="cute"] #offline-ui-settings-modal .modal-footer .btn-primary:hover {
            background: rgba(255, 182, 193, 0.9) !important;
        }

        /* 🔥【新增】线下模式界面设置新功能样式 */
        .setting-row {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 12px;
        }

        .setting-row .radio-label {
            margin-bottom: 4px;
            margin-right: 0;
        }

        .setting-row .radio-options {
            display: flex;
            flex-direction: column;
            gap: 6px;
            width: 100%;
        }

        .checkbox-label,
        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            cursor: pointer;
            padding: 2px 0;
        }

        .radio-label {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        /* 恢复原生的checkbox和radio显示 */
        .checkbox-label input[type="checkbox"],
        .radio-option input[type="radio"] {
            width: 16px;
            height: 16px;
            margin: 0;
            cursor: pointer;
            accent-color: var(--theme-button-bg, #007AFF);
        }

        /* 选项按钮样式 - 恢复正常按钮外观 */
        .radio-option-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            margin-bottom: 6px;
            width: fit-content;
        }

        .radio-option-button:hover {
            background: rgba(255, 255, 255, 0.95);
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .radio-option-button.selected {
            background: var(--theme-button-bg, rgba(0, 122, 255, 0.8));
            color: white;
            border-color: var(--theme-button-bg, #007AFF);
        }

        /* 独立的小圆圈指示器 */
        .radio-indicator {
            width: 16px;
            height: 16px;
            border: 2px solid #ddd;
            border-radius: 50%;
            background: white;
            position: relative;
            transition: all 0.2s ease;
            flex-shrink: 0;
            margin-right: 4px;
        }

        .radio-option-button.selected .radio-indicator {
            border-color: white;
            background: white;
        }

        .radio-option-button.selected .radio-indicator::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--theme-button-bg, #007AFF);
            font-size: 10px;
            font-weight: bold;
        }

        .radio-option-button:not(.selected) .radio-indicator {
            border-color: var(--theme-button-bg, #007AFF);
        }

        .radio-option-button:not(.selected) .radio-indicator::after {
            content: '';
        }

        .avatar-setting,
        .bubble-style-setting {
            padding: 12px;
            background: transparent;
            border-radius: 8px;
            border: none;
        }

        .custom-css-setting {
            margin-top: 10px;
        }

        .css-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        /* 线下模式头像样式 */
        .offline-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--color-gray-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
            position: relative;
        }

        /* 🔥【修复】预览区域布局样式 */
        .offline-preview-area .offline-message {
            position: relative;
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 16px;
        }

        .offline-preview-area .offline-message.user {
            flex-direction: row-reverse;
            text-align: right;
        }

        .offline-preview-area .offline-message.ai {
            flex-direction: row;
            text-align: left;
        }

        /* 🔥【真正修复】默认头像位置（侧边显示） */
        .offline-avatar.user-avatar {
            order: 2; /* 🔥【修正】用户头像在右侧（配合row） */
        }

        .offline-avatar.ai-avatar {
            order: 1; /* 🔥【修正】AI头像在左侧（配合row-reverse） */
        }

        /* 🔥【修复】默认气泡宽度90% */
        .offline-preview-area .offline-message-content {
            max-width: 90% !important;
        }

        /* 隐藏头像的样式 */
        .offline-avatar.hidden {
            display: none !important;
        }

        /* 🔥【修正】当头像隐藏时的消息对齐逻辑和气泡宽度 */
        /* 用户消息：隐藏用户头像时仍然靠右显示，气泡宽度90% */
        .offline-message.user.no-user-avatar,
        .offline-preview-area .offline-message.user.no-user-avatar {
            justify-content: flex-end;
        }

        .offline-message.user.no-user-avatar .offline-message-content,
        .offline-preview-area .offline-message.user.no-user-avatar .offline-message-content {
            max-width: 90% !important;
        }

        /* 用户消息：隐藏AI头像时，用户消息保持在右侧 */
        .offline-message.user.no-ai-avatar,
        .offline-preview-area .offline-message.user.no-ai-avatar {
            justify-content: flex-end; /* 🔥【修正】配合row，flex-end让消息在右侧 */
        }

        .offline-message.user.no-ai-avatar .offline-message-content,
        .offline-preview-area .offline-message.user.no-ai-avatar .offline-message-content {
            max-width: 90% !important;
        }

        /* AI消息：隐藏AI头像时居中显示，气泡宽度90% */
        .offline-message.ai.no-ai-avatar,
        .offline-preview-area .offline-message.ai.no-ai-avatar {
            justify-content: center;
        }

        .offline-message.ai.no-ai-avatar .offline-message-content,
        .offline-preview-area .offline-message.ai.no-ai-avatar .offline-message-content {
            max-width: 90% !important;
        }

        /* AI消息：隐藏用户头像时，AI消息保持在左侧 */
        .offline-message.ai.no-user-avatar,
        .offline-preview-area .offline-message.ai.no-user-avatar {
            justify-content: flex-start; /* 🔥【修正】配合row-reverse，flex-start让消息在左侧 */
        }

        .offline-message.ai.no-user-avatar .offline-message-content,
        .offline-preview-area .offline-message.ai.no-user-avatar .offline-message-content {
            max-width: 90% !important;
        }

        /* 🔥【修复】当双方头像都隐藏时，用户消息靠右，AI消息居中，气泡宽度90% */
        .offline-message.user.no-user-avatar.no-ai-avatar,
        .offline-preview-area .offline-message.user.no-user-avatar.no-ai-avatar {
            justify-content: flex-end; /* 用户消息靠右 */
        }

        .offline-message.ai.no-user-avatar.no-ai-avatar,
        .offline-preview-area .offline-message.ai.no-user-avatar.no-ai-avatar {
            justify-content: center; /* AI消息居中 */
        }

        .offline-message.no-user-avatar.no-ai-avatar .offline-message-content,
        .offline-preview-area .offline-message.no-user-avatar.no-ai-avatar .offline-message-content {
            max-width: 90% !important;
        }

        /* 🔥【修复】现代浏览器支持：使用:has()选择器的版本 */
        .offline-message.user:has(.user-avatar[style*="display: none"]),
        .offline-preview-area .offline-message.user:has(.user-avatar[style*="display: none"]) {
            justify-content: flex-end; /* 用户消息始终靠右 */
        }

        .offline-message.ai:has(.ai-avatar[style*="display: none"]),
        .offline-preview-area .offline-message.ai:has(.ai-avatar[style*="display: none"]) {
            justify-content: center; /* AI消息居中 */
        }

        .empty-history {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .history-record-item {
            background: var(--bg-white-90);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            border: 1px solid var(--border-black-05);
            transition: all 0.2s ease;
        }

        .history-record-item:hover {
            background: var(--bg-white-95);
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }

        .history-record-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .history-record-info {
            flex: 1;
        }

        .history-record-title {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
            margin-bottom: 4px;
        }

        .history-record-meta {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .history-record-actions {
            display: flex;
            gap: 8px;
        }

        .history-action-btn {
            width: 32px;
            height: 32px;
            border: 1px solid var(--border-black-10);
            border-radius: 8px;
            background: var(--bg-white-90);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .history-action-btn:hover {
            background: var(--theme-button-bg, #4a84c1);
            color: white;
            border-color: var(--theme-button-bg, #4a84c1);
        }

        .history-action-btn.delete:hover {
            background: #e74c3c;
            border-color: #e74c3c;
        }

        .history-record-summary {
            font-size: 13px;
            line-height: 1.4;
            color: var(--text-primary);
            background: var(--bg-white-95);
            padding: 10px;
            border-radius: 8px;
            border-left: 3px solid var(--theme-button-bg, #4a84c1);
        }

        /* 聊天记录详情样式 */
        .history-detail-info {
            background: var(--bg-white-95);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .history-summary-text {
            background: white;
            padding: 12px;
            border-radius: 8px;
            /* 移除蓝色左边框 */
            margin-top: 8px;
            line-height: 1.5;
            font-size: 14px;
        }

        .history-messages-container {
            max-height: none;
            overflow-y: visible;
            border: 1px solid var(--border-black-05);
            border-radius: 8px;
            padding: 10px;
            background: var(--bg-white-95);
        }

        .history-message {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            background: white;
        }

        .history-message.user {
            border-left: none; /* 移除蓝色左边框 */
        }

        .history-message.ai {
            border-left: none; /* 移除红色左边框 */
        }

        .history-message .message-sender {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .history-message .message-content {
            font-size: 14px;
            line-height: 1.4;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .history-message .message-time {
            font-size: 11px;
            color: var(--text-secondary);
            text-align: right;
        }

        /* 记忆查看器样式 */
        .memory-character-selector {
            padding: 15px;
            background: var(--bg-white-90);
            border-radius: 12px;
            margin: 15px;
            border: 1px solid var(--border-black-05);
        }

        .memory-character-selector label {
            display: block;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 14px;
        }

        #memory-character-select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-black-10);
            border-radius: 8px;
            background: white;
            font-size: 14px;
            color: var(--text-primary);
        }

        .memory-search-section {
            padding: 0 15px;
            margin-bottom: 15px;
        }

        .memory-search-bar {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }

        #memory-search-input {
            flex: 1;
            padding: 10px 12px;
            border: 1px solid var(--border-black-10);
            border-radius: 8px;
            font-size: 14px;
            background: white;
        }

        .search-btn {
            padding: 10px 15px;
            background: var(--theme-button-bg, #4a84c1);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .search-btn:hover {
            background: var(--theme-button-bg-hover, #3a74b1);
        }

        .memory-filter-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            padding-bottom: 5px;
            max-width: 100%;
            overflow: hidden;
        }

        .memory-filter-tab {
            padding: 6px 12px;
            background: var(--bg-white-90);
            border: 1px solid var(--border-black-05);
            border-radius: 16px;
            font-size: 12px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .memory-filter-tab.active {
            background: var(--theme-button-bg, #4a84c1);
            color: white;
            border-color: var(--theme-button-bg, #4a84c1);
        }

        .memory-filter-tab:hover:not(.active) {
            background: var(--bg-white-95);
            border-color: var(--border-black-10);
        }

        .memory-content-area {
            flex: 1;
            overflow: hidden;
        }

        .memory-list {
            height: 100%;
            overflow-y: auto;
            padding: 0 15px 15px;
        }

        .memory-empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 200px;
            color: var(--color-gray);
            text-align: center;
        }

        .memory-empty-state i {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .memory-item {
            background: var(--bg-white-90);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            border: 1px solid var(--border-black-05);
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .memory-item:hover {
            background: var(--bg-white-95);
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }

        .memory-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .memory-item-type {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 8px;
            background: var(--theme-button-bg, #4a84c1);
            color: white;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }

        .memory-item-type.core {
            background: #e74c3c;
        }

        .memory-item-type.episodic {
            background: #f39c12;
        }

        .memory-item-type.timeline {
            background: #9b59b6;
        }

        /* 记忆设置模态框样式 */
        #memorySettingsModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        #memorySettingsModal .modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            max-height: 85vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        #memorySettingsModal .modal-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0; /* 防止header被压缩 */
        }

        #memorySettingsModal .modal-header h3 {
            margin: 0;
            color: #333;
        }

        #memorySettingsModal .modal-close {
            background: none;
            border: none;
            font-size: 20px;
            color: #999;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.2s;
        }

        #memorySettingsModal .modal-close:hover {
            background: #f5f5f5;
            color: #333;
        }

        #memorySettingsModal .modal-body {
            padding: 20px;
            flex: 1;
            overflow-y: auto;
            max-height: calc(85vh - 140px); /* 减去header和footer的高度 */
        }

        #memorySettingsModal .setting-group {
            margin-bottom: 25px;
        }

        #memorySettingsModal .setting-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        #memorySettingsModal .setting-group input[type="number"] {
            width: 120px;
            max-width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.2s;
        }

        #memorySettingsModal .setting-group input[type="number"]:focus {
            outline: none;
            border-color: #007AFF;
        }

        #memorySettingsModal .setting-group input[type="range"] {
            width: calc(100% - 60px);
            margin-right: 10px;
        }

        #memorySettingsModal .setting-group span {
            display: inline-block;
            width: 50px;
            text-align: center;
            font-weight: 600;
            color: #007AFF;
        }

        #memorySettingsModal .setting-group small {
            display: block;
            margin-top: 5px;
            color: #666;
            font-size: 14px;
        }

        #memorySettingsModal .modal-footer {
            padding: 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            gap: 15px;
            flex-shrink: 0; /* 防止footer被压缩 */
        }

        #memorySettingsModal .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 80px;
            flex: 0 0 auto;
        }

        #memorySettingsModal .btn-secondary {
            background: #f5f5f5;
            color: #333;
        }

        #memorySettingsModal .btn-secondary:hover {
            background: #e5e5e5;
        }

        #memorySettingsModal .btn-primary {
            background: var(--theme-button-bg, #007AFF);
            color: var(--theme-button-color, white);
        }

        #memorySettingsModal .btn-primary:hover {
            background: var(--theme-button-bg-hover, #0056CC);
        }

        /* 全局记忆设置模态框样式 */
        #global-memory-modal.modal {
            display: flex !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background-color: rgba(0, 0, 0, 0.5) !important;
            z-index: 10000 !important;
            justify-content: center !important;
            align-items: center !important;
        }

        #global-memory-modal.modal .modal-content {
            background: white !important;
            border-radius: 12px !important;
            width: 90% !important;
            max-width: 400px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
        }




        /* 全局记忆设置模态框的紧凑样式 */
        #global-memory-modal .modal-header {
            padding: 16px 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #global-memory-modal .modal-header h3 {
            margin: 0;
            color: #333;
            font-size: 16px;
        }

        #global-memory-modal .modal-close {
            background: none;
            border: none;
            font-size: 18px;
            color: #999;
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            transition: all 0.2s;
        }

        #global-memory-modal .modal-close:hover {
            background: #f5f5f5;
            color: #333;
        }

        #global-memory-modal .modal-body {
            padding: 16px 20px;
        }

        #global-memory-modal .setting-section {
            margin-bottom: 20px;
        }

        #global-memory-modal .setting-section h4 {
            margin: 0 0 12px 0;
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        #global-memory-modal .radio-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        #global-memory-modal .radio-option {
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: rgba(255, 255, 255, 0.9);
        }

        #global-memory-modal .radio-option:hover {
            border-color: var(--theme-button-bg, #007AFF);
            background: rgba(var(--theme-button-bg-rgb, 0, 122, 255), 0.05);
        }

        #global-memory-modal .radio-custom {
            width: 16px;
            height: 16px;
            margin-right: 10px;
        }

        #global-memory-modal .radio-content {
            flex: 1;
        }

        #global-memory-modal .radio-title {
            font-size: 14px;
            font-weight: 500;
            color: #333;
            margin-bottom: 2px;
        }

        #global-memory-modal .radio-desc {
            font-size: 12px;
            color: #666;
        }

        #global-memory-modal .modal-actions {
            padding: 12px 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            gap: 12px;
        }

        #global-memory-modal .modal-button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 70px;
            flex: 0 0 auto;
        }

        #global-memory-modal .modal-secondary {
            background: #f5f5f5;
            color: #333;
        }

        #global-memory-modal .modal-secondary:hover {
            background: #e5e5e5;
        }

        #global-memory-modal .modal-primary {
            background: var(--theme-button-bg, #007AFF);
            color: var(--theme-button-color, white);
        }

        #global-memory-modal .modal-primary:hover {
            background: var(--theme-button-bg-hover, #0056CC);
        }

        .memory-item-date {
            font-size: 12px;
            color: var(--color-gray);
        }

        .memory-item-content {
            font-size: 14px;
            line-height: 1.4;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .memory-item-importance {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: var(--color-gray);
        }

        .importance-stars {
            color: #f39c12;
        }

        .memory-item-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .memory-item:hover .memory-item-actions {
            opacity: 1;
        }

        .memory-action-btn {
            padding: 5px 10px;
            background: var(--bg-white-95);
            border: 1px solid var(--border-black-10);
            border-radius: 6px;
            font-size: 12px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .memory-action-btn:hover {
            background: var(--theme-button-bg, #4a84c1);
            color: white;
            border-color: var(--theme-button-bg, #4a84c1);
        }

        .memory-action-btn.delete:hover {
            background: #e74c3c;
            border-color: #e74c3c;
        }

        /* 🔥【新增】记忆管理按钮网格布局 */
        .memory-management-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 15px;
        }

        .memory-management-grid .memory-action-btn:last-child {
            grid-column: 1 / -1; /* 让最后一个按钮占满整行 */
        }

        /* 🔥【新增】美化记忆操作按钮 */
        .memory-action-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            border: 1px solid var(--border-black-10);
            border-radius: 12px;
            background: var(--bg-white-90);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-size: 14px;
            color: var(--text-primary);
            min-height: 70px;
        }

        .memory-action-btn:hover {
            background: var(--bg-white-95);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .memory-action-btn.primary {
            border-color: #e74c3c;
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.1), rgba(231, 76, 60, 0.05));
        }

        .memory-action-btn.primary:hover {
            border-color: #e74c3c;
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.15), rgba(231, 76, 60, 0.08));
        }

        .memory-action-btn.secondary {
            border-color: #f39c12;
            background: linear-gradient(135deg, rgba(243, 156, 18, 0.1), rgba(243, 156, 18, 0.05));
        }

        .memory-action-btn.secondary:hover {
            border-color: #f39c12;
            background: linear-gradient(135deg, rgba(243, 156, 18, 0.15), rgba(243, 156, 18, 0.08));
        }

        .memory-action-btn.accent {
            border-color: var(--theme-button-bg, #4a84c1);
            background: linear-gradient(135deg, rgba(74, 132, 193, 0.1), rgba(74, 132, 193, 0.05));
        }

        .memory-action-btn.accent:hover {
            border-color: var(--theme-button-bg, #4a84c1);
            background: linear-gradient(135deg, rgba(74, 132, 193, 0.15), rgba(74, 132, 193, 0.08));
        }

        .memory-action-btn .btn-icon {
            font-size: 24px;
            flex-shrink: 0;
        }

        .memory-action-btn .btn-content {
            flex: 1;
        }

        .memory-action-btn .btn-title {
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .memory-action-btn .btn-desc {
            font-size: 12px;
            color: var(--text-secondary);
            opacity: 0.8;
        }

        /* 🔥【新增】清空历史记录选项模态框样式 */
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .checkbox-option {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            cursor: pointer;
            padding: 12px;
            border-radius: 8px;
            transition: background-color 0.2s ease;
        }

        .checkbox-option:hover {
            background-color: var(--bg-white-95);
        }

        .checkbox-custom {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-black-20);
            border-radius: 4px;
            position: relative;
            flex-shrink: 0;
            margin-top: 2px;
            transition: all 0.2s ease;
        }

        .checkbox-option input[type="checkbox"] {
            display: none;
        }

        .checkbox-option input[type="checkbox"]:checked + .checkbox-custom {
            background-color: var(--theme-button-bg, #4a84c1);
            border-color: var(--theme-button-bg, #4a84c1);
        }

        .checkbox-option input[type="checkbox"]:checked + .checkbox-custom::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .checkbox-content {
            flex: 1;
        }

        .checkbox-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
            font-size: 14px;
        }

        .checkbox-desc {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* 🔥【新增】记忆查看模态框样式 */
        .memory-modal-item {
            background: var(--bg-white-90);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            border: 1px solid var(--border-black-05);
            transition: all 0.2s ease;
        }

        .memory-modal-item:hover {
            background: var(--bg-white-95);
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }

        .memory-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .memory-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .memory-edit-btn,
        .memory-save-btn,
        .memory-cancel-btn,
        .memory-delete-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            font-size: 12px;
            transition: all 0.2s ease;
            opacity: 0.7;
        }

        .memory-edit-btn {
            color: #4CAF50;
        }

        .memory-edit-btn:hover {
            background: rgba(76, 175, 80, 0.1);
            opacity: 1;
            transform: scale(1.1);
        }

        .memory-save-btn {
            color: #007AFF;
        }

        .memory-save-btn:hover {
            background: rgba(0, 122, 255, 0.1);
            opacity: 1;
            transform: scale(1.1);
        }

        .memory-cancel-btn {
            color: #999;
        }

        .memory-cancel-btn:hover {
            background: rgba(153, 153, 153, 0.1);
            opacity: 1;
            transform: scale(1.1);
        }

        .memory-delete-btn {
            color: #ff4444;
        }

        .memory-delete-btn:hover {
            background: rgba(255, 68, 68, 0.1);
            opacity: 1;
            transform: scale(1.1);
        }

        .memory-modal-index {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: var(--theme-button-bg, #4a84c1);
            color: white;
            border-radius: 50%;
            font-size: 12px;
            font-weight: 600;
        }

        .memory-modal-date {
            font-size: 12px;
            color: var(--text-secondary);
            background: var(--bg-white-95);
            padding: 4px 8px;
            border-radius: 8px;
        }

        .memory-modal-content {
            font-size: 14px;
            line-height: 1.5;
            color: var(--text-primary);
            margin-bottom: 8px;
            word-wrap: break-word;
        }

        .memory-importance {
            display: flex;
            align-items: center;
            gap: 2px;
            font-size: 14px;
            color: #f39c12;
        }

        .memory-empty {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
            font-style: italic;
            background: var(--bg-white-90);
            border-radius: 12px;
            border: 2px dashed var(--border-black-05);
        }



        /* 记忆共享设置模态框样式 */
        #memory-share-modal.modal {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: rgba(0, 0, 0, 0.5) !important;
            display: flex !important;
            justify-content: center !important;
            align-items: center !important;
            z-index: 10000 !important;
        }

        /* 🔥【移动端修复】专门处理移动端虚拟键盘问题 */
        @media screen and (max-width: 768px) {
            body {
                /* 使用固定定位，防止虚拟键盘影响 */
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                right: 0 !important;
                bottom: 0 !important;
                width: 100% !important;
                height: 100% !important;
                overflow: hidden !important;
            }

            #phone-screen {
                /* 确保虚拟手机在移动端始终居中 */
                position: relative !important;
                margin: auto !important;
                flex-shrink: 0 !important;
                transform: translateZ(0) !important;
            }

            /* 🔥【新增】修复移动端线下模式界面设置按钮显示问题 */
            .radio-option-button {
                display: flex !important;
                align-items: center !important;
                gap: 8px !important;
                padding: 8px 12px !important;
                background: rgba(255, 255, 255, 0.8) !important;
                border: 1px solid rgba(0, 0, 0, 0.1) !important;
                border-radius: 8px !important;
                cursor: pointer !important;
                font-size: 13px !important;
                transition: all 0.2s ease !important;
                backdrop-filter: blur(10px) !important;
                -webkit-backdrop-filter: blur(10px) !important;
                margin-bottom: 6px !important;
                width: fit-content !important;
                visibility: visible !important;
                opacity: 1 !important;
            }

            .radio-option-button.selected {
                background: var(--theme-button-bg, rgba(0, 122, 255, 0.8)) !important;
                color: white !important;
                border-color: var(--theme-button-bg, #007AFF) !important;
            }

            .radio-indicator {
                width: 16px !important;
                height: 16px !important;
                border: 2px solid #ddd !important;
                border-radius: 50% !important;
                background: white !important;
                position: relative !important;
                transition: all 0.2s ease !important;
                flex-shrink: 0 !important;
                margin-right: 4px !important;
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
            }

            .radio-option-button.selected .radio-indicator {
                border-color: white !important;
                background: white !important;
            }

            .radio-option-button.selected .radio-indicator::after {
                content: '✓' !important;
                position: absolute !important;
                top: 50% !important;
                left: 50% !important;
                transform: translate(-50%, -50%) !important;
                color: var(--theme-button-bg, #007AFF) !important;
                font-size: 10px !important;
                font-weight: bold !important;
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
            }

            .radio-option-button:not(.selected) .radio-indicator {
                border-color: var(--theme-button-bg, #007AFF) !important;
            }

            .radio-option-button:not(.selected) .radio-indicator::after {
                content: '' !important;
            }
        }

        /* 🔥【修复】改进iOS Safari的移动端处理 */
        @supports (-webkit-touch-callout: none) {
            body {
                /* iOS Safari专用修复 */
                position: fixed !important;
                /* 🔥【修复】只禁用系统菜单，保留自定义长按功能 */
                -webkit-tap-highlight-color: transparent !important;
            }

            /* 🔥【修复】针对消息元素的优化处理 */
            .message-bubble, .offline-message-content, .sms-message-bubble {
                /* 🔥【修复】允许触摸事件正常工作 */
                touch-action: manipulation !important;
                /* 🔥【修复】只在必要时禁用选择 */
                -webkit-user-select: none !important;
                user-select: none !important;
                /* 🔥【修复】保持正常的触摸响应 */
                -webkit-tap-highlight-color: transparent !important;
            }

            /* 🔥【修复】确保消息项可以正常响应触摸 */
            .message-item, .contact-item {
                touch-action: manipulation !important;
                -webkit-tap-highlight-color: transparent !important;
            }
        }

        #memory-share-modal.modal .modal-content {
            background: white !important;
            border-radius: 12px !important;
            width: 90% !important;
            max-width: 400px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3) !important;
        }

        #memory-share-modal .modal-header {
            padding: 16px 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #memory-share-modal .modal-header h3 {
            margin: 0;
            color: #333;
            font-size: 16px;
        }

        #memory-share-modal .modal-close {
            background: none;
            border: none;
            font-size: 18px;
            color: #999;
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            transition: all 0.2s;
        }

        #memory-share-modal .modal-close:hover {
            background: #f5f5f5;
            color: #333;
        }

        #memory-share-modal .modal-body {
            padding: 16px 20px;
        }

        #memory-share-modal .setting-section {
            margin-bottom: 20px;
        }

        #memory-share-modal .setting-section h4 {
            margin: 0 0 12px 0;
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        #memory-share-modal .radio-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        #memory-share-modal .radio-option {
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: rgba(255, 255, 255, 0.9);
        }

        #memory-share-modal .radio-option:hover {
            border-color: var(--theme-button-bg, #007AFF);
            background: rgba(var(--theme-button-bg-rgb, 0, 122, 255), 0.05);
        }

        #memory-share-modal .radio-custom {
            width: 16px;
            height: 16px;
            margin-right: 10px;
        }

        #memory-share-modal .radio-content {
            flex: 1;
        }

        #memory-share-modal .radio-title {
            font-size: 14px;
            font-weight: 500;
            color: #333;
            margin-bottom: 2px;
        }

        #memory-share-modal .radio-desc {
            font-size: 12px;
            color: #666;
        }

        #memory-share-modal .info-text {
            font-size: 12px;
            color: #666;
            line-height: 1.4;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
        }

        #memory-share-modal .modal-actions {
            padding: 12px 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            gap: 12px;
        }

        #memory-share-modal .modal-button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 70px;
            flex: 0 0 auto;
        }

        #memory-share-modal .modal-secondary {
            background: #f5f5f5;
            color: #333;
        }

        #memory-share-modal .modal-secondary:hover {
            background: #e5e5e5;
        }

        #memory-share-modal .modal-primary {
            background: var(--theme-button-bg, #007AFF);
            color: var(--theme-button-color, white);
        }

        #memory-share-modal .modal-primary:hover {
            background: var(--theme-button-bg-hover, #0056CC);
        }

        /* 复选框组样式 */
        #memory-share-modal .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        #memory-share-modal .checkbox-option {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: rgba(255, 255, 255, 0.9);
        }

        #memory-share-modal .checkbox-option:hover {
            border-color: var(--theme-button-bg, #007AFF);
            background: rgba(var(--theme-button-bg-rgb, 0, 122, 255), 0.05);
        }

        #memory-share-modal .checkbox-option input[type="checkbox"] {
            display: none;
        }

        #memory-share-modal .checkbox-custom {
            width: 16px;
            height: 16px;
            border: 2px solid #ddd;
            border-radius: 3px;
            margin-right: 10px;
            position: relative;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        #memory-share-modal .checkbox-option input[type="checkbox"]:checked + .checkbox-custom {
            border-color: var(--theme-button-bg, #007AFF);
            background-color: var(--theme-button-bg, #007AFF);
        }

        #memory-share-modal .checkbox-option input[type="checkbox"]:checked + .checkbox-custom::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 10px;
            font-weight: bold;
        }

        #memory-share-modal .checkbox-content {
            flex: 1;
        }

        #memory-share-modal .checkbox-title {
            font-size: 14px;
        }

        /* 🔥【新增】心声模态框样式 */
        #inner-thoughts-modal .modal-content {
            max-width: 500px;
            width: 90%;
        }

        .inner-thoughts-content {
            min-height: 150px;
            padding: 20px;
            background: rgba(248, 249, 250, 0.8);
            border-radius: 12px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            font-size: 14px;
            line-height: 1.6;
            color: #333;
        }

        .inner-thoughts-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 120px;
            color: #666;
        }

        .inner-thoughts-loading p {
            margin: 15px 0 0 0;
            font-size: 14px;
        }

        .loading-spinner {
            width: 24px;
            height: 24px;
            border: 2px solid #e0e0e0;
            border-top: 2px solid #007AFF;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* 论坛加载动画 */
        .forum-loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #333;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 8px;
            vertical-align: middle;
        }

        /* 可爱主题下的加载动画 */
        body[data-theme="cute"] .forum-loading-spinner {
            border-top-color: #333;
        }

        .inner-thoughts-text {
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* 🔥【新增】群聊心声角色信息样式 */
        .inner-thoughts-character-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .character-mini-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid rgba(0, 0, 0, 0.1);
        }

        .character-name {
            font-weight: 600;
            color: #333;
            font-size: 15px;
        }

        /* 可爱主题下的群聊心声样式 */
        body[data-theme="cute"] .inner-thoughts-character-info {
            border-bottom-color: rgba(255, 182, 193, 0.3);
        }

        body[data-theme="cute"] .character-mini-avatar {
            border-color: rgba(255, 182, 193, 0.5);
        }

        body[data-theme="cute"] .character-name {
            color: var(--theme-text-color);
        }

        /* 心声刷新按钮 - 位于模态框底部 */
        .inner-thoughts-refresh-btn {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .inner-thoughts-refresh-btn i {
            transition: transform 0.3s ease;
        }

        .inner-thoughts-refresh-btn:hover i {
            transform: rotate(180deg);
        }

        /* 可爱主题下的心声模态框 */
        body[data-theme="cute"] .inner-thoughts-content {
            background: rgba(255, 240, 245, 0.9);
            border-color: rgba(255, 182, 193, 0.3);
        }

        /* 🔥【新增】视频通话界面样式 */
        #video-call-screen {
            background: #000;
        }

        .video-call-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
            z-index: 0;
        }

        /* 🔥【新增】视频来电等待接听界面状态栏样式 */
        #incoming-video-call-screen .app-status-bar {
            background: transparent !important;
            background-color: transparent !important;
            color: white !important;
            z-index: 10;
            position: absolute;
        }

        #incoming-video-call-screen .app-status-time {
            color: white !important;
        }

        #incoming-video-call-screen .battery-text {
            color: white !important;
        }

        #incoming-video-call-screen .app-battery-icon {
            border-color: white !important;
        }

        #incoming-video-call-screen .app-battery-level {
            background-color: white !important;
        }

        #video-call-screen .app-status-bar {
            background: transparent !important;
            background-color: transparent !important;
            color: white !important;
            z-index: 10;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            backdrop-filter: none !important;
            -webkit-backdrop-filter: none !important;
            border-bottom: none !important;
            box-shadow: none !important;
        }

        /* 确保视频通话界面的状态栏完全透明 */
        div#video-call-screen .app-status-bar,
        div#video-call-screen .app-status-bar::before,
        div#video-call-screen .app-status-bar::after {
            background: transparent !important;
            background-color: transparent !important;
            background-image: none !important;
        }

        /* 额外的强制透明规则 */
        body #video-call-screen .app-status-bar {
            background: transparent !important;
            background-color: transparent !important;
            background-image: none !important;
        }

        /* 视频通话界面电池图标白色样式 */
        #video-call-screen .app-battery-icon {
            border-color: white !important;
        }

        #video-call-screen .app-battery-icon::after {
            background-color: white !important;
        }

        #video-call-screen .app-battery-level {
            background-color: white !important;
        }

        /* 语音通话界面电池图标白色样式 */
        #phone-call-screen .app-battery-icon {
            border-color: white !important;
        }

        #phone-call-screen .app-battery-icon::after {
            background-color: white !important;
        }

        #phone-call-screen .app-battery-level {
            background-color: white !important;
        }

        /* 来电界面电池图标白色样式 */
        #incoming-call-screen .app-battery-icon {
            border-color: white !important;
        }

        #incoming-call-screen .app-battery-icon::after {
            background-color: white !important;
        }

        #incoming-call-screen .app-battery-level {
            background-color: white !important;
        }

        .video-call-main-view {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            border-radius: 0;
        }

        .character-video-avatar {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        .video-call-user-window {
            position: absolute;
            top: 60px;
            right: 15px;
            width: 100px;
            height: 140px;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 5;
        }

        .user-video-avatar {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        .video-call-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to bottom, rgba(0, 0, 0, 0.6), transparent);
            padding: 60px 20px 20px;
            z-index: 3;
            pointer-events: none;
        }



        .video-call-info {
            color: white;
            text-align: left;
        }

        .video-call-name {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 5px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .video-call-status {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 5px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .video-call-time {
            font-size: 16px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .video-call-floating-messages {
            position: absolute;
            top: 40%;
            left: 20px;
            right: 20px;
            bottom: 160px;
            z-index: 8;
            pointer-events: auto;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            gap: 4px;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 20px 0 10px 0;
            mask: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.2) 10%, rgba(0,0,0,0.8) 25%, rgba(0,0,0,1) 35%, rgba(0,0,0,1) 100%);
            -webkit-mask: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.2) 10%, rgba(0,0,0,0.8) 25%, rgba(0,0,0,1) 35%, rgba(0,0,0,1) 100%);
            /* 确保滚动条可见且可用 */
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
        }

        /* 消息容器内的消息包装器 */
        .video-call-floating-messages > * {
            flex-shrink: 0;
        }

        .video-call-floating-messages::-webkit-scrollbar {
            width: 4px;
        }

        .video-call-floating-messages::-webkit-scrollbar-track {
            background: transparent;
        }

        .video-call-floating-messages::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
        }

        .video-call-floating-messages::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        /* 视频通话消息区域上方模糊遮罩 */
        .video-call-floating-messages::before {
            content: '';
            position: absolute;
            top: -40vh;
            left: -20px;
            right: -20px;
            height: 40vh;
            background: linear-gradient(to bottom, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0.3) 70%, transparent 100%);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            z-index: -1;
            pointer-events: none;
        }

        .floating-message-bubble {
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 14px;
            border-radius: 20px;
            font-size: 14px;
            line-height: 1.3;
            text-align: center;
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            animation: floatIn 0.5s ease-out;
            max-width: 85%;
            word-wrap: break-word;
            align-self: center;
        }

        .floating-message-bubble.sent {
            background: rgba(0, 0, 0, 0.7);
            align-self: center;
            text-align: center;
        }

        .floating-message-bubble.received {
            background: rgba(0, 0, 0, 0.7);
            align-self: center;
            text-align: center;
        }

        @keyframes floatIn {
            0% {
                opacity: 0;
                transform: translateY(10px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 视频通话打字指示器 */
        .video-typing-indicator {
            background: rgba(0, 0, 0, 0.8) !important;
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: floatIn 0.3s ease-out;
            padding: 8px 14px !important;
        }

        .video-typing-dots {
            display: inline-flex;
            gap: 4px;
            align-items: center;
        }

        .video-typing-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.8);
            animation: videoTypingPulse 1.4s infinite ease-in-out;
        }

        .video-typing-dot:nth-child(1) {
            animation-delay: 0s;
        }

        .video-typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .video-typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes videoTypingPulse {
            0%, 80%, 100% {
                opacity: 0.3;
                transform: scale(0.8);
            }
            40% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* 视频通话打字指示器已删除 */

        .video-call-bottom-area {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 140px;
            display: flex;
            flex-direction: column;
            background: transparent;
            z-index: 10;
        }

        .video-call-input-area {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            gap: 10px;
            flex: 1;
        }

        .video-call-text-input {
            flex: 1;
            padding: 10px 15px;
            border: none;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.25);  /* 从0.1增加到0.25，稍微实一点 */
            color: #555;  /* 改为深灰色 */
            font-size: 14px;
            outline: none;
        }

        .video-call-text-input::placeholder {
            color: #888;  /* 改为浅灰色占位符 */
        }

        .video-call-send-btn {
            width: 40px;
            height: 40px;
            border: 1px solid rgba(255, 255, 255, 0.35);  /* 稍微调低边框透明度 */
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.25);  /* 调整为0.25，和其他按钮一致 */
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .video-call-send-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: scale(1.05);
        }

        .video-call-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 15px;
            gap: 20px;
        }

        .video-call-control-btn {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 18px;
        }

        .video-call-control-btn.mute-btn,
        .video-call-control-btn.camera-btn {
            background: rgba(255, 255, 255, 0.25);  /* 调整为0.25，和输入框一致 */
            color: white;
        }

        .video-call-control-btn.mute-btn.muted {
            background: #FF3B30;
            color: white;
        }

        .video-call-control-btn.camera-btn.camera-off {
            background: #FF3B30;
            color: white;
        }

        .video-call-control-btn.end-call-btn {
            background: #FF3B30;
            color: white;
        }

        .video-call-control-btn:hover {
            transform: scale(1.1);
        }

        .video-call-control-btn:active {
            transform: scale(0.95);
        }

        /* 🔥【新增】视频通话界面消息气泡透明样式 */
        #video-call-screen .message-bubble {
            background: transparent !important;
            box-shadow: none !important;
            border: none !important;
        }

        #video-call-screen .received .message-bubble {
            background: transparent !important;
        }

        #video-call-screen .sent .message-bubble {
            background: transparent !important;
        }

        /* 确保所有气泡样式在视频通话中都透明 */
        #video-call-screen .bubble-style-default .message-bubble,
        #video-call-screen .bubble-style-shadow .message-bubble,
        #video-call-screen .bubble-style-tail .message-bubble,
        #video-call-screen .bubble-style-paper .message-bubble {
            background: transparent !important;
            box-shadow: none !important;
            border: none !important;
        }

        /* 🔥【新增】通话系统消息样式 - 无气泡包裹，无斜体 */
        .call-system-message {
            background: none !important;
            border: none !important;
            box-shadow: none !important;
            font-style: normal !important;
            text-align: center;
            color: #888;
            font-size: 13px;
            padding: 8px 0;
        }

        .call-record-message {
            background: none !important;
            border: none !important;
            box-shadow: none !important;
            font-style: normal !important;
            text-align: center;
            color: #888;
            font-size: 13px;
            padding: 8px 0;
        }

        /* 🔥【新增】视频通话形象设置模态框样式 */
        .video-avatar-modal-content {
            max-width: 500px;
            width: 90%;
        }

        .video-avatar-preview {
            margin-bottom: 20px;
        }

        .avatar-preview-container {
            display: flex;
            gap: 20px;
            justify-content: space-around;
        }

        .avatar-preview-item {
            flex: 1;
            text-align: center;
        }

        .avatar-preview-label {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        .avatar-preview-image-container {
            position: relative;
            width: 120px;
            height: 160px;
            margin: 0 auto 15px;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid #e0e0e0;
            background: #f8f9fa;
        }

        .avatar-preview-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        .avatar-preview-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 14px;
        }

        .avatar-preview-placeholder i {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .avatar-change-btn {
            padding: 12px 20px;
            border: 2px solid var(--theme-button-secondary-border, rgba(0, 0, 0, 0.1));
            border-radius: var(--theme-button-radius, 12px);
            background: var(--theme-button-secondary-bg, rgba(255, 255, 255, 0.8));
            color: var(--theme-button-secondary-color, #555);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-fast, 0.2s ease);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 2px 8px var(--bg-black-05);
            text-align: center;
        }

        .avatar-change-btn:hover {
            background: var(--theme-button-secondary-bg-hover, rgba(255, 255, 255, 0.95));
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .avatar-change-btn:active {
            transform: translateY(0);
            box-shadow: var(--shadow-button);
        }

        .video-avatar-tips {
            background: rgba(0, 122, 255, 0.05);
            border: 1px solid rgba(0, 122, 255, 0.2);
            border-radius: 12px;
            padding: 15px;
            margin-top: 20px;
        }

        .tips-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 600;
            color: #007AFF;
            margin-bottom: 10px;
        }

        .tips-content {
            font-size: 13px;
            line-height: 1.5;
            color: #666;
        }





        body[data-theme="cute"] .loading-spinner {
            border-top-color: var(--theme-button-bg);
        }

        body[data-theme="cute"] .inner-thoughts-refresh-btn:hover {
            color: var(--theme-button-bg);
        }

        /* 耳朵图标样式 */
        .ear-icon {
            margin-right: 8px;
            opacity: 0.8;
            font-weight: 500;
            color: #333;
            margin-bottom: 2px;
        }

        #memory-share-modal .checkbox-desc {
            font-size: 12px;
            color: #666;
        }

        /* 🔥【新增】论坛个人主页多选删除功能样式 */

        /* 多选模式下的帖子项布局 */
        .multi-select-item {
            display: flex !important;
            align-items: center;
            gap: 12px;
            padding: 12px 15px !important;
            cursor: default !important;
        }

        .multi-select-item.selected {
            background-color: rgba(135, 160, 180, 0.35);
        }

        /* 🔥【美化】选择框样式 - 更明显的雾霾蓝 */
        .post-checkbox {
            flex-shrink: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #5a7a95;
            font-size: 18px;
            transition: all 0.2s ease;
        }

        .post-checkbox:hover {
            transform: scale(1.1);
            color: #4a6a85;
        }

        /* 帖子内容区域 */
        .post-content {
            flex: 1;
            cursor: pointer;
        }

        /* 🔥【重新设计】悬浮操作按钮容器 - 横向排列 */
        .floating-delete-btn {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.8);
            padding: 8px 12px;
            border-radius: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        /* 🔥【简化设计】横向排列的操作按钮 */
        .select-all-btn {
            background: transparent;
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s ease;
        }

        .select-all-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* 🔥【简化设计】删除按钮 - 只显示垃圾桶和数字 */
        .delete-action-btn {
            background: #ff3b30;
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 18px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            height: 36px;
            min-width: 60px;
            justify-content: center;
        }

        .delete-action-btn:hover {
            background: #d70015;
        }

        /* 🔥【简化设计】取消按钮 - 纯文字 */
        .cancel-action-btn {
            background: transparent;
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 18px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            height: 36px;
            min-width: 50px;
            justify-content: center;
        }

        .cancel-action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .delete-action-btn i {
            font-size: 16px;
        }

        /* 多选模式下隐藏原有的点击效果 */
        .multi-select-item:hover {
            transform: none !important;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05) !important;
        }

        /* 🔥【修正】多选按钮样式 - 黑色垃圾桶图标，无背景 */
        .multi-select-toggle-btn {
            background-color: transparent !important;
            color: #333 !important;
        }

        .multi-select-toggle-btn i {
            color: #333 !important;
            font-size: 18px !important;
        }

        /* 🔥【修正】多选按钮激活状态样式 - 灰色圆形背景，显示叉号 */
        #multi-select-btn[style*="color: rgb(255, 59, 48)"] {
            background-color: #e0e0e0 !important;
            border-radius: 50% !important;
            color: #666 !important;
            width: 32px !important;
            height: 32px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        /* 🔥【修正】多选按钮激活状态的叉号图标样式 */
        #multi-select-btn[style*="color: rgb(255, 59, 48)"] i {
            color: #666 !important;
            font-size: 16px !important;
        }

        /* 确保多选模式下的帖子内容区域保持正确的布局 */
        .multi-select-item .post-content .post-title-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 8px;
        }

        .multi-select-item .post-content .post-meta {
            font-size: 12px;
            color: #888;
            margin-top: 4px;
            display: flex;
            justify-content: space-between;
        }

        /* 🔥【美化】选中状态的视觉反馈 - 更明显的雾霾蓝 */
        .multi-select-item.selected .post-checkbox {
            color: #5a7a95;
            background-color: rgba(90, 122, 149, 0.4);
            border-radius: 4px;
        }

        /* 删除按钮禁用状态 */
        .floating-delete-btn[style*="opacity: 0.5"] {
            cursor: not-allowed;
        }

        /* 🔥【简化设计】响应式设计 - 确保在小屏幕上也能正常显示 */
        @media (max-width: 480px) {
            .floating-delete-btn {
                bottom: 20px;
                gap: 8px;
                padding: 6px 10px;
            }

            .select-all-btn {
                width: 32px;
                height: 32px;
                font-size: 14px;
            }

            .delete-action-btn {
                padding: 6px 10px;
                font-size: 13px;
                min-width: 50px;
                height: 32px;
            }

            .cancel-action-btn {
                padding: 6px 10px;
                font-size: 13px;
                min-width: 40px;
                height: 32px;
            }

            .delete-action-btn i {
                font-size: 14px;
            }

            .multi-select-item {
                gap: 10px;
                padding: 10px 12px !important;
            }

            .post-checkbox {
                width: 20px;
                height: 20px;
                font-size: 16px;
            }
        }

        /* 🔥【新增】论坛编辑按钮和相关UI样式 */
        .forum-archive-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .forum-archive-title {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 0; /* 移除原来的边距 */
            flex: 1; /* 占据剩余空间 */
        }

        .forum-edit-btn {
            background: rgba(107, 155, 210, 0.08);
            border: 1px solid rgba(107, 155, 210, 0.15);
            color: #6B9BD2;
            font-size: 14px;
            cursor: pointer;
            padding: 6px;
            border-radius: 8px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            opacity: 0.8;
        }

        .forum-edit-btn:hover {
            background: rgba(107, 155, 210, 0.15);
            border-color: rgba(107, 155, 210, 0.25);
            color: #5A8BC4;
            opacity: 1;
            transform: scale(1.05);
        }

        /* 论坛操作按钮容器 */
        .forum-archive-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* 论坛删除按钮样式 */
        .forum-delete-btn {
            background: rgba(107, 155, 210, 0.08);
            border: 1px solid rgba(107, 155, 210, 0.15);
            color: #6B9BD2;
            font-size: 14px;
            cursor: pointer;
            padding: 6px;
            border-radius: 8px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            opacity: 0.8;
        }

        .forum-delete-btn:hover {
            background: rgba(107, 155, 210, 0.15);
            border-color: rgba(107, 155, 210, 0.25);
            color: #5A8BC4;
            opacity: 1;
            transform: scale(1.05);
        }

        /* 可爱主题下的编辑按钮样式 */
        body[data-theme="cute"] .forum-edit-btn {
            background: rgba(107, 155, 210, 0.08);
            border-color: rgba(107, 155, 210, 0.15);
            color: #6B9BD2;
        }

        body[data-theme="cute"] .forum-edit-btn:hover {
            background: rgba(107, 155, 210, 0.15);
            border-color: rgba(107, 155, 210, 0.25);
            color: #5A8BC4;
        }

        /* 可爱主题下的删除按钮样式 */
        body[data-theme="cute"] .forum-delete-btn {
            background: rgba(107, 155, 210, 0.08);
            border-color: rgba(107, 155, 210, 0.15);
            color: #6B9BD2;
        }

        body[data-theme="cute"] .forum-delete-btn:hover {
            background: rgba(107, 155, 210, 0.15);
            border-color: rgba(107, 155, 210, 0.25);
            color: #5A8BC4;
        }

        .selection-item-icon {
            font-size: 24px;
            color: #999;
            margin-bottom: 5px;
        }

        #forum-worldbook-selection {
            max-height: 200px; /* 增加世界书选择区域的高度 */
        }

        /* 修复创建/编辑界面按钮的点击事件 */
        #create-forum-screen .form-submit,
        #edit-forum-screen .form-submit {
            margin-top: 15px; /* 与其他元素保持间距 */
        }

        /* 🔥【新增】用户发帖图片上传样式 */
        .form-upload-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            font-size: 14px;
            color: #495057;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .form-upload-btn:hover {
            background: #e9ecef;
            border-color: #ced4da;
        }

        #post-image-preview-container {
            border: 1px solid #eee;
            padding: 5px;
            border-radius: 8px;
            background: #f9f9f9;
            display: inline-block;
        }

        /* 🔥【终极修复】让你的原始CSS选择器能够工作 */
        /* 通过JavaScript动态添加类名来支持你的CSS格式 */

        /* 🔥【新增】存储管理界面样式 */
        .storage-usage-info {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .storage-usage-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .storage-usage-fill {
            height: 100%;
            background: #4caf50;
            transition: width 0.3s ease, background-color 0.3s ease;
            border-radius: 4px;
        }

        .storage-usage-text {
            font-size: 14px;
            color: #333;
            text-align: center;
            font-weight: 500;
        }

        .storage-breakdown {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .storage-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .storage-item:last-child {
            border-bottom: none;
        }

        .cleanup-options {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 15px;
        }

        .cleanup-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .cleanup-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .cleanup-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .cleanup-results {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 15px;
        }

        .cleanup-results-text {
            font-size: 14px;
            line-height: 1.5;
        }

        /* 存储管理模态框特定样式 */
        #storage-management-modal .modal-content {
            max-height: 80vh;
            overflow-y: auto;
        }

        #storage-management-modal h4 {
            color: #333;
            font-size: 16px;
            font-weight: 600;
            margin: 0 0 15px 0;
        }

        /* 响应式调整 */
        @media (max-width: 480px) {
            .cleanup-options {
                flex-direction: column;
            }

            .cleanup-btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* 短信多选模式样式 */
        .sms-chat-multiselect-actions {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 0;
            height: 44px;
            gap: 90px;
        }

        .sms-chat-multiselect-actions .multiselect-btn {
            border: none !important;
            background: none !important;
            font-size: 18px !important;
            font-weight: 600 !important;
            cursor: pointer !important;
            padding: 0 !important;
            margin: 0 !important;
            border-radius: 0 !important;
            box-shadow: none !important;
            backdrop-filter: none !important;
            -webkit-backdrop-filter: none !important;
            min-width: auto !important;
            height: 44px !important;
            width: auto !important;
            transition: none !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            line-height: 44px !important;
        }

        .sms-chat-multiselect-actions .multiselect-btn.delete-btn {
            color: #FF3B30 !important;
        }

        .sms-chat-multiselect-actions .multiselect-btn.cancel-btn {
            color: #007AFF !important;
        }

        .sms-chat-multiselect-actions .multiselect-btn span {
            font-size: 18px !important;
            font-weight: 600 !important;
        }

        /* 短信消息选中状态样式 */
        .sms-message {
            position: relative;
            margin: 8px 0;
        }

        .sms-message.selected::after {
            content: '✓';
            position: absolute;
            top: 8px;
            right: 8px;
            width: 16px;
            height: 16px;
            background: #007AFF;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            z-index: 10;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        .sms-message.user-message.selected::after {
            right: 8px;
        }

        .sms-message.character-message.selected::after {
            left: 8px;
            right: auto;
        }

        /* 🔥【新增】位置选择模态框样式 */
        .location-modal-content {
            max-width: 400px;
            width: 90%;
            border-radius: 12px;
            overflow: hidden;
        }

        .location-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .location-modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin: 0;
            text-align: center;
            flex: 1;
        }

        .location-cancel-btn {
            background: none;
            border: none;
            color: #666;
            font-size: 16px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 6px;
            transition: background-color 0.2s ease;
        }

        .location-cancel-btn:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .location-confirm-btn {
            background-color: #6b9bd1;
            color: white;
            border: none;
            font-size: 14px;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 6px;
            font-weight: 500;
        }

        .location-modal-body {
            padding: 20px;
            background-color: white;
        }

        .location-search-section {
            margin-bottom: 20px;
        }

        .location-search-box {
            position: relative;
            display: flex;
            align-items: center;
            background-color: #f1f3f4;
            border-radius: 10px;
            padding: 12px 16px;
        }

        .location-search-icon {
            color: #9aa0a6;
            margin-right: 12px;
            font-size: 16px;
        }

        .location-search-input {
            flex: 1;
            background: none;
            border: none;
            outline: none;
            font-size: 16px;
            color: #333;
        }

        .location-search-input::placeholder {
            color: #9aa0a6;
        }

        /* 发布选项中的位置显示 */
        .option-item .option-value {
            color: #999;
            font-size: 14px;
            margin-right: 10px;
        }

        /* 动态中的位置显示 */
        .moment-time-location {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* 🔥【新增】动态可见性指示器样式 */
        .moment-visibility-indicator {
            display: inline-flex;
            align-items: center;
            margin-left: 4px;
            padding: 2px 6px;
            font-size: 12px; /* 改为与时间和位置一致的字体大小 */
            color: #576b95; /* 保持原来的蓝色 */
            gap: 3px;
        }

        .moment-visibility-indicator i {
            font-size: 10px;
        }

        /* 私密动态指示器 */
        .moment-visibility-indicator[title="私密"] {
            color: #576b95;
        }

        /* 部分可见动态指示器 */
        .moment-visibility-indicator[title="部分可见"] {
            color: #576b95;
        }

        .moment-location {
            font-size: 12px;
            color: #999; /* 改为与时间一致的颜色 */
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .moment-location i {
            font-size: 10px;
            color: #999;
        }

        /* 🔥【新增】提醒谁看功能样式 */
        .mention-icon {
            color: #999 !important;
            transition: color 0.3s ease;
        }

        .mention-icon.active {
            color: #34c759 !important;
        }

        /* 位置图标样式 */
        .location-icon {
            color: #999 !important;
            transition: color 0.3s ease;
        }

        .location-icon.active {
            color: #34c759 !important;
        }

        .selected-mentions {
            display: flex;
            gap: 4px;
            margin-left: auto;
            margin-right: 10px;
        }

        .selected-mention-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            object-fit: cover;
            border: 1px solid #e0e0e0;
        }

        /* 提醒谁看模态框样式 */
        .mention-modal-content {
            max-width: 400px;
            width: 90%;
            border-radius: 12px;
            overflow: hidden;
        }

        .mention-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .mention-modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin: 0;
            text-align: center;
            flex: 1;
        }

        .mention-cancel-btn {
            background: none;
            border: none;
            color: #666;
            font-size: 16px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 6px;
        }

        .mention-confirm-btn {
            background-color: #6b9bd1;
            color: white;
            border: none;
            font-size: 14px;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 6px;
            font-weight: 500;
        }

        .mention-modal-body {
            padding: 20px;
            background-color: white;
            max-height: 400px;
            overflow-y: auto;
        }

        .mention-characters-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .mention-character-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border: 1px solid transparent;
        }

        .mention-character-item:hover {
            background-color: #f8f9fa;
        }

        .mention-character-item.selected {
            background-color: #e3f2fd;
            border-color: #6b9bd1;
        }

        .mention-character-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 12px;
            border: 1px solid #e0e0e0;
        }

        .mention-character-info {
            flex: 1;
        }

        .mention-character-name {
            font-size: 16px;
            font-weight: 500;
            color: #333;
            margin-bottom: 2px;
        }

        .mention-character-desc {
            font-size: 12px;
            color: #666;
        }

        .mention-character-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid #ddd;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .mention-character-item.selected .mention-character-checkbox {
            background-color: #6b9bd1;
            border-color: #6b9bd1;
        }

        .mention-character-checkbox i {
            color: white;
            font-size: 12px;
            display: none;
        }

        .mention-character-item.selected .mention-character-checkbox i {
            display: block;
        }

        /* 动态中的提醒显示样式 */
        .moment-mentions {
            font-size: 13px;
            color: #666;
            margin: 2px 0;
            padding: 0;
        }

        /* 动态操作按钮样式 */
        .moment-actions {
            display: flex;
            position: relative;
        }

        /* 三点按钮样式 */
        .moment-more-btn {
            background-color: #f5f5f5;
            border: none;
            border-radius: 4px;
            padding: 7px 9px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .moment-more-btn:hover {
            background-color: #e8e8e8;
        }

        .moment-more-dots {
            display: flex;
            gap: 3px;
        }

        .moment-more-dots .dot {
            width: 4px;
            height: 4px;
            background-color: #576b95;
            border-radius: 50%;
        }

        /* 弹出菜单样式 */
        .moment-actions-popup {
            display: none;
            position: absolute;
            right: 100%;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 4px 8px;
            z-index: 1000;
            flex-direction: row;
            align-items: center;
            gap: 0;
            margin-right: 8px;
        }

        /* 弹出菜单中的按钮样式 */
        .moment-actions-popup .moment-action-btn {
            background: none;
            border: none;
            color: #576b95;
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 3px;
            padding: 6px 12px;
            white-space: nowrap;
            min-width: auto;
        }

        .moment-actions-popup .moment-action-btn:hover {
            background-color: #f8f8f8;
            border-radius: 4px;
        }

        .moment-actions-popup .moment-action-btn i {
            font-size: 14px;
        }

        /* 分隔线样式 */
        .popup-divider {
            width: 1px;
            height: 16px;
            background-color: #e0e0e0;
            margin: 0 6px;
        }

        /* 🔥【新增】谁可以看功能样式 */
        .visibility-icon {
            color: #999 !important;
            transition: color 0.3s ease;
        }

        .visibility-icon.active {
            color: #34c759 !important;
        }

        /* 谁可以看模态框样式 */
        .visibility-modal-content {
            max-width: 400px;
            width: 90%;
            border-radius: 12px;
            overflow: hidden;
        }

        .visibility-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .visibility-modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin: 0;
            text-align: center;
            flex: 1;
        }

        .visibility-cancel-btn {
            background: none;
            border: none;
            color: #666;
            font-size: 16px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 6px;
        }

        .visibility-confirm-btn {
            background-color: #6b9bd1;
            color: white;
            border: none;
            font-size: 14px;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 6px;
            font-weight: 500;
        }

        .visibility-modal-body {
            padding: 20px;
            background-color: white;
            max-height: 500px;
            overflow-y: auto;
        }

        .visibility-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }

        .visibility-option {
            display: flex;
            align-items: center;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border: 1px solid transparent;
        }

        .visibility-option:hover {
            background-color: #f8f9fa;
        }

        .visibility-option.selected {
            background-color: #e3f2fd;
            border-color: #6b9bd1;
        }

        .visibility-option-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 18px;
            color: #666;
        }

        .visibility-option.selected .visibility-option-icon {
            background-color: #6b9bd1;
            color: white;
        }

        .visibility-option-content {
            flex: 1;
        }

        .visibility-option-title {
            font-size: 16px;
            font-weight: 500;
            color: #333;
            margin-bottom: 2px;
        }

        .visibility-option-desc {
            font-size: 12px;
            color: #666;
        }

        .visibility-option-radio {
            width: 20px;
            height: 20px;
            border: 2px solid #ddd;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .visibility-option.selected .visibility-option-radio {
            background-color: #6b9bd1;
            border-color: #6b9bd1;
        }

        .visibility-option-radio i {
            color: white;
            font-size: 12px;
            display: none;
        }

        .visibility-option.selected .visibility-option-radio i {
            display: block;
        }

        /* 分组选择区域样式 */
        .visibility-groups-section {
            border-top: 1px solid #e9ecef;
            padding-top: 20px;
        }

        .visibility-groups-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }

        .visibility-groups-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .visibility-group-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border: 1px solid #e9ecef;
        }

        .visibility-group-item:hover {
            background-color: #f8f9fa;
        }

        .visibility-group-item.selected {
            background-color: #e3f2fd;
            border-color: #6b9bd1;
        }

        .visibility-group-name {
            flex: 1;
            font-size: 14px;
            color: #333;
        }

        .visibility-group-checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid #ddd;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .visibility-group-item.selected .visibility-group-checkbox {
            background-color: #6b9bd1;
            border-color: #6b9bd1;
        }

        .visibility-group-checkbox i {
            color: white;
            font-size: 10px;
            display: none;
        }

        .visibility-group-item.selected .visibility-group-checkbox i {
            display: block;
        }

        /* 🛒【新增】购物界面样式 */
        .shopping-content {
            padding: 0;
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            padding-top: 10%;
            box-sizing: border-box;
        }

        /* 🛒【修复】当显示商品列表时，移除顶部padding */
        .shopping-content.showing-products {
            padding-top: 0;
            justify-content: flex-start;
        }

        .shopping-search-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            padding: 0 30px;
            position: relative;
            z-index: 1;
        }

        .shopping-search-box {
            position: relative;
            display: flex;
            align-items: center;
            background: white;
            border-radius: 25px;
            padding: 20px 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border: 1px solid #e9ecef;
            width: 100%;
            max-width: 280px;
            margin: 0 auto;
            left: 0;
            transform: none;
        }

        .shopping-search-icon {
            color: #6c757d;
            font-size: 18px;
            margin-right: 15px;
        }

        .shopping-search-input {
            flex: 1;
            border: none;
            outline: none;
            font-size: 16px;
            color: #333;
            background: transparent;
        }

        .shopping-search-input::placeholder {
            color: #6c757d;
        }

        /* 分类区域 */
        .shopping-categories {
            width: 100%;
            max-width: 280px;
            margin-top: 30px;
        }

        .category-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .category-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border: 1px solid #f0f0f0;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .category-item:hover {
            background: #f8f9fa;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
        }

        .category-item i {
            font-size: 18px;
            color: #5a92c5;
            margin-right: 15px;
            width: 20px;
            text-align: center;
        }

        .category-item span {
            font-size: 16px;
            color: #333;
            font-weight: 500;
        }

        /* 商品展示区域 */
        .products-container {
            width: 100%;
            padding: 0 15px 20px 15px;
            height: 100%;
            overflow-y: auto;
            box-sizing: border-box;
        }

        .products-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            gap: 15px;
        }

        .back-to-categories {
            background: none;
            border: none;
            color: #5a92c5;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .back-to-categories:hover {
            color: #4a82b5;
        }

        #current-category-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin: 0;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 10px;
            width: 100%;
            box-sizing: border-box;
            margin: 0;
        }

        .product-item {
            background: white;
            border-radius: 12px;
            padding: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border: 1px solid #f0f0f0;
            width: 100%;
            box-sizing: border-box;
            min-width: 0;
        }

        .product-name {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
            line-height: 1.3;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .product-brand {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .product-price {
            font-size: 16px;
            font-weight: 700;
            color: #ff6600;
            margin-bottom: 10px;
        }

        .add-to-cart-btn {
            width: 100%;
            background: #5a92c5;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .add-to-cart-btn:hover {
            background: #4a82b5;
        }

        /* 购物界面底部导航栏 */
        .shopping-tabs {
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            border-top: 1px solid var(--color-border-light);
            background-color: var(--color-gray-bg-light);
            flex-shrink: 0;
        }

        .shopping-tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--color-text-light);
            font-size: 12px;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .shopping-tab.active {
            color: #5a92c5;
        }

        .shopping-tab i {
            font-size: 18px;
            margin-bottom: 4px;
        }

        /* 购物界面头部布局调整 - 标题居中 */
        #shopping-screen .app-header {
            position: relative;
        }

        #shopping-screen .app-title {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
        }

        /* 购物车界面头部布局调整 - 标题居中 */
        #shopping-cart-screen .app-header {
            position: relative;
        }

        #shopping-cart-screen .app-title {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
        }

        /* 购物界面头部按钮 */
        .shopping-header-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .shopping-cart-btn {
            position: absolute;
            right: calc(var(--spacing-lg) + 2px);
            top: 41px;
            width: var(--size-md);
            height: var(--size-md);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            color: #ff6600;
            background: transparent;
        }

        /* 购物车数量徽章 */
        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff4444;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 10px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 16px;
        }

        /* 🛒【新增】购物车界面样式 */
        .cart-content {
            padding: 0;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .cart-items-container {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
        }

        .cart-item {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border: 1px solid #f0f0f0;
        }

        .cart-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .cart-item-brand {
            font-size: 14px;
            color: #666;
            margin-bottom: 6px;
        }

        .cart-item-description {
            font-size: 13px;
            color: #888;
            margin-bottom: 6px;
            font-style: italic;
        }

        .cart-item-options {
            font-size: 12px;
            color: #888;
            margin-bottom: 8px;
        }

        .cart-item-remove {
            background: none;
            border: none;
            color: #ff4444;
            font-size: 16px;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: background 0.2s ease;
        }

        .cart-item-remove:hover {
            background: rgba(255, 68, 68, 0.1);
        }

        .cart-item-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-item-price {
            font-size: 18px;
            font-weight: 700;
            color: #ff6600;
        }

        .cart-item-quantity {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .quantity-btn {
            width: 32px;
            height: 32px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            transition: all 0.2s ease;
        }

        .quantity-btn:hover {
            background: #f8f9fa;
            border-color: #5a92c5;
            color: #5a92c5;
        }

        .quantity-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .quantity-btn:disabled:hover {
            background: white;
            border-color: #ddd;
            color: #666;
        }

        .quantity-number {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            min-width: 24px;
            text-align: center;
        }

        /* 购物车为空状态 */
        .cart-empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            color: #666;
        }

        .cart-empty-state i {
            font-size: 64px;
            color: #ddd;
            margin-bottom: 20px;
        }

        .cart-empty-state p {
            font-size: 16px;
            margin: 8px 0;
        }

        .go-shopping-btn {
            background: #5a92c5;
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.2s ease;
        }

        .go-shopping-btn:hover {
            background: #4a82b5;
        }

        /* 购物车底部结算区域 */
        .cart-footer {
            background: white;
            border-top: 1px solid #f0f0f0;
            padding: 15px;
            box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.08);
        }

        .cart-summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .cart-total {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .total-label {
            font-size: 16px;
            color: #666;
        }

        .total-price {
            font-size: 20px;
            font-weight: 700;
            color: #ff6600;
        }

        /* 请Ta代付按钮 */
        .pay-for-me-btn {
            background: white;
            color: #666;
            border: 1px solid #ddd;
            border-radius: 16px;
            padding: 7px 14px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 75px;
            white-space: nowrap;
        }

        .pay-for-me-btn:hover {
            background: #f5f5f5;
            border-color: #ccc;
        }

        /* 结算按钮 */
        .checkout-btn {
            background: #ff6600;
            color: white;
            border: none;
            border-radius: 16px;
            padding: 7px 12px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s ease;
            min-width: 75px;
            white-space: nowrap;
        }

        .checkout-btn:hover {
            background: #e55a00;
        }

        .checkout-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* 购物车头部操作按钮 */
        .cart-header-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .clear-cart-btn {
            position: absolute;
            right: calc(var(--spacing-lg) + 4px);
            top: 41px;
            width: var(--size-md);
            height: var(--size-md);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            color: #ff6600;
            background: transparent;
            border: none;
            border-radius: 4px;
        }

        /* 🛒【新增】自定义商品模态框样式 */
        .custom-item-modal {
            max-width: 400px;
            width: 90%;
        }

        .custom-item-modal .modal-header {
            padding: 20px 20px 10px 20px;
            border-bottom: 1px solid #eee;
            text-align: center;
        }

        .custom-item-modal .modal-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .custom-item-modal .modal-body {
            padding: 20px;
        }

        .custom-item-modal .form-group {
            margin-bottom: 16px;
        }

        .custom-item-modal .form-group:last-child {
            margin-bottom: 0;
        }

        .custom-item-modal label {
            display: block;
            margin-bottom: 6px;
            font-size: 14px;
            font-weight: 500;
            color: #555;
        }

        .custom-item-modal .form-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            box-sizing: border-box;
            transition: border-color 0.2s ease;
        }

        .custom-item-modal .form-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.1);
        }

        .custom-item-modal .price-input-container {
            position: relative;
            display: flex;
            align-items: center;
        }

        .custom-item-modal .price-symbol {
            position: absolute;
            left: 12px;
            color: #666;
            font-size: 14px;
            z-index: 1;
        }

        .custom-item-modal .price-input {
            padding-left: 28px;
        }

        .custom-item-modal .modal-footer {
            padding: 15px 20px 20px 20px;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            border-top: 1px solid #eee;
        }

        .custom-item-modal .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .custom-item-modal .btn-secondary {
            background: #f8f9fa;
            color: #6c757d;
            border: 1px solid #dee2e6;
        }

        .custom-item-modal .btn-secondary:hover {
            background: #e9ecef;
            color: #5a6268;
        }

        .custom-item-modal .btn-primary {
            background: #6b9bd2;
            color: white;
        }

        .custom-item-modal .btn-primary:hover {
            background: #5a8bc4;
        }

        /* 🛒【新增】代付选择模态框样式 */
        .payment-request-modal {
            max-width: 420px;
            width: 90%;
        }

        /* 🛒【新增】用户发起代付的黄色卡片样式 */
        .payment-request-user-card {
            background: linear-gradient(135deg, #f4d03f, #f7dc6f);
            border-radius: 15px;
            padding: 20px;
            margin: 10px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .payment-request-user-title {
            color: #8b4513;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .payment-request-user-content {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .payment-request-amount-label {
            color: #999;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .payment-request-amount-value {
            color: #333;
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .payment-request-countdown {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .payment-request-countdown-time {
            background: #333;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: monospace;
            font-weight: bold;
        }

        .payment-request-details-btn {
            background: linear-gradient(45deg, #f4d03f, #f7dc6f);
            color: #8b4513;
            border: none;
            border-radius: 8px;
            padding: 12px 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
            transition: all 0.3s ease;
        }

        .payment-request-details-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        /* 🛒【新增】代付状态样式 - 简洁白底黑字 */
        .payment-request-success-message {
            color: #333;
            font-size: 14px;
            text-align: center;
            margin: 10px 0;
            line-height: 1.4;
        }

        .payment-success-text {
            color: #4CAF50;
            font-weight: bold;
        }

        .payment-request-rejected-message {
            color: #333;
            font-size: 14px;
            text-align: center;
            margin: 10px 0;
            padding: 8px 12px;
            background: #f5f5f5;
            border-radius: 8px;
        }

        /* 🛒【新增】代付详情模态框样式 - 简化版本 */
        .payment-details-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 99999;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .payment-details-modal .modal-content {
            background: white;
            border-radius: 12px;
            padding: 0;
            max-width: 400px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            pointer-events: auto;
        }

        .payment-details-modal .modal-header {
            padding: 20px 20px 10px 20px !important;
            border-bottom: 1px solid #eee !important;
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
        }

        .payment-details-modal .modal-header h3 {
            margin: 0 !important;
            font-size: 18px !important;
            font-weight: 600 !important;
            color: #333 !important;
        }

        .payment-details-modal .modal-close-btn {
            background: none !important;
            border: none !important;
            font-size: 24px !important;
            color: #999 !important;
            cursor: pointer !important;
            padding: 0 !important;
            width: 30px !important;
            height: 30px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            border-radius: 50% !important;
            transition: all 0.2s ease !important;
        }

        .payment-details-modal .modal-close-btn:hover {
            background: #f5f5f5 !important;
            color: #333 !important;
        }

        .payment-details-modal .modal-body {
            padding: 20px !important;
        }

        .payment-details-modal .payment-details-item {
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            padding: 12px 0 !important;
            border-bottom: 1px solid #f0f0f0 !important;
        }

        .payment-details-modal .payment-details-item:last-child {
            border-bottom: none !important;
            font-weight: 600 !important;
            color: #e74c3c !important;
        }

        .payment-details-modal .payment-details-item-name {
            font-size: 14px !important;
            color: #666 !important;
        }

        .payment-details-modal .payment-details-item-price {
            font-size: 14px !important;
            color: #333 !important;
            font-weight: 500 !important;
        }

        .payment-details-item:last-child {
            border-bottom: none;
            font-weight: 600;
            color: #333;
        }

        .payment-details-item-name {
            color: #333;
        }

        .payment-details-item-price {
            color: #666;
            font-weight: 500;
        }

        .payment-request-modal .modal-header {
            padding: 20px 20px 10px 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .payment-request-modal .modal-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .payment-request-modal .modal-close-btn {
            background: none;
            border: none;
            font-size: 20px;
            color: #999;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .payment-request-modal .modal-close-btn:hover {
            color: #666;
        }

        .payment-request-modal .modal-body {
            padding: 20px;
        }

        .payment-summary {
            background: #f8f9fa;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        .payment-summary .payment-total {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .payment-summary .total-price {
            color: #ff6b35;
        }

        .payment-summary .payment-items-count {
            font-size: 14px;
            color: #666;
        }

        .payment-options h4 {
            margin: 0 0 16px 0;
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .payment-option-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .payment-option-btn {
            display: flex;
            align-items: center;
            padding: 16px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
        }

        .payment-option-btn:hover {
            border-color: #6b9bd2;
            background: #f8f9fa;
        }

        .payment-option-btn i {
            font-size: 20px;
            color: #6b9bd2;
            margin-right: 12px;
            width: 24px;
            text-align: center;
        }

        .payment-option-btn span {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            display: block;
            margin-bottom: 2px;
        }

        .payment-option-btn .option-desc {
            font-size: 13px;
            color: #666;
            font-weight: normal;
        }

        /* 购物车为空状态 */
        .cart-empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            color: #666;
        }

        .cart-empty-state i {
            font-size: 64px;
            color: #ddd;
            margin-bottom: 20px;
        }

        .cart-empty-state p {
            font-size: 16px;
            margin: 8px 0;
        }

        .go-shopping-btn {
            background: #5a92c5;
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.2s ease;
        }

        .go-shopping-btn:hover {
            background: #4a82b5;
        }

        /* 购物车底部结算区域 */
        .cart-footer {
            background: white;
            border-top: 1px solid #f0f0f0;
            padding: 15px;
            box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.08);
        }

        .cart-summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-total {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .total-label {
            font-size: 16px;
            color: #666;
        }

        .total-price {
            font-size: 20px;
            font-weight: 700;
            color: #ff6600;
        }



        /* 购物车头部操作按钮 */
        .cart-header-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        /* 🔥【新增】角色足迹功能样式 */
        .footprints-modal {
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            border-radius: 16px;
            overflow: hidden;
        }

        .footprints-header-info {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .footprints-character-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            flex-shrink: 0;
        }

        .footprints-character-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .footprints-character-info h3 {
            margin: 0 0 4px 0;
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .footprints-subtitle {
            margin: 0;
            font-size: 14px;
            color: #666;
        }

        .footprints-header-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footprints-refresh-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: transparent;
            color: #666;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .footprints-refresh-btn:hover {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
            transform: scale(1.05);
        }

        .footprints-refresh-btn:active {
            transform: scale(0.95);
        }

        .footprints-refresh-btn.refreshing {
            animation: spin 1s linear infinite;
        }

        /* 足迹模态框关闭按钮美化 */
        .footprints-modal .modal-close-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: transparent;
            color: #666;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 400;
            transition: all 0.2s ease;
            line-height: 1;
        }

        .footprints-modal .modal-close-btn:hover {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
            transform: scale(1.05);
        }

        .footprints-modal .modal-close-btn:active {
            transform: scale(0.95);
        }

        /* 足迹加载状态样式 */
        .footprints-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            text-align: center;
            color: #666;
        }

        .footprints-loading-spinner {
            width: 32px;
            height: 32px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #666;
            border-radius: 50%;
            margin-bottom: 20px;
            animation: spin 1s linear infinite;
        }

        .footprints-loading p {
            margin: 8px 0;
            font-size: 16px;
            color: #333;
        }

        .footprints-loading .loading-detail {
            font-size: 14px;
            color: #999;
        }

        .footprints-body {
            padding: 0;
            max-height: 60vh;
            overflow-y: auto;
        }

        .footprints-settings {
            padding: 16px 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .footprints-setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .footprints-setting-item label {
            font-size: 14px;
            font-weight: 500;
            color: #333;
        }

        .footprints-setting-item select {
            padding: 6px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            font-size: 14px;
            color: #333;
            cursor: pointer;
            min-width: 120px;
        }

        .footprints-setting-item select:focus {
            outline: none;
            border-color: #4a84c1;
            box-shadow: 0 0 0 2px rgba(74, 132, 193, 0.2);
        }

        .footprints-timeline {
            padding: 20px;
        }

        .footprints-empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        .footprints-empty-state i {
            font-size: 48px;
            color: #ddd;
            margin-bottom: 16px;
        }

        .footprints-empty-state p {
            margin: 8px 0;
            font-size: 14px;
        }

        .footprints-empty-state p:first-of-type {
            font-weight: 500;
            color: #333;
        }

        .footprint-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 20px;
            padding: 16px;
            background: white;
            border-radius: 12px;
            border: 1px solid #e9ecef;
            transition: all 0.2s ease;
            position: relative;
        }

        .footprint-item:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transform: translateY(-1px);
        }

        .footprint-item:last-child {
            margin-bottom: 0;
        }

        .footprint-time {
            font-size: 12px;
            font-weight: 600;
            color: #4a84c1;
            background: rgba(74, 132, 193, 0.1);
            padding: 4px 8px;
            border-radius: 6px;
            white-space: nowrap;
            flex-shrink: 0;
            min-width: 80px;
            text-align: center;
        }

        .footprint-content {
            flex: 1;
            min-width: 0;
        }

        .footprint-activity {
            font-size: 14px;
            color: #333;
            line-height: 1.4;
            margin: 0;
        }

        .footprint-location {
            font-size: 12px;
            color: #666;
            margin: 4px 0 0 0;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .footprint-location i {
            font-size: 10px;
            color: #999;
        }

        /* 不同类型足迹的颜色主题 */
        .footprint-item.type-sleep .footprint-time {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
        }

        .footprint-item.type-work .footprint-time {
            background: rgba(40, 167, 69, 0.1);
            color: #28a745;
        }

        .footprint-item.type-leisure .footprint-time {
            background: rgba(255, 193, 7, 0.1);
            color: #ffc107;
        }

        .footprint-item.type-social .footprint-time {
            background: rgba(220, 53, 69, 0.1);
            color: #dc3545;
        }

        .footprint-item.type-travel .footprint-time {
            background: rgba(23, 162, 184, 0.1);
            color: #17a2b8;
        }



        /* 加载状态样式 */
        .footprints-loading {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        .footprints-loading i {
            font-size: 32px;
            color: #4a84c1;
            margin-bottom: 16px;
        }

        .footprints-loading p {
            margin: 8px 0;
            font-size: 14px;
        }

        .footprints-loading .loading-detail {
            font-size: 12px;
            color: #999;
            font-style: italic;
        }

        /* 足迹提示样式 */
        .footprints-hint {
            margin-top: 20px;
            padding: 12px 16px;
            background: rgba(74, 132, 193, 0.1);
            border-radius: 8px;
            border-left: 3px solid #4a84c1;
        }

        .footprints-hint p {
            margin: 0;
            font-size: 13px;
            color: #4a84c1;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footprints-hint i {
            font-size: 12px;
        }

        /* 足迹项动画效果 */
        .footprint-item {
            animation: footprintSlideIn 0.3s ease-out;
        }

        @keyframes footprintSlideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* 足迹时间轴连接线 */
        .footprint-item:not(:last-child)::after {
            content: '';
            position: absolute;
            left: 50px;
            bottom: -10px;
            width: 2px;
            height: 10px;
            background: linear-gradient(to bottom, #e9ecef, transparent);
        }

        /* 足迹图标样式 */
        .footprint-activity::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4a84c1;
            margin-right: 8px;
            vertical-align: middle;
        }

        .footprint-item.type-sleep .footprint-activity::before {
            background: #6c757d;
        }

        .footprint-item.type-work .footprint-activity::before {
            background: #28a745;
        }

        .footprint-item.type-leisure .footprint-activity::before {
            background: #ffc107;
        }

        .footprint-item.type-social .footprint-activity::before {
            background: #dc3545;
        }

        .footprint-item.type-travel .footprint-activity::before {
            background: #17a2b8;
        }

        .footprint-item.type-daily .footprint-activity::before {
            background: #6f42c1;
        }

        .footprint-item.type-chat .footprint-activity::before {
            background: #e83e8c;
        }

        .footprint-item.type-chat .footprint-time {
            background: rgba(232, 62, 140, 0.1);
            color: #e83e8c;
        }

        .footprint-item.type-chat .footprint-activity::before {
            background: #e83e8c;
        }

        .footprint-item.type-chat .footprint-time {
            background: rgba(232, 62, 140, 0.1);
            color: #e83e8c;
        }

        /* 足迹提示样式 */
        .footprints-hint {
            margin-top: 20px;
            padding: 12px 16px;
            background: rgba(74, 132, 193, 0.1);
            border-radius: 8px;
            border-left: 3px solid #4a84c1;
        }

        .footprints-hint p {
            margin: 0;
            font-size: 13px;
            color: #4a84c1;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footprints-hint i {
            font-size: 12px;
        }

        /* 表情包库管理样式 */
        .emoji-library-section {
            margin-bottom: 20px;
            margin-top: 20px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            padding-top: 20px;
        }

        /* 选择模式按钮组 */
        .emoji-selection-buttons {
            display: flex;
            gap: 5px;
        }

        .emoji-selection-buttons button {
            background: #6B9BD2;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 6px 10px;
            font-size: 12px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .emoji-selection-buttons button:hover {
            background: #5a8bc4;
        }

        .emoji-selection-buttons button:last-child {
            background: #6B9BD2;
        }

        .emoji-selection-buttons button:last-child:hover {
            background: #5a8bc4;
        }

        /* 表情包复选框 */
        .emoji-checkbox {
            position: absolute;
            top: 5px;
            left: 5px;
            z-index: 10;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .emoji-library-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            background: rgba(0, 0, 0, 0.02);
            border-radius: 8px;
            padding: 10px 15px 10px 8px;
        }

        .emoji-library-header-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .create-library-btn-header {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: #f2f2f7;
            color: #6B9BD2;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 16px;
        }

        .create-library-btn-header:hover {
            background: #e5e5ea;
            transform: scale(1.05);
        }

        .create-library-btn-header:active {
            background: #d1d1d6;
            transform: scale(0.95);
        }

        .emoji-library-title h3 {
            margin: 0 0 4px 0;
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .emoji-library-title p {
            margin: 0;
            font-size: 14px;
            color: #666;
        }

        .emoji-library-toggle {
            transition: transform 0.2s ease;
        }

        #emoji-library-chevron.expanded {
            transform: rotate(180deg);
        }

        .emoji-library-content {
            padding: 15px 0;
            animation: slideDown 0.3s ease-out;
        }



        .emoji-library-list {
            display: flex;
            flex-direction: column;
        }

        .emoji-library-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .emoji-library-item:hover {
            background-color: #f5f5f5;
        }

        .emoji-library-item-info {
            flex: 1;
        }

        .emoji-library-item-name {
            font-size: 16px;
            font-weight: 500;
            color: #333;
            margin-bottom: 2px;
        }

        .emoji-library-item-stats {
            font-size: 12px;
            color: #666;
        }

        .emoji-library-item-actions {
            display: flex;
            gap: 8px;
        }

        .emoji-library-action-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            transition: background-color 0.2s ease;
            background: transparent;
            color: #6B9BD2;
            font-size: 12px;
        }

        .emoji-library-action-btn:hover {
            background: rgba(107, 155, 210, 0.1);
        }

        .emoji-library-action-btn.delete {
            background: transparent;
            color: #FF3B30;
        }

        .emoji-library-action-btn.delete:hover {
            background: rgba(255, 59, 48, 0.1);
        }

        .emoji-library-content-area {
            padding: 20px;
        }

        .emoji-library-info {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 16px;
        }

        .emoji-library-name {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .emoji-library-stats {
            font-size: 14px;
            color: #666;
        }

        .emoji-library-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(95px, 1fr));
            gap: 10px;
            padding: 10px 0;
        }

        .emoji-library-grid-item {
            display: flex;
            flex-direction: column;
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.2s ease;
            background: #f8f9fa;
            border: 1px solid transparent;
        }

        .emoji-library-grid-item:hover {
            transform: translateY(-1px);
            border-color: #007AFF;
            box-shadow: 0 2px 8px rgba(0, 122, 255, 0.15);
        }

        .emoji-image-container {
            position: relative;
            aspect-ratio: 1;
            overflow: hidden;
        }

        .emoji-image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .emoji-image-container .remove-btn {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 16px;
            height: 16px;
            background: rgba(255, 59, 48, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 10px;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            z-index: 2;
        }

        .emoji-library-grid-item:hover .remove-btn {
            display: flex;
        }

        .emoji-description-area {
            padding: 6px;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            border-top: 1px solid #eee;
            min-height: 40px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .emoji-description-area:hover {
            background: #f0f8ff;
        }

        .emoji-description-text {
            font-size: 10px;
            color: #333;
            line-height: 1.2;
            margin-bottom: 2px;
            word-break: break-word;
            /* 多行文本截断 - 使用现代标准属性 */
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            /* 备选方案：使用标准属性（未来兼容性） */
            line-clamp: 2;
            flex: 1;
        }

        .emoji-description-area.no-description .emoji-description-text {
            color: #999;
            font-style: italic;
        }

        .emoji-description-hint {
            font-size: 8px;
            display: flex;
            align-items: center;
            gap: 2px;
            margin-top: auto;
        }

        .emoji-description-area.no-description .emoji-description-hint {
            color: #ff6b6b;
        }

        .emoji-description-area:not(.no-description) .emoji-description-hint {
            color: #28a745;
        }

        /* 表情包库统计信息样式 */
        .emoji-library-stats {
            display: flex;
            gap: 12px;
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 12px;
            font-size: 11px;
        }

        .stats-item {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .stats-label {
            color: #666;
        }

        .stats-value {
            font-weight: 600;
            color: #333;
        }

        .stats-item.warning {
            color: #ff6b6b;
        }

        .stats-item.warning .stats-value {
            color: #ff6b6b;
            font-weight: 700;
        }

        .emoji-library-empty {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        .emoji-library-empty i {
            font-size: 48px;
            color: #ddd;
            margin-bottom: 16px;
        }

        .emoji-library-upload-area {
            border: 2px dashed #ddd;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .emoji-library-upload-area:hover {
            border-color: #6B9BD2;
            background: rgba(107, 155, 210, 0.05);
        }

        .emoji-library-upload-area.dragover {
            border-color: #6B9BD2;
            background: rgba(107, 155, 210, 0.1);
        }

        .emoji-library-upload-area-small {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .emoji-library-upload-area-small:hover {
            border-color: #6B9BD2;
            background: rgba(107, 155, 210, 0.05);
        }

        .emoji-library-upload-area-small.dragover {
            border-color: #6B9BD2;
            background: rgba(107, 155, 210, 0.1);
        }

        /* 表情包库删除按钮样式 */
        .emoji-library-delete-btn {
            position: absolute;
            right: 21px;
            top: 42px;
            width: 30px;
            height: 30px;
            background: none;
            border: none;
            font-size: 18px;
            color: #333;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .emoji-library-delete-btn:hover {
            background: rgba(0, 0, 0, 0.05);
            transform: scale(1.1);
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .footprints-modal {
                width: 95%;
                max-height: 85vh;
            }

            .footprints-character-avatar {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .footprints-character-info h3 {
                font-size: 16px;
            }

            .footprint-item {
                padding: 12px;
                gap: 10px;
            }

            .footprint-time {
                min-width: 70px;
                font-size: 11px;
            }

            .footprint-activity {
                font-size: 13px;
            }

            .footprint-item:not(:last-child)::after {
                left: 40px;
            }
        }



        /* 🛒【新增】自定义提示样式 */
        .custom-toast {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(248, 248, 248, 0.95);
            color: #333;
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            z-index: 10001;
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.8);
            max-width: 220px;
            text-align: center;
            line-height: 1.3;
            animation: toastFadeIn 0.3s ease-out;
        }

        .custom-toast.success {
            background: rgba(240, 248, 240, 0.95);
            color: #2e7d32;
            border-color: rgba(76, 175, 80, 0.2);
        }

        .custom-toast.error {
            background: rgba(255, 245, 245, 0.95);
            color: #c62828;
            border-color: rgba(244, 67, 54, 0.2);
        }

        .custom-toast.warning {
            background: rgba(255, 248, 240, 0.95);
            color: #ef6c00;
            border-color: rgba(255, 152, 0, 0.2);
        }

        @keyframes toastFadeIn {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        @keyframes toastFadeOut {
            from {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            to {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
        }

        .custom-toast.fade-out {
            animation: toastFadeOut 0.3s ease-in forwards;
        }

        /* 🛒【新增】自定义确认对话框样式 */
        .custom-confirm {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10002;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: confirmFadeIn 0.3s ease-out;
        }

        .custom-confirm-dialog {
            background: white;
            border-radius: 15px;
            padding: 24px;
            max-width: 320px;
            width: 85%;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
            animation: confirmSlideIn 0.3s ease-out;
        }

        .custom-confirm-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            text-align: center;
        }

        .custom-confirm-message {
            font-size: 16px;
            color: #666;
            line-height: 1.4;
            margin-bottom: 24px;
            text-align: center;
        }

        .custom-confirm-buttons {
            display: flex;
            gap: 12px;
        }

        .custom-confirm-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .custom-confirm-btn.cancel {
            background: #f5f5f5;
            color: #666;
        }

        .custom-confirm-btn.cancel:hover {
            background: #e8e8e8;
        }

        .custom-confirm-btn.confirm {
            background: #ff4444;
            color: white;
        }

        .custom-confirm-btn.confirm:hover {
            background: #e03e3e;
        }

        /* 个人表情包描述添加模态框样式 */
        .personal-emoji-description-modal {
            max-width: 450px;
            width: 90%;
            border-radius: 16px;
            overflow: hidden;
        }

        .personal-emoji-description-modal .modal-header {
            background: linear-gradient(135deg, #8FA8B2, #A8BCC8);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .personal-emoji-description-modal .modal-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
        }

        .personal-emoji-description-modal .modal-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.2s ease;
        }

        .personal-emoji-description-modal .modal-close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .personal-emoji-description-modal .modal-body {
            padding: 25px;
            background: white;
        }

        .personal-emoji-description-modal .emoji-preview-container {
            text-align: center;
            margin-bottom: 20px;
        }

        .personal-emoji-description-modal .emoji-preview-container img {
            border: 2px solid #e0e0e0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .personal-emoji-description-modal .form-group {
            margin-bottom: 20px;
        }

        .personal-emoji-description-modal .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        .personal-emoji-description-modal .form-textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            min-height: 80px;
            box-sizing: border-box;
            transition: all 0.3s ease;
        }

        .personal-emoji-description-modal .form-textarea:focus {
            outline: none;
            border-color: #8FA8B2;
            box-shadow: 0 0 0 3px rgba(143, 168, 178, 0.1);
        }

        .personal-emoji-description-modal .form-textarea::placeholder {
            color: #999;
            font-style: italic;
        }

        .personal-emoji-description-modal .description-help {
            background: #f5f7f8;
            border-radius: 8px;
            padding: 12px;
            margin-top: 10px;
        }

        .personal-emoji-description-modal .modal-footer {
            padding: 20px 25px;
            background: #f5f7f8;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        .personal-emoji-description-modal .modal-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 80px;
        }

        .personal-emoji-description-modal .cancel-btn {
            background: #e0e0e0;
            color: #666;
        }

        .personal-emoji-description-modal .cancel-btn:hover {
            background: #d0d0d0;
            color: #555;
        }

        .personal-emoji-description-modal .confirm-btn {
            background: #8FA8B2;
            color: white;
        }

        .personal-emoji-description-modal .confirm-btn:hover {
            background: #7A9AA6;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(143, 168, 178, 0.3);
        }

        @keyframes confirmFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes confirmSlideIn {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* 🛒【新增】AI代付请求拒绝按钮样式 */
        .payment-button-single.reject-btn {
            background: #f44336;
            color: white;
            margin-left: 10px;
        }

        .payment-button-single.reject-btn:hover {
            background: #da190b;
        }

        /* 🛒【新增】AI订单确认样式 */
        .ai-order .receipt-card {
            background: linear-gradient(135deg, #fff8e1, #f3e5f5);
            border-left: 4px solid #FF9800;
        }

        /* 🛒【新增】代付详情模态框样式 */
        .payment-details-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .payment-details-content {
            background: white;
            border-radius: 16px;
            max-width: 400px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .payment-details-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #eee;
        }

        .payment-details-header h3 {
            margin: 0;
            font-size: 18px;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .payment-details-body {
            padding: 20px;
        }

        /* 🔥【新增】简洁的订单详情样式 - 像用户订单详情那样 */
        .order-info {
            margin-bottom: 20px;
        }

        .order-number {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .order-number .label {
            font-size: 14px;
            color: #666;
        }

        .order-number .value {
            font-size: 14px;
            color: #333;
            font-weight: 500;
        }

        .order-items {
            margin-bottom: 20px;
        }

        .order-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .order-item:last-child {
            border-bottom: none;
        }

        .item-name {
            font-size: 14px;
            color: #333;
        }

        .item-price {
            font-size: 14px;
            color: #333;
            font-weight: 500;
        }

        .order-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-top: 1px solid #f0f0f0;
            font-weight: 600;
        }

        .total-label {
            font-size: 16px;
            color: #333;
        }

        .total-amount {
            font-size: 18px;
            color: #e74c3c;
        }

        /* 保留原有样式作为备用 */
        .detail-section {
            margin-bottom: 16px;
        }

        .detail-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 4px;
        }

        .detail-value {
            font-size: 16px;
            color: #333;
            font-weight: 500;
        }

        .detail-items {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .detail-item-name {
            flex: 1;
            font-size: 14px;
            color: #333;
        }

        .detail-item-price {
            font-size: 14px;
            color: #666;
            font-weight: 500;
        }

        .total-section {
            border-top: 1px solid #eee;
            padding-top: 16px;
            margin-top: 16px;
        }

        .total-amount {
            font-size: 18px;
            color: #ff6b35;
            font-weight: bold;
        }

        /* 🔥【新增】音效设置界面样式 - 使用更具体的选择器 */
        #sound-settings-screen .sound-setting-item {
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            border: 1px solid rgba(0, 0, 0, 0.08);
        }

        #sound-settings-screen .sound-setting-header h3 {
            margin: 0 0 5px 0;
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        #sound-settings-screen .sound-setting-header p {
            margin: 0;
            font-size: 14px;
            color: #666;
        }

        #sound-settings-screen .sound-setting-controls {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        #sound-settings-screen .sound-url-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.8);
            box-sizing: border-box;
        }

        #sound-settings-screen .sound-url-input:focus {
            outline: none;
            border-color: var(--theme-button-bg, #4a84c1);
            background: white;
        }

        #sound-settings-screen .sound-setting-controls .sound-file-btn,
        #sound-settings-screen .sound-setting-controls .sound-test-btn,
        #sound-settings-screen .sound-setting-controls .sound-clear-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        #sound-settings-screen .sound-file-btn {
            background: var(--theme-button-bg, #4a84c1);
            color: white;
        }

        #sound-settings-screen .sound-file-btn:hover {
            background: var(--theme-button-bg-hover, #3a6fa5);
        }

        #sound-settings-screen .sound-test-btn {
            background: var(--theme-button-bg, #4a84c1);
            color: white;
        }

        #sound-settings-screen .sound-test-btn:hover {
            background: var(--theme-button-bg-hover, #3a6fa5);
        }

        #sound-settings-screen .sound-clear-btn {
            background: #ff7875;
            color: white;
        }

        #sound-settings-screen .sound-clear-btn:hover {
            background: #ff4d4f;
        }

        #sound-settings-screen .sound-settings-note {
            margin-top: 30px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.02);
            border-radius: 10px;
            border: 1px solid rgba(0, 0, 0, 0.08);
        }

        #sound-settings-screen .sound-settings-note p {
            margin: 5px 0;
            font-size: 14px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #sound-settings-screen .sound-settings-note i {
            color: #666;
        }

        .settings-icon.sound {
            background: linear-gradient(135deg, #FF6B6B, #FF8E53);
            color: white;
        }

        /* 🔥【新增】角色专属音效设置样式 */
        #character-sound-settings .character-sound-item {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            border: 1px solid rgba(0, 0, 0, 0.06);
        }

        #character-sound-settings .character-sound-header h4 {
            margin: 0 0 5px 0;
            font-size: 15px;
            font-weight: 600;
            color: #333;
        }

        #character-sound-settings .character-sound-header p {
            margin: 0;
            font-size: 13px;
            color: #666;
        }

        #character-sound-settings .character-sound-controls {
            margin-top: 12px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        #character-sound-settings .sound-url-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            font-size: 13px;
            background: rgba(255, 255, 255, 0.9);
            box-sizing: border-box;
        }

        #character-sound-settings .sound-url-input:focus {
            outline: none;
            border-color: var(--theme-button-bg, #4a84c1);
            background: white;
        }

        #character-sound-settings .character-sound-controls .sound-file-btn,
        #character-sound-settings .character-sound-controls .sound-test-btn,
        #character-sound-settings .character-sound-controls .sound-clear-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        #character-sound-settings .sound-file-btn,
        #character-sound-settings .sound-test-btn {
            background: var(--theme-button-bg, #4a84c1);
            color: white;
        }

        #character-sound-settings .sound-file-btn:hover,
        #character-sound-settings .sound-test-btn:hover {
            background: var(--theme-button-bg-hover, #3a6fa5);
        }

        #character-sound-settings .sound-clear-btn {
            background: #ff7875;
            color: white;
        }

        #character-sound-settings .sound-clear-btn:hover {
            background: #ff4d4f;
        }



        #character-sound-settings .character-sound-note {
            margin-top: 20px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.02);
            border-radius: 8px;
            border: 1px solid rgba(0, 0, 0, 0.06);
        }

        #character-sound-settings .character-sound-note p {
            margin: 3px 0;
            font-size: 12px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        #character-sound-settings .character-sound-note i {
            color: #999;
        }



        /* 🔥【新增】音效开关样式 - 使用更具体的选择器避免冲突 */
        #sound-settings-screen .switch-label {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            margin-bottom: 20px;
            padding: 15px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        #sound-settings-screen .switch-slider {
            position: relative;
            width: 50px;
            height: 28px;
            background: #ccc;
            border-radius: 14px;
            transition: background 0.3s ease;
            flex-shrink: 0;
        }

        #sound-settings-screen .switch-slider::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        #sound-settings-screen input[type="checkbox"]:checked + .switch-slider {
            background: var(--theme-button-bg, #4a84c1) !important;
        }

        #sound-settings-screen input[type="checkbox"]:checked + .switch-slider::before {
            transform: translateX(22px);
        }

        #sound-settings-screen input[type="checkbox"] {
            display: none !important;
            width: auto !important;
            height: auto !important;
            margin: 0 !important;
        }

        #sound-settings-screen .switch-label span:first-child {
            flex: 1;
        }

        /* 🎨【新增】自定义主题界面样式 */
        .custom-theme-content {
            padding: 0;
            background: #f8f9fa;
        }

        /* 自定义主题选项卡 */
        .custom-theme-tabs {
            display: flex;
            background: white;
            border-bottom: 1px solid #e8e8e8;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .custom-theme-tab {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 2px solid transparent;
        }

        .custom-theme-tab.active {
            color: #6699FF;
            border-bottom-color: #6699FF;
            background: rgba(102, 153, 255, 0.05);
        }

        .custom-theme-tab i {
            font-size: 18px;
            margin-bottom: 4px;
        }

        .custom-theme-tab span {
            font-size: 12px;
            font-weight: 500;
        }

        /* 自定义主题内容面板 */
        .custom-theme-content-pane {
            padding: 16px;
        }

        /* 自定义主题分区 */
        .custom-theme-section {
            background: white;
            border-radius: 12px;
            margin-bottom: 16px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            display: flex;
            align-items: center;
            padding: 16px;
            background: #f8f9fa;
            border-bottom: 1px solid #e8e8e8;
            font-weight: 600;
            color: #333;
        }

        .section-title i {
            margin-right: 8px;
            color: #6699FF;
        }

        /* 自定义主题项目 */
        .custom-theme-item {
            display: flex;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .custom-theme-item:last-child {
            border-bottom: none;
        }

        .custom-theme-item:hover {
            background-color: #f8f9fa;
        }

        .theme-item-left {
            display: flex;
            align-items: center;
            flex: 1;
        }

        .theme-item-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: #e3f2fd;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
        }

        .theme-item-icon i {
            color: #1976d2;
            font-size: 18px;
        }

        .theme-item-info {
            flex: 1;
        }

        .theme-item-title {
            font-size: 16px;
            font-weight: 500;
            color: #333;
            margin-bottom: 2px;
        }

        .theme-item-desc {
            font-size: 13px;
            color: #666;
        }

        .theme-item-preview {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed #ddd;
            transition: all 0.2s ease;
            background-size: cover;
            background-position: center;
        }

        .theme-item-preview i {
            color: #999;
            font-size: 16px;
        }

        .theme-item-preview.has-image {
            border: 2px solid #6699FF;
        }

        .theme-item-preview.has-image i {
            display: none;
        }

        .theme-item-action {
            color: #999;
            font-size: 16px;
        }

        /* 应用范围选择 */
        .theme-scope-options {
            display: flex;
            gap: 12px;
            padding: 16px;
        }

        .theme-scope-option {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 16px 12px;
            border: 2px solid #e8e8e8;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: white;
        }

        .theme-scope-option.active {
            border-color: #6699FF;
            background: rgba(102, 153, 255, 0.05);
            color: #6699FF;
        }

        .theme-scope-option i {
            font-size: 20px;
            margin-bottom: 6px;
        }

        .theme-scope-option span {
            font-size: 12px;
            font-weight: 500;
            text-align: center;
        }

        /* 聊天窗口选择列表 */
        .chat-selection-list {
            padding: 16px;
            background: #f8f9fa;
            border-top: 1px solid #e8e8e8;
        }

        .chat-selection-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: white;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .chat-selection-item:last-child {
            margin-bottom: 0;
        }

        .chat-selection-item:hover {
            background: #f0f0f0;
        }

        .chat-selection-item.selected {
            background: rgba(102, 153, 255, 0.1);
            border: 1px solid #6699FF;
        }

        .chat-selection-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid #ddd;
            border-radius: 4px;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .chat-selection-item.selected .chat-selection-checkbox {
            background: #6699FF;
            border-color: #6699FF;
            color: white;
        }

        .chat-selection-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #e8e8e8;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-size: cover;
            background-position: center;
        }

        .chat-selection-avatar i {
            color: #666;
            font-size: 16px;
        }

        .chat-selection-info {
            flex: 1;
        }

        .chat-selection-name {
            font-size: 15px;
            font-weight: 500;
            color: #333;
            margin-bottom: 2px;
        }

        .chat-selection-desc {
            font-size: 12px;
            color: #666;
        }

        /* 底部操作按钮 - 参考世界书app样式 */
        .custom-theme-actions {
            display: flex;
            gap: 6px;
            padding: 8px 12px;
            background: white;
            border-top: 1px solid #e8e8e8;
            position: sticky;
            bottom: 0;
            height: 60px;
            align-items: center;
        }

        .theme-action-btn {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 4px 2px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 11px;
            font-weight: 500;
            height: 44px;
            justify-content: center;
            min-width: 0;
        }

        .theme-action-btn i {
            font-size: 14px;
            margin-bottom: 2px;
        }

        .theme-action-btn span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .reset-btn {
            background: #f8f9fa;
            color: #666;
        }

        .reset-btn:hover {
            background: #e9ecef;
        }

        .test-btn {
            background: #fff3cd;
            color: #856404;
        }

        .test-btn:hover {
            background: #ffeaa7;
        }

        .preview-btn {
            background: #e3f2fd;
            color: #1976d2;
        }

        .preview-btn:hover {
            background: #bbdefb;
        }

        .apply-btn {
            background: #6699FF;
            color: white;
        }

        .apply-btn:hover {
            background: #5588EE;
        }

        /* 自定义主题预览样式 */
        .theme-preview-custom {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
        }

        .theme-preview-custom .theme-preview-content {
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        /* 自定义主题应用后的样式变量 - 只有在有自定义内容时才覆盖默认样式 */

        /* 应用自定义主题样式 - 只在有自定义内容时应用 */
        .custom-theme-applied[data-has-chat-top-bg="true"] #api-chat-screen .app-status-bar,
        .custom-theme-applied[data-has-chat-top-bg="true"] #api-chat-screen .header {
            background-image: var(--custom-chat-top-bg);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .custom-theme-applied[data-has-chat-bottom-bg="true"] #api-chat-screen .chat-input-area {
            background-image: var(--custom-chat-bottom-bg);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* 强制自定义按钮样式 */
        .custom-button-styled {
            background-color: transparent !important;
            color: transparent !important;
            text-shadow: none !important;
            border: none !important;
            box-shadow: none !important;
        }

        .custom-button-styled i,
        .custom-button-styled span,
        .custom-button-styled .icon {
            opacity: 0 !important;
        }

        /* 🔥【修复】自定义按钮样式 - 只在有对应标记时才应用 */
        /* 返回按钮 */
        .custom-theme-applied[data-has-custom-back-btn="true"] .back-btn {
            background-image: var(--custom-back-btn);
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            color: transparent;
        }

        /* 线下模式按钮 */
        .custom-theme-applied[data-has-custom-offline-btn="true"] #offline-mode-icon {
            background-image: var(--custom-offline-btn);
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            color: transparent;
        }

        /* 聊天设置按钮 */
        .custom-theme-applied[data-has-custom-settings-btn="true"] .header-actions .action-btn:last-child {
            background-image: var(--custom-settings-btn);
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
        }

        .custom-theme-applied[data-has-custom-settings-btn="true"] .header-actions .action-btn:last-child i {
            opacity: 0;
        }

        /* 功能区展开按钮 */
        .custom-theme-applied[data-has-custom-expand-btn="true"] .toggle-tools-btn {
            background-image: var(--custom-expand-btn);
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
        }

        .custom-theme-applied[data-has-custom-expand-btn="true"] .toggle-tools-btn i {
            opacity: 0;
        }

        /* 续写按钮 */
        .custom-theme-applied[data-has-custom-continue-btn="true"] .chat-action-btn[onclick*="triggerSmartReply"] {
            background-image: var(--custom-continue-btn);
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
        }

        .custom-theme-applied[data-has-custom-continue-btn="true"] .chat-action-btn[onclick*="triggerSmartReply"] i {
            opacity: 0;
        }

        /* 发送消息按钮 */
        .custom-theme-applied[data-has-custom-send-btn="true"] .send-button {
            background-image: var(--custom-send-btn);
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            color: transparent;
        }

        /* 全局样式应用 */
        /* 🔥【修复】顶部应用栏容器 - 应用到所有应用界面 */
        .custom-theme-applied[data-has-custom-global-top-app-bar="true"] .app-top-container {
            background-image: var(--custom-global-top-app-bar);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* 🔥【修复】确保状态栏和标题栏透明，让容器背景显示 */
        .custom-theme-applied[data-has-custom-global-top-app-bar="true"] .app-top-container .app-status-bar,
        .custom-theme-applied[data-has-custom-global-top-app-bar="true"] .app-top-container .app-header {
            background: transparent !important;
            background-color: transparent !important;
            background-image: none !important;
        }

        /* 🔥【修复】只排除API聊天界面 */
        .custom-theme-applied[data-has-custom-global-top-app-bar="true"] #api-chat-screen .app-top-container {
            background-image: none !important;
            background: var(--theme-header-bg) !important;
            background-color: var(--theme-header-bg) !important;
        }

        /* 🔥【修复】底部应用栏 - 应用到所有底部标签栏 */
        .custom-theme-applied[data-has-custom-global-bottom-app-bar="true"] .chat-tabs,
        .custom-theme-applied[data-has-custom-global-bottom-app-bar="true"] .worldbook-tabs,
        .custom-theme-applied[data-has-custom-global-bottom-app-bar="true"] .anniversary-tabs,
        .custom-theme-applied[data-has-custom-global-bottom-app-bar="true"] .app-bottom-bar {
            background-image: var(--custom-global-bottom-app-bar);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* 🔥【新增】图片上传选择模态框样式 */
        .upload-choice-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .upload-choice-option {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-choice-option:hover {
            border-color: #6699FF;
            background-color: #f8f9ff;
        }

        .upload-choice-icon {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #6699FF;
            color: white;
            border-radius: 10px;
            margin-right: 15px;
            font-size: 20px;
        }

        .upload-choice-text {
            flex: 1;
        }

        .upload-choice-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .upload-choice-desc {
            font-size: 14px;
            color: #666;
        }

        .url-input-container {
            padding: 10px 0;
        }

        /* 🔥【修复】URL输入框样式优化 */
        #image-url-input {
            width: 100%;
            max-width: 100%;
            padding: 12px 16px;
            border: 2px solid #e8e8e8;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.4;
            box-sizing: border-box;
            transition: border-color 0.3s ease;
            word-break: break-all;
            overflow-wrap: break-word;
            resize: none;
        }

        #image-url-input:focus {
            outline: none;
            border-color: #6699FF;
            box-shadow: 0 0 0 3px rgba(102, 153, 255, 0.1);
        }

        #image-url-input::placeholder {
            color: #999;
            font-size: 14px;
        }

        .url-tips {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-size: 14px;
        }

        .url-tips ul {
            margin: 10px 0 0 0;
            padding-left: 20px;
        }

        .url-tips li {
            margin: 5px 0;
            color: #666;
        }

        .url-preview {
            margin-top: 15px;
            text-align: center;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #f9f9f9;
        }

        /* 🔥【新增】URL输入模态框特定样式 */
        #url-input-modal .modal-content {
            max-width: 450px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
        }

        #url-input-modal .modal-body {
            padding: 20px;
        }

        #url-input-modal .form-group {
            margin-bottom: 20px;
        }

        #url-input-modal .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        /* 响应式设计 */
        @media (max-width: 480px) {
            #url-input-modal .modal-content {
                width: 95%;
                max-height: 90vh;
            }

            #url-input-modal .modal-body {
                padding: 16px;
            }

            #image-url-input {
                font-size: 16px; /* 防止iOS缩放 */
            }
        }

        /* 🔥【新增】图片上传选择模态框样式 */
        #image-upload-choice-modal .modal-content {
            max-width: 400px;
            width: 90%;
        }

        #image-upload-choice-modal .modal-body {
            padding: 20px;
        }

        /* 🔥【新增】已设置项状态指示器 */
        .theme-item-status {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 24px;
            height: 24px;
            background-color: #4CAF50;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            z-index: 2;
        }

        .custom-theme-item {
            position: relative;
        }

        .theme-item-configured {
            border-color: #4CAF50 !important;
            background-color: #f8fff8 !important;
        }

        /* 🔥【修复】返回按钮 - 排除API聊天界面和短信聊天界面 */
        /* 注意：此规则已移至.back-button基础样式附近，以确保更好的优先级管理 */

        /* 🔥【修复】只排除API聊天界面的全局返回按钮样式 */
        .custom-theme-applied[data-has-custom-global-back-button="true"] #api-chat-screen .back-button {
            background-image: none !important;
            background: none !important;
            background-color: transparent !important;
            color: var(--text-primary) !important;
        }

        /* 🔥【修复】添加按钮 - 只应用到顶部标题栏的添加/新建按钮（+号） */
        .custom-theme-applied[data-has-custom-global-add-button="true"] .chat-header-actions .add-btn,
        .custom-theme-applied[data-has-custom-global-add-button="true"] .persona-header-actions .add-persona-btn-header,
        .custom-theme-applied[data-has-custom-global-add-button="true"] .emoji-library-header-actions .create-library-btn-header,
        .custom-theme-applied[data-has-custom-global-add-button="true"] .messages-header-actions .add-message-btn,
        .custom-theme-applied[data-has-custom-global-add-button="true"] .header-actions .action-btn[title*="添加"],
        .custom-theme-applied[data-has-custom-global-add-button="true"] .header-actions .action-btn[title*="新建"],
        .custom-theme-applied[data-has-custom-global-add-button="true"] .header-actions .action-btn[onclick*="showMakeNewsModal"],
        .custom-theme-applied[data-has-custom-global-add-button="true"] .header-actions .action-btn[onclick*="showOfflinePresetSettings"] {
            background-image: var(--custom-global-add-button);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            color: transparent;
        }

        /* 🔥【修复】排除聊天界面的添加按钮样式 */
        .custom-theme-applied[data-has-custom-global-add-button="true"] #api-chat-screen .chat-header-actions .add-btn,
        .custom-theme-applied[data-has-custom-global-add-button="true"] #api-chat-screen .header-actions .action-btn,
        .custom-theme-applied[data-has-custom-global-add-button="true"] #sms-chat-screen .messages-header-actions .add-message-btn,
        .custom-theme-applied[data-has-custom-global-add-button="true"] #sms-chat-screen .header-actions .action-btn {
            background-image: none !important;
            background: none !important;
            background-color: transparent !important;
            color: var(--text-primary) !important;
        }

        /* 🔥【修复】全局应用背景 - 应用到各app页面的内容区域（顶部和底部应用栏之间的区域） */
        .custom-theme-applied[data-has-custom-global-bg="true"] .app-content:not(#api-chat-screen .app-content):not(#sms-chat-screen .app-content),
        .custom-theme-applied[data-has-custom-global-bg="true"] .main-content:not(#api-chat-screen .main-content):not(#sms-chat-screen .main-content),
        .custom-theme-applied[data-has-custom-global-bg="true"] .content-area:not(#api-chat-screen .content-area):not(#sms-chat-screen .content-area),
        .custom-theme-applied[data-has-custom-global-bg="true"] .app-body:not(#api-chat-screen .app-body):not(#sms-chat-screen .app-body),
        .custom-theme-applied[data-has-custom-global-bg="true"] .page-content:not(#api-chat-screen .page-content):not(#sms-chat-screen .page-content) {
            background-image: var(--custom-global-bg);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* 🔥【修复】排除聊天界面的全局背景样式 - 但不影响聊天界面本身的背景 */
        .custom-theme-applied[data-has-custom-global-bg="true"] #api-chat-screen .app-content,
        .custom-theme-applied[data-has-custom-global-bg="true"] #sms-chat-screen .app-content {
            background-image: none !important;
            background: transparent !important;
            background-color: transparent !important;
        }

        /* 确保自定义按钮在有背景图时正确显示 */
        .custom-theme-applied .back-btn[style*="background-image"],
        .custom-theme-applied #offline-mode-icon[style*="background-image"],
        .custom-theme-applied .header-actions .action-btn:last-child[style*="background-image"],
        .custom-theme-applied .toggle-tools-btn[style*="background-image"],
        .custom-theme-applied .chat-action-btn[style*="background-image"],
        .custom-theme-applied .send-button[style*="background-image"] {
            /* 确保自定义背景图片正确显示 */
            background-color: transparent;
            border: none;
            outline: none;
        }

        /* 🎨【新增】自定义主题界面隐藏dock栏 */
        #custom-theme-screen #dock-bar {
            display: none !important;
        }

        /* 🎨【新增】主题预览模态框样式 */
        .preview-info {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .preview-tip {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 16px;
            font-weight: 600;
            color: #6699FF;
            margin-bottom: 8px;
        }

        .preview-tip i {
            font-size: 18px;
        }

        .preview-desc {
            font-size: 14px;
            color: #666;
            line-height: 1.4;
        }

        .preview-actions {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }

        .preview-action-btn {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 16px 12px;
            border: 2px solid #e8e8e8;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .preview-action-btn:hover {
            border-color: #6699FF;
            background: rgba(102, 153, 255, 0.05);
            color: #6699FF;
        }

        .preview-action-btn i {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .goto-chat-btn:hover {
            border-color: #34C759;
            background: rgba(52, 199, 89, 0.05);
            color: #34C759;
        }

        .goto-home-btn:hover {
            border-color: #FF9500;
            background: rgba(255, 149, 0, 0.05);
            color: #FF9500;
        }

        /* 🔥【新增】主题管理界面样式 */
        .theme-management-info {
            background: #f0f8ff;
            border: 1px solid #b3d9ff;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 16px;
            text-align: center;
            color: #0066cc;
        }

        .theme-chat-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .theme-chat-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 8px;
            background: white;
            transition: all 0.2s ease;
        }

        .theme-chat-item:hover {
            background: #f8f9fa;
            border-color: #6699FF;
        }

        .theme-chat-info {
            flex: 1;
        }

        .theme-chat-name {
            font-weight: 500;
            color: #333;
            margin-bottom: 4px;
        }

        .theme-chat-type {
            font-size: 12px;
            color: #666;
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 4px;
            display: inline-block;
        }

        .theme-chat-actions {
            display: flex;
            gap: 8px;
        }

        .theme-chat-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .preview-theme-btn {
            background: #6699FF;
            color: white;
        }

        .preview-theme-btn:hover {
            background: #5588EE;
            transform: scale(1.05);
        }

        .remove-theme-btn {
            background: #ff4757;
            color: white;
        }

        .remove-theme-btn:hover {
            background: #ff3742;
            transform: scale(1.05);
        }

        .theme-action-btn.manage-btn {
            background: #f8f9fa;
            color: #666;
        }

        .theme-action-btn.manage-btn:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }
        /* ==================== 请求码显示框样式 ==================== */
.code-display-box {
    background-color: #f0f0f0;
    padding: 10px;
    border-radius: 4px;
    font-family: 'Courier New', Courier, monospace;
    font-size: 14px;
    color: #333;
    border: 1px solid #ddd;
    margin: 15px 0;
    word-wrap: break-word; /* 自动换行 */
}
/* ========================================================= */
/* ==================== 授权码门禁样式 ==================== */
/* ========================================================= */

#auth-overlay {
    position: fixed; /* 固定定位，让它“飞”出正常布局 */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.75); /* 半透明黑色背景 */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999; /* 确保它在所有东西的最顶层 */
}

.auth-box {
    background-color: white;
    padding: 30px;
    border-radius: 12px;
    text-align: center;
    width: 90%;
    max-width: 350px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.25);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
}

.auth-box h1 {
    margin-top: 0;
    font-size: 22px;
    color: #333;
}

.auth-box p {
    font-size: 14px;
    color: #666;
    line-height: 1.5;
}

#license-input {
    width: 100%;
    padding: 12px;
    box-sizing: border-box;
    border: 1px solid #ccc;
    border-radius: 8px;
    margin-top: 20px;
    font-size: 16px;
    text-align: center;
}

#activate-button {
    width: 100%;
    padding: 12px;
    border: none;
    background-color: #007bff;
    color: white;
    font-size: 16px;
    font-weight: bold;
    border-radius: 8px;
    margin-top: 15px;
    cursor: pointer;
    transition: background-color 0.2s;
}

#activate-button:hover {
    background-color: #0056b3;
}

.code-display-box {
    background-color: #f0f0f0;
    padding: 12px;
    border-radius: 8px;
    font-family: 'Courier New', Courier, monospace;
    font-size: 14px;
    color: #333;
    border: 1px solid #ddd;
    margin: 20px 0;
    word-wrap: break-word;
}

/* 一个用来隐藏元素的通用类 */
.hidden {
    display: none !important;
}

/* 🔥【新增】URL图床输入区域样式 */
.emoji-url-input-area {
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    padding: 15px;
    margin: 10px 0;
}

.url-input-header {
    display: flex;
    align-items: center;
    font-size: 14px;
    font-weight: 500;
    color: #333;
    margin-bottom: 10px;
}

/* 🔥【修复】表情包URL输入容器样式 - 使用更具体的选择器避免冲突 */
.emoji-url-input-container {
    display: flex;
    gap: 8px;
    margin-bottom: 8px;
}

.url-input {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 14px;
    outline: none;
    transition: border-color 0.2s;
}

.url-input:focus {
    border-color: #6B9BD2;
    box-shadow: 0 0 0 2px rgba(107, 155, 210, 0.1);
}

.url-add-btn {
    padding: 8px 12px;
    background: #6B9BD2;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.2s;
    min-width: 40px;
}

.url-add-btn:hover {
    background: #5a8bc4;
}

.url-input-tip {
    font-size: 12px;
    color: #666;
    margin: 0;
    font-style: italic;
}

/* 🔥【新增】URL输入模式切换样式 */
.url-input-mode-toggle {
    display: flex;
    gap: 4px;
    margin-left: auto;
}

.mode-btn {
    padding: 4px 12px;
    font-size: 12px;
    border: 1px solid #ddd;
    background: white;
    color: #666;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s;
}

.mode-btn.active {
    background: #6B9BD2;
    color: white;
    border-color: #6B9BD2;
}

.mode-btn:hover:not(.active) {
    background: #f5f5f5;
    border-color: #ccc;
}

/* 🔥【新增】批量输入样式 */
.batch-input-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.batch-textarea {
    width: 100%;
    min-height: 120px;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 13px;
    font-family: 'Courier New', monospace;
    resize: vertical;
    outline: none;
    transition: border-color 0.2s;
    line-height: 1.4;
}

.batch-textarea:focus {
    border-color: #6B9BD2;
    box-shadow: 0 0 0 2px rgba(107, 155, 210, 0.1);
}

.batch-input-actions {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
}

.batch-preview-btn, .batch-import-btn {
    padding: 8px 16px;
    border: none;
    border-radius: 6px;
    font-size: 13px;
    cursor: pointer;
    transition: background-color 0.2s;
    display: flex;
    align-items: center;
    gap: 6px;
}

.batch-preview-btn {
    background: #f8f9fa;
    color: #666;
    border: 1px solid #ddd;
}

.batch-preview-btn:hover {
    background: #e9ecef;
}

.batch-import-btn {
    background: #6B9BD2;
    color: white;
}

.batch-import-btn:hover {
    background: #5a8bc4;
}

/* 🔥【新增】批量预览模态框样式 */
.batch-preview-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
}

.batch-preview-modal {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    z-index: 10001;
    max-width: 600px;
    max-height: 80vh;
    width: 90%;
    display: flex;
    flex-direction: column;
}

.batch-preview-header {
    padding: 20px 20px 10px;
    border-bottom: 1px solid #eee;
}

.batch-preview-header h3 {
    margin: 0 0 5px;
    font-size: 18px;
    color: #333;
}

.batch-preview-header p {
    margin: 0;
    color: #666;
    font-size: 14px;
}

.batch-preview-list {
    flex: 1;
    overflow-y: auto;
    padding: 15px 20px;
    max-height: 400px;
}

.batch-preview-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px 0;
    border-bottom: 1px solid #f0f0f0;
}

.batch-preview-item:last-child {
    border-bottom: none;
}

.preview-index {
    width: 24px;
    height: 24px;
    background: #6B9BD2;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: bold;
    flex-shrink: 0;
}

.preview-info {
    flex: 1;
    min-width: 0;
}

.preview-description {
    font-weight: 500;
    color: #333;
    margin-bottom: 2px;
}

.preview-url {
    font-size: 12px;
    color: #666;
    word-break: break-all;
    font-family: 'Courier New', monospace;
}

.preview-image {
    flex-shrink: 0;
}

.batch-preview-actions {
    padding: 15px 20px;
    border-top: 1px solid #eee;
    display: flex;
    gap: 10px;
    justify-content: flex-end;
}

.preview-cancel-btn, .preview-confirm-btn {
    padding: 8px 20px;
    border: none;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    transition: background-color 0.2s;
}

.preview-cancel-btn {
    background: #f8f9fa;
    color: #666;
    border: 1px solid #ddd;
}

.preview-cancel-btn:hover {
    background: #e9ecef;
}

.preview-confirm-btn {
    background: #28a745;
    color: white;
}

.preview-confirm-btn:hover {
    background: #218838;
}

/* 🔥【新增】线下模式分割线样式 */
.offline-session-divider {
    display: flex;
    align-items: center;
    margin: 20px 0;
    padding: 0 15px;
}

.divider-line {
    flex: 1;
    height: 1px;
    background: linear-gradient(to right, transparent, #ccc, transparent);
}

.divider-text {
    padding: 0 15px;
    font-size: 12px;
    color: #666;
    background: #f5f5f5;
    border-radius: 12px;
    white-space: nowrap;
    text-align: center;
    border: 1px solid #e0e0e0;
}

/* 🔥【新增】线下模式加载更多按钮样式 */
.offline-load-more-btn {
    display: flex;
    justify-content: center;
    padding: 15px 20px;
    margin: 10px 0;
}

.load-more-button {
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 20px;
    padding: 10px 20px;
    font-size: 14px;
    color: #666;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.load-more-button:hover {
    background: rgba(255, 255, 255, 0.95);
    border-color: rgba(0, 0, 0, 0.2);
    color: #333;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.load-more-button:active {
    transform: translateY(0);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

.load-more-button i {
    font-size: 12px;
    opacity: 0.7;
}

.load-more-button span {
    font-weight: 500;
}

/* 🔥【新增】导出按钮样式 */
.history-action-btn.export {
    background: #2196F3;
    color: white;
}

.history-action-btn.export:hover {
    background: #1976D2;
    transform: translateY(-1px);
}

/* 🔥【新增】面具切换功能样式 */
.current-persona-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    overflow: hidden;
    margin-right: 8px;
    border: 2px solid #e0e0e0;
    transition: border-color 0.2s ease;
}

.current-persona-avatar:hover {
    border-color: #6BA3D6;
}

.current-persona-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.persona-switch-container {
    padding: 10px 0;
}

.persona-switch-desc {
    color: #666;
    font-size: 14px;
    margin-bottom: 20px;
    text-align: center;
}

/* 面具切换模态框中的面具列表样式 */
#persona-switch-modal .persona-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 15px;
    /* 修复：移除内部滚动条，让模态框本身处理滚动 */
}

/* 面具切换模态框的modal-body特殊样式 */
#persona-switch-modal .modal-body {
    padding: 15px;
    max-height: 60vh;
    overflow-y: auto;
}

/* 面具切换模态框中的面具项目样式 */
#persona-switch-modal .persona-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 15px 10px;
    border: 2px solid #e0e0e0;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    background: #fff;
}

#persona-switch-modal .persona-item:hover {
    border-color: #6BA3D6;
    background: #f8fbff;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(107, 163, 214, 0.2);
}

#persona-switch-modal .persona-item.selected {
    border-color: #6BA3D6;
    background: #e8f4fd;
}

#persona-switch-modal .persona-item-avatar {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    overflow: hidden;
    margin-bottom: 8px;
    border: 2px solid #e0e0e0;
}

#persona-switch-modal .persona-item.selected .persona-item-avatar {
    border-color: #6BA3D6;
}

#persona-switch-modal .persona-item-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

#persona-switch-modal .persona-item-name {
    font-size: 12px;
    color: #333;
    text-align: center;
    font-weight: 500;
    line-height: 1.2;
    max-width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

#persona-switch-modal .persona-item.selected .persona-item-name {
    color: #6BA3D6;
    font-weight: 600;
}

/* 面具切换模态框中的默认头像样式 */
#persona-switch-modal .persona-item-avatar.default-avatar {
    background: linear-gradient(135deg, #6BA3D6, #4A90E2);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 24px;
    font-weight: bold;
}

/* 🔥【新增】通话记录消息选中状态样式 */
.message-wrapper.selected .call-record-message::after,
.message-wrapper.selected .call-message::after {
    content: '✔';
    position: absolute;
    top: -8px;
    right: -8px;
    width: 18px;
    height: 18px;
    background-color: var(--theme-button-bg, #4a84c1);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: bold;
    z-index: 10;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

/* 确保通话记录消息容器有相对定位 */
.call-record-message,
.call-message {
    position: relative;
}

/* 🔥【新增】日记专用字体设置样式 */
.diary-font-setting {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.diary-font-actions {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.diary-font-actions .theme-button {
    flex: 1;
    min-width: 60px;
    padding: 8px 12px;
    font-size: 12px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    transition: all 0.2s ease;
}

.diary-font-actions .theme-button-secondary {
    background-color: #f5f5f5;
    color: #666;
}

.diary-font-actions .theme-button-secondary:hover {
    background-color: #e0e0e0;
}

.diary-font-actions .theme-button-primary {
    background-color: #4a84c1;
    color: white;
}

.diary-font-actions .theme-button-primary:hover {
    background-color: #3a74b1;
}

.diary-font-actions .theme-button-danger {
    background-color: #f44336;
    color: white;
}

.diary-font-actions .theme-button-danger:hover {
    background-color: #d32f2f;
}

.diary-font-status {
    font-size: 12px;
    padding: 4px 8px;
    border-radius: 4px;
    background-color: #f9f9f9;
    border: 1px solid #e0e0e0;
    min-height: 16px;
}

/* 🔥【重要】确保日记内容不受全局字体和线下模式字体影响 */
#today-diary-content,
#single-diary-content,
#diary-preview-content {
    /* 这些元素的字体将通过JavaScript动态设置 */
    /* 确保有足够的特异性来覆盖全局样式 */
    position: relative;
    z-index: 1;
}

/* 🔥【新增】日记字体隔离 - 防止被其他字体设置影响 */
.diary-content-isolated {
    font-family: inherit !important;
}

/* 🔥【新增】日记字体保护 - 确保日记专用字体优先级最高 */
#today-diary-content[style*="font-family"],
#single-diary-content[style*="font-family"],
#diary-preview-content[style*="font-family"] {
    font-family: inherit !important; /* 当元素有内联字体样式时，确保它不被覆盖 */
}

/* 🔥【新增】防止全局字体影响日记内容的后备保护 */
body[style*="font-family"] #today-diary-content,
body[style*="font-family"] #single-diary-content,
body[style*="font-family"] #diary-preview-content {
    font-family: inherit !important; /* 即使body设置了字体，日记内容也应该保持独立 */
}

/* 🔥【修复】日记段落首行缩进样式 - 每个段落的第一行缩进 */
#today-diary-content,
#single-diary-content,
#diary-preview-content {
    /* 重置整体缩进 */
    text-indent: 0px;
}

/* 🔥【关键】为日记内容中的每个段落设置首行缩进 */
#today-diary-content p,
#single-diary-content p,
#diary-preview-content p {
    text-indent: var(--diary-text-indent, 0px) !important; /* 使用CSS变量，由JavaScript动态设置 */
    margin: 0 0 15px 0; /* 段落间距，重置默认margin */
    line-height: inherit; /* 继承行距设置 */
}

/* 🔥【新增】确保段落不会有默认的浏览器样式干扰 */
#today-diary-content p:first-child,
#single-diary-content p:first-child,
#diary-preview-content p:first-child {
    margin-top: 0;
}

#today-diary-content p:last-child,
#single-diary-content p:last-child,
#diary-preview-content p:last-child {
    margin-bottom: 0;
}

/* 🔥【新增】预览文本的段落处理 */
.preview-text p {
    text-indent: var(--diary-text-indent, 0px) !important;
    margin: 0 0 15px 0;
}

.preview-text {
    line-height: inherit;
}